2025-05-29 07:42:43,919 - TrainHierarchicalMultiScaleScript - INFO - Device: cuda
2025-05-29 07:42:43,920 - TrainHierarchicalMultiScaleScript - INFO - Building COMBINED char vocab from generator...
2025-05-29 07:42:43,920 - utils.ctc_utils - INFO - Built CTC vocab with 229 tokens (Blank: True, UNK: True)
2025-05-29 07:42:43,921 - TrainHierarchicalMultiScaleScript - INFO - Saved generated COMBINED vocab to outputs/opt_3/combined_char_vocab.json
2025-05-29 07:42:43,921 - TrainHierarchicalMultiScaleScript - INFO - Loading dataset: vklinhhh/vnhwt_opt_3
2025-05-29 07:47:01,616 - TrainHierarchicalMultiScaleScript - WARNING - Splitting train set for validation.
2025-05-29 07:47:01,812 - TrainHierarchicalMultiScaleScript - INFO - Train size: 653141, Val size: 34376
2025-05-29 07:47:01,812 - TrainHierarchicalMultiScaleScript - INFO - Initializing HierarchicalCtcMultiScaleOcrModel configuration...
2025-05-29 07:47:01,812 - TrainHierarchicalMultiScaleScript - INFO - Instantiating/Loading model from: microsoft/trocr-base-handwritten
2025-05-29 07:47:01,813 - model.hierarchical_ctc_model - INFO - Loading HierarchicalCtcMultiScaleOcrModel from: microsoft/trocr-base-handwritten
2025-05-29 07:47:01,813 - model.hierarchical_ctc_model - WARNING - Config file not found at microsoft/trocr-base-handwritten/config.json. Initializing new config.
2025-05-29 07:47:01,815 - model.hierarchical_ctc_model - INFO - Initializing HierarchicalCtcMultiScaleOcrModel with config: hierarchical_ctc_transformer
2025-05-29 07:47:23,457 - model.hierarchical_ctc_model - INFO - Processor and Vision Encoder loaded.
2025-05-29 07:47:23,458 - model.hierarchical_ctc_model - INFO - Using Dynamic Multi-Scale Fusion (3 layers -> 768 dim)
2025-05-29 07:47:23,483 - model.hierarchical_ctc_model - INFO - Using Local Feature Enhancer
2025-05-29 07:47:23,560 - model.hierarchical_ctc_model - INFO - Positional Encoding: sinusoidal_1d
2025-05-29 07:47:23,561 - model.hierarchical_ctc_model - INFO - Adding 6 Transformer Encoder layers (Dim: 768)
2025-05-29 07:47:23,778 - model.hierarchical_ctc_model - INFO - Shared Layer(s): 1, Output Dim: 768
2025-05-29 07:47:23,778 - model.hierarchical_ctc_model - INFO - Base Classifier (In: 768, Out: 95)
2025-05-29 07:47:23,783 - model.hierarchical_ctc_model - INFO - 'concat_proj' conditioning for diacritic head -> 768 dim.
2025-05-29 07:47:23,785 - model.diacritic_attention - INFO - Initializing compatibility matrix with priors: no_diac_idx=1, blank_diac_idx=0
2025-05-29 07:47:23,785 - model.diacritic_attention - INFO - Pure tone indices found: [3, 4, 5, 6, 7]
2025-05-29 07:47:23,785 - model.diacritic_attention - INFO - Modifiers map (name_lower -> index): {'breve': 9, 'horn': 10, 'circumflex': 8, 'stroke': 11}
2025-05-29 07:47:23,787 - model.diacritic_attention - INFO - Completed initialization of compatibility matrix with detailed Vietnamese linguistic priors (đ treated as a regular consonant).
2025-05-29 07:47:23,787 - model.hierarchical_ctc_model - INFO - Char-Diac Compat: ON
2025-05-29 07:47:23,787 - model.hierarchical_ctc_model - INFO - Diacritic Classifier (In: 768, Out: 27)
2025-05-29 07:47:23,788 - model.hierarchical_ctc_model - INFO - Final Combined Classifier (In: 768, Out: 229)
2025-05-29 07:47:23,789 - model.hierarchical_ctc_model - INFO - Initialized HierarchicalCtcMultiScaleOcrModel (inherits Grad-CAM from parent).
2025-05-29 07:47:23,789 - model.hierarchical_ctc_model - INFO - Not loading full model state_dict (either config.json or pytorch_model.bin missing at microsoft/trocr-base-handwritten). Using base vision weights and/or random init for custom parts.
2025-05-29 07:47:23,789 - TrainHierarchicalMultiScaleScript - INFO - Model and Processor initialized.
2025-05-29 07:47:23,789 - TrainHierarchicalMultiScaleScript - INFO - Using Dynamic Multi-Scale Fusion
2025-05-29 07:47:23,789 - TrainHierarchicalMultiScaleScript - INFO - Using Local Feature Enhancer for diacritical marks
2025-05-29 07:47:23,789 - TrainHierarchicalMultiScaleScript - INFO - Forcefully reinitializing compatibility matrix...
2025-05-29 07:47:23,789 - TrainHierarchicalMultiScaleScript - INFO - Creating CTC dataset wrappers (using combined vocab)...
2025-05-29 07:47:23,795 - data.ctc_ocr_dataset - INFO - Training augmentations enabled.
2025-05-29 07:47:23,795 - data.ctc_ocr_dataset - INFO - Training augmentations disabled (validation/test mode).
2025-05-29 07:47:23,795 - TrainHierarchicalMultiScaleScript - INFO - CTC Dataset wrappers created.
2025-05-29 07:47:24,137 - TrainHierarchicalMultiScaleScript - INFO - Model on device: cuda
2025-05-29 07:47:24,137 - utils.optimizers - INFO - Using discriminative learning rate: Encoder LR = 5e-06, Decoder/Other LR = 5e-05
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - Scheduler Setup: Steps per epoch=40822, Total Steps=4082200, Warmup=204110
2025-05-29 07:47:24,139 - utils.schedulers - INFO - CosineWarmupScheduler initialized: warmup=204110, max_steps=4082200, eta_min=0
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - Optimizer/Scheduler created.
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - Compatibility matrix found in optimizer param_group 0 with initial lr=1.2248297486649356e-09
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - Increased compatibility matrix learning rate in param_group 0 to 3.062074371662339e-08 (original: 1.2248297486649356e-09, multiplier: 25.0)
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - Set weight_decay for compatibility matrix param_group 0 to 0.0 (original: 0.02)
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - No checkpoint found to resume from.
2025-05-29 07:47:24,139 - TrainHierarchicalMultiScaleScript - INFO - Starting fresh or from base weights.
2025-05-29 07:47:56,456 - TrainHierarchicalMultiScaleScript - INFO - Initialized WandB run: opt_3 (ID: 4q0curv4)
2025-05-29 07:47:56,456 - TrainHierarchicalMultiScaleScript - INFO - ============ Starting Hierarchical Multi-Scale CTC Training Phase ============
2025-05-29 07:47:56,456 - CtcTrainer - INFO - Trainer using device: cuda
2025-05-29 07:47:56,457 - CtcTrainer - INFO - Train DataLoader: 40822 batches, Val DataLoader: 2149 batches
2025-05-29 07:47:56,457 - CtcTrainer - INFO - Trainer starting with default GradScaler state.
2025-05-29 07:47:56,457 - CtcTrainer - INFO - Using combined_char_vocab for validation decoder.
2025-05-29 07:47:56,457 - CtcTrainer - INFO - Validation CTCDecoder initialized (Blank Index: 0).
2025-05-29 07:47:56,457 - CtcTrainer - INFO - --- Starting Training Loop from Epoch 1 ---
2025-05-29 07:47:56,458 - CtcTrainer - INFO - Starting with default GradScaler state.
2025-05-29 07:47:56,458 - CtcTrainer - INFO - Starting Epoch 1/100
2025-05-29 07:48:15,257 - CtcTrainer - WARNING - --- Training interrupted ---
2025-05-29 07:48:15,259 - CtcTrainer - INFO - Training loop ended. Last epoch: 0. Steps: 94
2025-05-29 07:48:15,259 - CtcTrainer - INFO - Attempting to save final state...
2025-05-29 07:48:15,265 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 07:48:17,753 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 07:48:17,836 - TrainHierarchicalMultiScaleScript - INFO - ============ Training finished ============
2025-05-29 07:48:17,837 - TrainHierarchicalMultiScaleScript - INFO - Final model artifacts saved in outputs/opt_3
2025-05-29 07:48:17,837 - TrainHierarchicalMultiScaleScript - INFO - ============ Starting Final Evaluation on Test Set ============
2025-05-29 07:48:18,095 - EvaluateHierarchicalCtcScript - INFO - Using device: cuda
2025-05-29 07:48:18,095 - EvaluateHierarchicalCtcScript - INFO - Loading combined char vocab from: outputs/opt_3/combined_char_vocab.json
2025-05-29 07:48:18,095 - EvaluateHierarchicalCtcScript - INFO - Combined vocab loaded: 229 chars.
2025-05-29 07:48:18,095 - EvaluateHierarchicalCtcScript - INFO - Loading trained Hierarchical CTC model from: outputs/opt_3
2025-05-29 07:48:18,095 - model.hierarchical_ctc_model - INFO - Loading HierarchicalCtcMultiScaleOcrModel from: outputs/opt_3
2025-05-29 07:48:18,096 - model.hierarchical_ctc_model - WARNING - Config file not found at outputs/opt_3/config.json. Initializing new config.
2025-05-29 07:48:18,096 - model.hierarchical_ctc_model - WARNING - Base/Diac vocabs might be missing for conditioning.
2025-05-29 07:48:18,096 - model.hierarchical_ctc_model - INFO - Initializing HierarchicalCtcMultiScaleOcrModel with config: hierarchical_ctc_transformer
2025-05-29 07:48:22,698 - model.hierarchical_ctc_model - INFO - Processor and Vision Encoder loaded.
2025-05-29 07:48:22,703 - model.hierarchical_ctc_model - INFO - Using 'concat_proj' fusion (In: 1536, Out: 512)
2025-05-29 07:48:22,703 - model.hierarchical_ctc_model - INFO - Added LayerNorm after static fusion output (dim: 512)
2025-05-29 07:48:22,705 - model.hierarchical_ctc_model - INFO - Positional Encoding: sinusoidal_1d
2025-05-29 07:48:22,706 - model.hierarchical_ctc_model - INFO - Adding 4 Transformer Encoder layers (Dim: 512)
2025-05-29 07:48:22,735 - model.hierarchical_ctc_model - INFO - Shared Layer(s): 1, Output Dim: 512
2025-05-29 07:48:22,736 - model.hierarchical_ctc_model - INFO - Base Classifier (In: 512, Out: 0)
2025-05-29 07:48:22,738 - model.hierarchical_ctc_model - INFO - 'concat_proj' conditioning for diacritic head -> 512 dim.
2025-05-29 07:48:22,739 - model.hierarchical_ctc_model - INFO - Diacritic Classifier (In: 512, Out: 0)
2025-05-29 07:48:22,740 - model.hierarchical_ctc_model - INFO - Final Combined Classifier (In: 512, Out: 229)
2025-05-29 07:48:22,773 - model.hierarchical_ctc_model - INFO - Initialized HierarchicalCtcMultiScaleOcrModel (inherits Grad-CAM from parent).
2025-05-29 07:48:22,773 - model.hierarchical_ctc_model - INFO - Not loading full model state_dict (either config.json or pytorch_model.bin missing at outputs/opt_3). Using base vision weights and/or random init for custom parts.
2025-05-29 07:48:22,884 - EvaluateHierarchicalCtcScript - INFO - Model and processor loaded.
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_visual_diacritic_attention': False
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_character_diacritic_compatibility': False
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_few_shot_diacritic_adapter': False
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_dynamic_fusion': False
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_feature_enhancer': False
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Using processor target size for attention viz: (384, 384)
2025-05-29 07:48:22,885 - EvaluateHierarchicalCtcScript - INFO - Loading test dataset: vklinhhh/test_vietnamese_cwl, split: train
2025-05-29 07:48:28,618 - EvaluateHierarchicalCtcScript - INFO - Test set size: 343
2025-05-29 07:48:28,618 - EvaluateHierarchicalCtcScript - INFO - Creating CTC test dataset wrapper (using combined vocab)...
2025-05-29 07:48:28,619 - data.ctc_ocr_dataset - INFO - Training augmentations disabled (validation/test mode).
2025-05-29 07:48:28,619 - EvaluateHierarchicalCtcScript - INFO - Test DataLoader created.
2025-05-29 07:48:28,620 - EvaluateHierarchicalCtcScript - INFO - Starting evaluation loop...
2025-05-29 07:48:36,934 - EvaluateHierarchicalCtcScript - INFO - Evaluation loop finished.
2025-05-29 07:48:36,950 - EvaluateHierarchicalCtcScript - INFO - Saved detailed results to: outputs/opt_3/final_evaluation_report/evaluation_results_raw.csv
2025-05-29 07:48:36,976 - EvaluateHierarchicalCtcScript - INFO - Final Evaluation Metrics: Avg Loss=2709.1979, CER=5.6341, WER=2.4880
2025-05-29 07:48:36,976 - EvaluateHierarchicalCtcScript - INFO - Analyzing diacritic recognition accuracy...
2025-05-29 07:48:36,977 - EvaluateHierarchicalCtcScript - WARNING - No diacritic results to visualize.
2025-05-29 07:48:36,977 - EvaluateHierarchicalCtcScript - INFO - Diacritic Recognition Accuracy:
2025-05-29 07:48:36,977 - EvaluateHierarchicalCtcScript - INFO - Saved diacritic analysis to: outputs/opt_3/final_evaluation_report/diacritic_analysis.json
2025-05-29 07:48:37,011 - utils.evaluation_reporter - INFO - Saving visualizations to: outputs/opt_3/final_evaluation_report/visualizations
2025-05-29 07:48:37,604 - utils.evaluation_reporter - INFO - Generating HTML report at: outputs/opt_3/final_evaluation_report/evaluation_report.html
2025-05-29 07:48:37,605 - utils.evaluation_reporter - INFO - HTML report generated successfully.
2025-05-29 07:48:37,605 - EvaluateHierarchicalCtcScript - INFO - Generating diacritic HTML report at: outputs/opt_3/final_evaluation_report/diacritic_evaluation_report.html
2025-05-29 07:48:37,606 - EvaluateHierarchicalCtcScript - INFO - Diacritic HTML report generated successfully.
2025-05-29 07:48:37,606 - EvaluateHierarchicalCtcScript - INFO - Evaluation complete. Reports: outputs/opt_3/final_evaluation_report/evaluation_report.html, outputs/opt_3/final_evaluation_report/diacritic_evaluation_report.html
2025-05-29 07:52:47,554 - TrainHierarchicalMultiScaleScript - INFO - Device: cuda
2025-05-29 07:52:47,554 - TrainHierarchicalMultiScaleScript - INFO - Building COMBINED char vocab from generator...
2025-05-29 07:52:47,555 - utils.ctc_utils - INFO - Built CTC vocab with 229 tokens (Blank: True, UNK: True)
2025-05-29 07:52:47,555 - TrainHierarchicalMultiScaleScript - INFO - Saved generated COMBINED vocab to outputs/opt_3/combined_char_vocab.json
2025-05-29 07:52:47,555 - TrainHierarchicalMultiScaleScript - INFO - Loading dataset: vklinhhh/vnhwt_opt_3
2025-05-29 07:52:51,489 - TrainHierarchicalMultiScaleScript - WARNING - Splitting train set for validation.
2025-05-29 07:52:51,531 - TrainHierarchicalMultiScaleScript - INFO - Train size: 653141, Val size: 34376
2025-05-29 07:52:51,532 - TrainHierarchicalMultiScaleScript - INFO - Initializing HierarchicalCtcMultiScaleOcrModel configuration...
2025-05-29 07:52:51,532 - TrainHierarchicalMultiScaleScript - INFO - Instantiating/Loading model from: microsoft/trocr-base-handwritten
2025-05-29 07:52:51,532 - model.hierarchical_ctc_model - INFO - Loading HierarchicalCtcMultiScaleOcrModel from: microsoft/trocr-base-handwritten
2025-05-29 07:52:51,532 - model.hierarchical_ctc_model - WARNING - Config file not found at microsoft/trocr-base-handwritten/config.json. Initializing new config.
2025-05-29 07:52:51,533 - model.hierarchical_ctc_model - INFO - Initializing HierarchicalCtcMultiScaleOcrModel with config: hierarchical_ctc_transformer
2025-05-29 07:52:56,325 - model.hierarchical_ctc_model - INFO - Processor and Vision Encoder loaded.
2025-05-29 07:52:56,326 - model.hierarchical_ctc_model - INFO - Using Dynamic Multi-Scale Fusion (3 layers -> 768 dim)
2025-05-29 07:52:56,363 - model.hierarchical_ctc_model - INFO - Using Local Feature Enhancer
2025-05-29 07:52:56,574 - model.hierarchical_ctc_model - INFO - Positional Encoding: sinusoidal_1d
2025-05-29 07:52:56,574 - model.hierarchical_ctc_model - INFO - Adding 6 Transformer Encoder layers (Dim: 768)
2025-05-29 07:52:56,776 - model.hierarchical_ctc_model - INFO - Shared Layer(s): 1, Output Dim: 768
2025-05-29 07:52:56,777 - model.hierarchical_ctc_model - INFO - Base Classifier (In: 768, Out: 95)
2025-05-29 07:52:56,782 - model.hierarchical_ctc_model - INFO - 'concat_proj' conditioning for diacritic head -> 768 dim.
2025-05-29 07:52:56,784 - model.diacritic_attention - INFO - Initializing compatibility matrix with priors: no_diac_idx=1, blank_diac_idx=0
2025-05-29 07:52:56,784 - model.diacritic_attention - INFO - Pure tone indices found: [3, 4, 5, 6, 7]
2025-05-29 07:52:56,784 - model.diacritic_attention - INFO - Modifiers map (name_lower -> index): {'breve': 9, 'horn': 10, 'circumflex': 8, 'stroke': 11}
2025-05-29 07:52:56,786 - model.diacritic_attention - INFO - Completed initialization of compatibility matrix with detailed Vietnamese linguistic priors (đ treated as a regular consonant).
2025-05-29 07:52:56,786 - model.hierarchical_ctc_model - INFO - Char-Diac Compat: ON
2025-05-29 07:52:56,786 - model.hierarchical_ctc_model - INFO - Diacritic Classifier (In: 768, Out: 27)
2025-05-29 07:52:56,787 - model.hierarchical_ctc_model - INFO - Final Combined Classifier (In: 768, Out: 229)
2025-05-29 07:52:56,787 - model.hierarchical_ctc_model - INFO - Initialized HierarchicalCtcMultiScaleOcrModel (inherits Grad-CAM from parent).
2025-05-29 07:52:56,787 - model.hierarchical_ctc_model - INFO - Not loading full model state_dict (either config.json or pytorch_model.bin missing at microsoft/trocr-base-handwritten). Using base vision weights and/or random init for custom parts.
2025-05-29 07:52:56,787 - TrainHierarchicalMultiScaleScript - INFO - Model and Processor initialized.
2025-05-29 07:52:56,787 - TrainHierarchicalMultiScaleScript - INFO - Using Dynamic Multi-Scale Fusion
2025-05-29 07:52:56,787 - TrainHierarchicalMultiScaleScript - INFO - Using Local Feature Enhancer for diacritical marks
2025-05-29 07:52:56,787 - TrainHierarchicalMultiScaleScript - INFO - Forcefully reinitializing compatibility matrix...
2025-05-29 07:52:56,787 - TrainHierarchicalMultiScaleScript - INFO - Creating CTC dataset wrappers (using combined vocab)...
2025-05-29 07:52:56,792 - data.ctc_ocr_dataset - INFO - Training augmentations enabled.
2025-05-29 07:52:56,792 - data.ctc_ocr_dataset - INFO - Training augmentations disabled (validation/test mode).
2025-05-29 07:52:56,792 - TrainHierarchicalMultiScaleScript - INFO - CTC Dataset wrappers created.
2025-05-29 07:52:57,155 - TrainHierarchicalMultiScaleScript - INFO - Model on device: cuda
2025-05-29 07:52:57,155 - utils.optimizers - INFO - Using discriminative learning rate: Encoder LR = 5e-06, Decoder/Other LR = 5e-05
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - Scheduler Setup: Steps per epoch=40822, Total Steps=4082200, Warmup=204110
2025-05-29 07:52:57,157 - utils.schedulers - INFO - CosineWarmupScheduler initialized: warmup=204110, max_steps=4082200, eta_min=0
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - Optimizer/Scheduler created.
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - Compatibility matrix found in optimizer param_group 0 with initial lr=1.2248297486649356e-09
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - Increased compatibility matrix learning rate in param_group 0 to 3.062074371662339e-08 (original: 1.2248297486649356e-09, multiplier: 25.0)
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - Set weight_decay for compatibility matrix param_group 0 to 0.0 (original: 0.02)
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - No checkpoint found to resume from.
2025-05-29 07:52:57,157 - TrainHierarchicalMultiScaleScript - INFO - Starting fresh or from base weights.
2025-05-29 07:52:58,890 - TrainHierarchicalMultiScaleScript - INFO - Initialized WandB run: opt_3 (ID: pz6agmwb)
2025-05-29 07:52:58,890 - TrainHierarchicalMultiScaleScript - INFO - ============ Starting Hierarchical Multi-Scale CTC Training Phase ============
2025-05-29 07:52:58,890 - CtcTrainer - INFO - Trainer using device: cuda
2025-05-29 07:52:58,891 - CtcTrainer - INFO - Train DataLoader: 40822 batches, Val DataLoader: 2149 batches
2025-05-29 07:52:58,891 - CtcTrainer - INFO - Trainer starting with default GradScaler state.
2025-05-29 07:52:58,891 - CtcTrainer - INFO - Using combined_char_vocab for validation decoder.
2025-05-29 07:52:58,892 - CtcTrainer - INFO - Validation CTCDecoder initialized (Blank Index: 0).
2025-05-29 07:52:58,892 - CtcTrainer - INFO - --- Starting Training Loop from Epoch 1 ---
2025-05-29 07:52:58,892 - CtcTrainer - INFO - Starting with default GradScaler state.
2025-05-29 07:52:58,892 - CtcTrainer - INFO - Starting Epoch 1/100
2025-05-29 07:58:51,967 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 09:21:45,129 - CtcTrainer - INFO - Running end-of-epoch 1 validation...
2025-05-29 09:21:50,913 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 09:21:50,915 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 09:21:50,916 - training.ctc_validation - INFO -   Prediction  : 'Nggườ v tội gờa già nh bc'
2025-05-29 09:21:50,916 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 09:21:50,916 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 09:21:50,916 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 09:21:50,916 - training.ctc_validation - INFO -   Prediction  : 'Ễ'
2025-05-29 09:21:50,916 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 09:21:50,916 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 09:21:50,916 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 09:21:50,917 - training.ctc_validation - INFO -   Prediction  : 'V00 ngày 3 thàng 12 nam 117'
2025-05-29 09:21:50,917 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 09:21:50,917 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 09:21:50,917 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 09:21:50,917 - training.ctc_validation - INFO -   Prediction  : 'H ười bời bàt hâu gâu gài lài mài qau hàn cc'
2025-05-29 09:21:50,917 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 09:21:50,917 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 09:21:50,917 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 09:21:50,918 - training.ctc_validation - INFO -   Prediction  : 'bưới'
2025-05-29 09:21:50,918 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 09:26:01,943 - training.ctc_validation - INFO - Validation Results: Loss=42.3404, CER=0.4646, WER=0.9086
2025-05-29 09:26:01,943 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 09:26:01,948 - CtcTrainer - INFO - --- Epoch 1/100 Summary ---
2025-05-29 09:26:01,948 - CtcTrainer - INFO - Avg Train Loss: 16.5078
2025-05-29 09:26:01,948 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 42.340403190845386, 'val_cer': 0.46459944849400336, 'val_wer': 0.9086282386927869}
2025-05-29 09:26:01,948 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: inf
2025-05-29 09:26:01,949 - CtcTrainer - INFO - ---------------------
2025-05-29 09:26:01,952 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 09:26:03,799 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 09:26:03,800 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 09:26:05,643 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 09:26:05,644 - CtcTrainer - INFO - New best metric (val_cer) at epoch 1: 0.4646
2025-05-29 09:26:05,646 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 09:26:05,647 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 09:26:05,648 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 09:26:06,529 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 09:26:06,529 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 09:26:07,172 - CtcTrainer - INFO - Starting Epoch 2/100
2025-05-29 10:24:30,519 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 10:54:29,511 - CtcTrainer - INFO - Running end-of-epoch 2 validation...
2025-05-29 10:54:31,976 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 10:54:31,977 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 10:54:31,977 - training.ctc_validation - INFO -   Prediction  : 'Người vọ tuổi gi như bác'
2025-05-29 10:54:31,977 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 10:54:31,977 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 10:54:31,977 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 10:54:31,977 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 10:54:31,977 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 10:54:31,977 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 10:54:31,978 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 10:54:31,978 - training.ctc_validation - INFO -   Prediction  : 'vào ngây 31 tháng 12 năm 1947.'
2025-05-29 10:54:31,978 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 10:54:31,978 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 10:54:31,978 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 10:54:31,978 - training.ctc_validation - INFO -   Prediction  : 'Hai người hất đầu han gần lại mới quan hị của họ'
2025-05-29 10:54:31,978 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 10:54:31,978 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 10:54:31,978 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 10:54:31,979 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-29 10:54:31,979 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 10:58:39,731 - training.ctc_validation - INFO - Validation Results: Loss=24.3253, CER=0.2771, WER=0.6390
2025-05-29 10:58:39,732 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 10:58:39,742 - CtcTrainer - INFO - --- Epoch 2/100 Summary ---
2025-05-29 10:58:39,742 - CtcTrainer - INFO - Avg Train Loss: 1.4846
2025-05-29 10:58:39,742 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 24.325303703955726, 'val_cer': 0.2770810734090978, 'val_wer': 0.6390211699918751}
2025-05-29 10:58:39,743 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.4646
2025-05-29 10:58:39,743 - CtcTrainer - INFO - ---------------------
2025-05-29 10:58:39,750 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 10:58:43,595 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 10:58:43,598 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 10:58:48,254 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 10:58:48,258 - CtcTrainer - INFO - New best metric (val_cer) at epoch 2: 0.2771
2025-05-29 10:58:48,272 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 10:58:48,273 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 10:58:48,275 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 10:58:49,669 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 10:58:49,669 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 10:58:50,179 - CtcTrainer - INFO - Starting Epoch 3/100
2025-05-29 11:21:59,942 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 12:28:00,669 - CtcTrainer - INFO - Running end-of-epoch 3 validation...
2025-05-29 12:28:03,175 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 12:28:03,175 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 12:28:03,176 - training.ctc_validation - INFO -   Prediction  : 'Người vọ tuổi giả như bác'
2025-05-29 12:28:03,176 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 12:28:03,176 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 12:28:03,176 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 12:28:03,176 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 12:28:03,177 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 12:28:03,177 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 12:28:03,177 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 12:28:03,177 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 194.'
2025-05-29 12:28:03,177 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 12:28:03,177 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 12:28:03,177 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 12:28:03,177 - training.ctc_validation - INFO -   Prediction  : 'Hai người hắt đầu ban gản lái mố quan h ócủa ọ'
2025-05-29 12:28:03,177 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 12:28:03,177 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 12:28:03,178 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 12:28:03,178 - training.ctc_validation - INFO -   Prediction  : 'bưổi'
2025-05-29 12:28:03,178 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 12:32:15,263 - training.ctc_validation - INFO - Validation Results: Loss=20.6068, CER=0.2430, WER=0.5762
2025-05-29 12:32:15,264 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 12:32:15,274 - CtcTrainer - INFO - --- Epoch 3/100 Summary ---
2025-05-29 12:32:15,275 - CtcTrainer - INFO - Avg Train Loss: 1.2067
2025-05-29 12:32:15,275 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 20.606754233123038, 'val_cer': 0.2429870538022486, 'val_wer': 0.5761769883542476}
2025-05-29 12:32:15,275 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2771
2025-05-29 12:32:15,275 - CtcTrainer - INFO - ---------------------
2025-05-29 12:32:15,279 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 12:32:17,364 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 12:32:17,364 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 12:32:21,519 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 12:32:21,520 - CtcTrainer - INFO - New best metric (val_cer) at epoch 3: 0.2430
2025-05-29 12:32:21,524 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 12:32:21,525 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 12:32:21,528 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 12:32:24,453 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 12:32:24,453 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 12:32:24,998 - CtcTrainer - INFO - Starting Epoch 4/100
2025-05-29 13:55:06,569 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 14:00:52,165 - CtcTrainer - INFO - Running end-of-epoch 4 validation...
2025-05-29 14:00:54,784 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 14:00:54,785 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 14:00:54,785 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi giả như bác'
2025-05-29 14:00:54,786 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 14:00:54,786 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 14:00:54,786 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 14:00:54,787 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 14:00:54,787 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 14:00:54,787 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 14:00:54,788 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 14:00:54,788 - training.ctc_validation - INFO -   Prediction  : 'vào này 31 tháng 12 năm 194.'
2025-05-29 14:00:54,788 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 14:00:54,788 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 14:00:54,789 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 14:00:54,789 - training.ctc_validation - INFO -   Prediction  : 'Hại người hắt đầu lạn gu lại mới quan họ của họ'
2025-05-29 14:00:54,789 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 14:00:54,789 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 14:00:54,790 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 14:00:54,790 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-29 14:00:54,790 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 14:05:04,753 - training.ctc_validation - INFO - Validation Results: Loss=19.8530, CER=0.2315, WER=0.5524
2025-05-29 14:05:04,753 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 14:05:04,756 - CtcTrainer - INFO - --- Epoch 4/100 Summary ---
2025-05-29 14:05:04,757 - CtcTrainer - INFO - Avg Train Loss: 1.1275
2025-05-29 14:05:04,757 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 19.8530099264322, 'val_cer': 0.23148551789859995, 'val_wer': 0.5524284553579489}
2025-05-29 14:05:04,757 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2430
2025-05-29 14:05:04,757 - CtcTrainer - INFO - ---------------------
2025-05-29 14:05:04,760 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 14:05:09,039 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 14:05:09,041 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 14:05:12,802 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 14:05:12,803 - CtcTrainer - INFO - New best metric (val_cer) at epoch 4: 0.2315
2025-05-29 14:05:12,807 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 14:05:12,808 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 14:05:12,809 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 14:05:14,117 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 14:05:14,117 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 14:05:14,615 - CtcTrainer - INFO - Starting Epoch 5/100
2025-05-29 14:59:15,668 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 15:33:36,288 - CtcTrainer - INFO - Running end-of-epoch 5 validation...
2025-05-29 15:33:38,753 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 15:33:38,754 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 15:33:38,754 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi giả như bác'
2025-05-29 15:33:38,754 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 15:33:38,754 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 15:33:38,754 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 15:33:38,754 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 15:33:38,754 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 15:33:38,754 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 15:33:38,754 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 15:33:38,755 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 15:33:38,755 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 15:33:38,755 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 15:33:38,755 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 15:33:38,755 - training.ctc_validation - INFO -   Prediction  : 'Hai người hất đầu han gần lại l muới quan h của họ'
2025-05-29 15:33:38,755 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 15:33:38,755 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 15:33:38,755 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 15:33:38,755 - training.ctc_validation - INFO -   Prediction  : 'bưổi'
2025-05-29 15:33:38,756 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 15:37:46,875 - training.ctc_validation - INFO - Validation Results: Loss=17.8155, CER=0.2038, WER=0.4966
2025-05-29 15:37:46,875 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 15:37:46,880 - CtcTrainer - INFO - --- Epoch 5/100 Summary ---
2025-05-29 15:37:46,880 - CtcTrainer - INFO - Avg Train Loss: 1.1008
2025-05-29 15:37:46,880 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 17.815532518426345, 'val_cer': 0.20375307941078072, 'val_wer': 0.49662024916493636}
2025-05-29 15:37:46,881 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2315
2025-05-29 15:37:46,881 - CtcTrainer - INFO - ---------------------
2025-05-29 15:37:46,885 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 15:37:49,137 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 15:37:49,137 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 15:37:52,180 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 15:37:52,180 - CtcTrainer - INFO - New best metric (val_cer) at epoch 5: 0.2038
2025-05-29 15:37:52,184 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 15:37:52,185 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 15:37:52,185 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 15:37:53,483 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 15:37:53,483 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 15:37:53,997 - CtcTrainer - INFO - Starting Epoch 6/100
2025-05-29 16:14:32,368 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 17:06:02,848 - CtcTrainer - INFO - Running end-of-epoch 6 validation...
2025-05-29 17:06:05,553 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 17:06:05,553 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 17:06:05,554 - training.ctc_validation - INFO -   Prediction  : 'Người vọ tuổi giả như bác'
2025-05-29 17:06:05,554 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 17:06:05,554 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 17:06:05,554 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 17:06:05,555 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 17:06:05,555 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 17:06:05,555 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 17:06:05,555 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 17:06:05,555 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 331 thắng 12 năm 1947.'
2025-05-29 17:06:05,556 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 17:06:05,556 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 17:06:05,556 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 17:06:05,556 - training.ctc_validation - INFO -   Prediction  : 'Haiingười bất đầu bạn gần lại mớ quan hệ của họ'
2025-05-29 17:06:05,557 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 17:06:05,557 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 17:06:05,557 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 17:06:05,557 - training.ctc_validation - INFO -   Prediction  : 'bổi'
2025-05-29 17:06:05,557 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 17:10:12,205 - training.ctc_validation - INFO - Validation Results: Loss=17.5169, CER=0.2032, WER=0.5060
2025-05-29 17:10:12,205 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 17:10:12,209 - CtcTrainer - INFO - --- Epoch 6/100 Summary ---
2025-05-29 17:10:12,210 - CtcTrainer - INFO - Avg Train Loss: 1.0593
2025-05-29 17:10:12,210 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 17.51685510981158, 'val_cer': 0.20322083557213677, 'val_wer': 0.5060259998194457}
2025-05-29 17:10:12,210 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2038
2025-05-29 17:10:12,210 - CtcTrainer - INFO - ---------------------
2025-05-29 17:10:12,214 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 17:10:16,429 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 17:10:16,430 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 17:10:20,455 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 17:10:20,457 - CtcTrainer - INFO - New best metric (val_cer) at epoch 6: 0.2032
2025-05-29 17:10:20,476 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 17:10:20,478 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 17:10:20,481 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 17:10:22,070 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 17:10:22,070 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 17:10:22,653 - CtcTrainer - INFO - Starting Epoch 7/100
2025-05-29 18:25:38,167 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 18:39:51,903 - CtcTrainer - INFO - Running end-of-epoch 7 validation...
2025-05-29 18:39:54,287 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 18:39:54,287 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 18:39:54,287 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-29 18:39:54,287 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 18:39:54,304 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 18:39:54,304 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 18:39:54,304 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 18:39:54,305 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 18:39:54,305 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 18:39:54,305 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 18:39:54,305 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 18:39:54,305 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 18:39:54,305 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 18:39:54,305 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 18:39:54,305 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu ạun gần lại mới quan hệ của họ'
2025-05-29 18:39:54,306 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 18:39:54,306 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 18:39:54,306 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 18:39:54,306 - training.ctc_validation - INFO -   Prediction  : 'bưổi'
2025-05-29 18:39:54,306 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 18:45:36,082 - training.ctc_validation - INFO - Validation Results: Loss=15.2791, CER=0.1769, WER=0.4500
2025-05-29 18:45:36,083 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 18:45:36,087 - CtcTrainer - INFO - --- Epoch 7/100 Summary ---
2025-05-29 18:45:36,087 - CtcTrainer - INFO - Avg Train Loss: 1.0349
2025-05-29 18:45:36,087 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 15.279121571539278, 'val_cer': 0.17688997252607994, 'val_wer': 0.44996388913965873}
2025-05-29 18:45:36,087 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2032
2025-05-29 18:45:36,087 - CtcTrainer - INFO - ---------------------
2025-05-29 18:45:36,091 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 18:45:39,330 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 18:45:39,331 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 18:45:42,572 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 18:45:42,573 - CtcTrainer - INFO - New best metric (val_cer) at epoch 7: 0.1769
2025-05-29 18:45:42,576 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 18:45:42,577 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 18:45:42,578 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 18:45:43,962 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 18:45:43,963 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 18:45:44,615 - CtcTrainer - INFO - Starting Epoch 8/100
2025-05-29 20:06:03,136 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 20:14:51,736 - CtcTrainer - INFO - Running end-of-epoch 8 validation...
2025-05-29 20:14:54,210 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 20:14:54,210 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 20:14:54,210 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-29 20:14:54,210 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 20:14:54,211 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 20:14:54,211 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 20:14:54,211 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 20:14:54,211 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 20:14:54,211 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 20:14:54,211 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 20:14:54,211 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năăm 1947.'
2025-05-29 20:14:54,211 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 20:14:54,211 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 20:14:54,211 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 20:14:54,211 - training.ctc_validation - INFO -   Prediction  : 'Hai ngườihất đu bạn gần lạớimới quan họa củ họọ'
2025-05-29 20:14:54,212 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 20:14:54,212 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 20:14:54,212 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 20:14:54,212 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-29 20:14:54,212 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 20:19:05,163 - training.ctc_validation - INFO - Validation Results: Loss=15.0652, CER=0.1723, WER=0.4375
2025-05-29 20:19:05,163 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 20:19:05,177 - CtcTrainer - INFO - --- Epoch 8/100 Summary ---
2025-05-29 20:19:05,177 - CtcTrainer - INFO - Avg Train Loss: 1.0087
2025-05-29 20:19:05,177 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 15.06515535785066, 'val_cer': 0.17233928770567422, 'val_wer': 0.43752256928771327}
2025-05-29 20:19:05,177 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1769
2025-05-29 20:19:05,178 - CtcTrainer - INFO - ---------------------
2025-05-29 20:19:05,181 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 20:19:08,372 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 20:19:08,373 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 20:19:11,561 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 20:19:11,562 - CtcTrainer - INFO - New best metric (val_cer) at epoch 8: 0.1723
2025-05-29 20:19:11,568 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 20:19:11,569 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 20:19:11,570 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 20:19:12,756 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 20:19:12,756 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 20:19:13,294 - CtcTrainer - INFO - Starting Epoch 9/100
2025-05-29 21:14:09,647 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 21:48:08,402 - CtcTrainer - INFO - Running end-of-epoch 9 validation...
2025-05-29 21:48:10,978 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 21:48:10,979 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 21:48:10,979 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi giả như bác'
2025-05-29 21:48:10,979 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 21:48:10,979 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 21:48:10,979 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 21:48:10,980 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 21:48:10,980 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 21:48:10,980 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 21:48:10,980 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 21:48:10,980 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 19947.'
2025-05-29 21:48:10,981 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 21:48:10,981 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 21:48:10,981 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 21:48:10,981 - training.ctc_validation - INFO -   Prediction  : 'Hai người bất đâu hàn gần lại mới quan hệ của họ'
2025-05-29 21:48:10,981 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 21:48:10,981 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 21:48:10,982 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 21:48:10,982 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-29 21:48:10,982 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 21:52:15,754 - training.ctc_validation - INFO - Validation Results: Loss=13.7895, CER=0.1607, WER=0.4118
2025-05-29 21:52:15,755 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 21:52:15,761 - CtcTrainer - INFO - --- Epoch 9/100 Summary ---
2025-05-29 21:52:15,761 - CtcTrainer - INFO - Avg Train Loss: 0.9772
2025-05-29 21:52:15,761 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 13.789547944779116, 'val_cer': 0.16074904449558491, 'val_wer': 0.4117766543287894}
2025-05-29 21:52:15,761 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1723
2025-05-29 21:52:15,762 - CtcTrainer - INFO - ---------------------
2025-05-29 21:52:15,768 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 21:52:18,037 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 21:52:18,038 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 21:52:21,413 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 21:52:21,414 - CtcTrainer - INFO - New best metric (val_cer) at epoch 9: 0.1607
2025-05-29 21:52:21,419 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 21:52:21,420 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 21:52:21,421 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 21:52:22,987 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 21:52:22,987 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 21:52:23,866 - CtcTrainer - INFO - Starting Epoch 10/100
2025-05-29 22:32:23,372 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-29 23:20:59,824 - CtcTrainer - INFO - Running end-of-epoch 10 validation...
2025-05-29 23:21:02,329 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-29 23:21:02,330 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-29 23:21:02,330 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-29 23:21:02,330 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 23:21:02,330 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-29 23:21:02,330 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-29 23:21:02,330 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-29 23:21:02,330 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 23:21:02,330 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-29 23:21:02,330 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 23:21:02,330 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-29 23:21:02,331 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 23:21:02,331 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-29 23:21:02,331 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-29 23:21:02,331 - training.ctc_validation - INFO -   Prediction  : 'Hai người hất đầu hơn gần lạ  mới quan hộ của họ'
2025-05-29 23:21:02,331 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 23:21:02,331 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-29 23:21:02,331 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-29 23:21:02,331 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-29 23:21:02,331 - training.ctc_validation - INFO - ---------------------------------
2025-05-29 23:25:13,481 - training.ctc_validation - INFO - Validation Results: Loss=13.4054, CER=0.1574, WER=0.4002
2025-05-29 23:25:13,482 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-29 23:25:13,487 - CtcTrainer - INFO - --- Epoch 10/100 Summary ---
2025-05-29 23:25:13,487 - CtcTrainer - INFO - Avg Train Loss: 0.9420
2025-05-29 23:25:13,487 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 13.40536347907561, 'val_cer': 0.15744279645981812, 'val_wer': 0.40019296740994853}
2025-05-29 23:25:13,488 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1607
2025-05-29 23:25:13,488 - CtcTrainer - INFO - ---------------------
2025-05-29 23:25:13,491 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-29 23:25:15,624 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-29 23:25:15,625 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-29 23:25:19,290 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-29 23:25:19,291 - CtcTrainer - INFO - New best metric (val_cer) at epoch 10: 0.1574
2025-05-29 23:25:19,294 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-29 23:25:19,295 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 23:25:19,297 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-29 23:25:20,914 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-29 23:25:20,914 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-29 23:25:21,493 - CtcTrainer - INFO - Starting Epoch 11/100
2025-05-30 00:34:02,269 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 00:53:53,148 - CtcTrainer - INFO - Running end-of-epoch 11 validation...
2025-05-30 00:53:55,578 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 00:53:55,579 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 00:53:55,579 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi gi như bác'
2025-05-30 00:53:55,579 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 00:53:55,579 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 00:53:55,579 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 00:53:55,579 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 00:53:55,579 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 00:53:55,579 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 00:53:55,579 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 00:53:55,579 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 00:53:55,579 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 00:53:55,580 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 00:53:55,580 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 00:53:55,580 - training.ctc_validation - INFO -   Prediction  : 'Hai nười hất đâu hạn gần lại mới quan hệ của họ'
2025-05-30 00:53:55,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 00:53:55,580 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 00:53:55,580 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 00:53:55,580 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 00:53:55,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 00:58:03,557 - training.ctc_validation - INFO - Validation Results: Loss=13.4399, CER=0.1563, WER=0.3975
2025-05-30 00:58:03,557 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 00:58:03,567 - CtcTrainer - INFO - --- Epoch 11/100 Summary ---
2025-05-30 00:58:03,567 - CtcTrainer - INFO - Avg Train Loss: 0.9417
2025-05-30 00:58:03,567 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 13.439947048591852, 'val_cer': 0.15625665304798306, 'val_wer': 0.3974959375282116}
2025-05-30 00:58:03,567 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1574
2025-05-30 00:58:03,568 - CtcTrainer - INFO - ---------------------
2025-05-30 00:58:03,571 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 00:58:07,308 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 00:58:07,309 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 00:58:11,226 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 00:58:11,227 - CtcTrainer - INFO - New best metric (val_cer) at epoch 11: 0.1563
2025-05-30 00:58:11,231 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 00:58:11,232 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 00:58:11,233 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 00:58:12,868 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 00:58:12,869 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 00:58:13,424 - CtcTrainer - INFO - Starting Epoch 12/100
2025-05-30 01:59:46,595 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 02:26:33,416 - CtcTrainer - INFO - Running end-of-epoch 12 validation...
2025-05-30 02:26:35,690 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 02:26:35,691 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 02:26:35,691 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 02:26:35,691 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 02:26:35,692 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 02:26:35,692 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 02:26:35,692 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 02:26:35,692 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 02:26:35,692 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 02:26:35,693 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 02:26:35,693 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 02:26:35,693 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 02:26:35,693 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 02:26:35,693 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 02:26:35,693 - training.ctc_validation - INFO -   Prediction  : 'Hai người hất đầu bạn gần lại mối quan hc của họ'
2025-05-30 02:26:35,693 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 02:26:35,693 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 02:26:35,693 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 02:26:35,693 - training.ctc_validation - INFO -   Prediction  : 'bổi'
2025-05-30 02:26:35,694 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 02:30:41,950 - training.ctc_validation - INFO - Validation Results: Loss=13.7426, CER=0.1555, WER=0.3976
2025-05-30 02:30:41,951 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 02:30:41,958 - CtcTrainer - INFO - --- Epoch 12/100 Summary ---
2025-05-30 02:30:41,958 - CtcTrainer - INFO - Avg Train Loss: 0.9151
2025-05-30 02:30:41,959 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 13.742628692304475, 'val_cer': 0.1555393911130486, 'val_wer': 0.3976144262887063}
2025-05-30 02:30:41,959 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1563
2025-05-30 02:30:41,959 - CtcTrainer - INFO - ---------------------
2025-05-30 02:30:41,963 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 02:30:45,312 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 02:30:45,313 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 02:30:48,321 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 02:30:48,321 - CtcTrainer - INFO - New best metric (val_cer) at epoch 12: 0.1555
2025-05-30 02:30:48,324 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 02:30:48,325 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 02:30:48,327 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 02:30:49,572 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 02:30:49,572 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 02:30:50,031 - CtcTrainer - INFO - Starting Epoch 13/100
2025-05-30 02:33:14,075 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 03:59:05,475 - CtcTrainer - INFO - Running end-of-epoch 13 validation...
2025-05-30 03:59:07,783 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 03:59:07,784 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 03:59:07,784 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 03:59:07,785 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 03:59:07,785 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 03:59:07,785 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 03:59:07,785 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 03:59:07,785 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 03:59:07,785 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 03:59:07,785 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 03:59:07,785 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947].'
2025-05-30 03:59:07,785 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 03:59:07,785 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 03:59:07,786 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 03:59:07,786 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu hàn gần lại mới quanhệ của họ'
2025-05-30 03:59:07,786 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 03:59:07,786 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 03:59:07,786 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 03:59:07,786 - training.ctc_validation - INFO -   Prediction  : 'bổi'
2025-05-30 03:59:07,786 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 04:03:14,037 - training.ctc_validation - INFO - Validation Results: Loss=11.9714, CER=0.1376, WER=0.3587
2025-05-30 04:03:14,037 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 04:03:14,041 - CtcTrainer - INFO - --- Epoch 13/100 Summary ---
2025-05-30 04:03:14,041 - CtcTrainer - INFO - Avg Train Loss: 0.8853
2025-05-30 04:03:14,042 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 11.971404833490693, 'val_cer': 0.13763698942608907, 'val_wer': 0.3587388282025819}
2025-05-30 04:03:14,042 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1555
2025-05-30 04:03:14,042 - CtcTrainer - INFO - ---------------------
2025-05-30 04:03:14,047 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 04:03:17,104 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 04:03:17,105 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 04:03:20,092 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 04:03:20,092 - CtcTrainer - INFO - New best metric (val_cer) at epoch 13: 0.1376
2025-05-30 04:03:20,095 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 04:03:20,097 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 04:03:20,098 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 04:03:21,388 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 04:03:21,389 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 04:03:21,945 - CtcTrainer - INFO - Starting Epoch 14/100
2025-05-30 04:15:09,071 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 05:31:45,052 - CtcTrainer - INFO - Running end-of-epoch 14 validation...
2025-05-30 05:31:47,418 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 05:31:47,419 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 05:31:47,419 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 05:31:47,419 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 05:31:47,419 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 05:31:47,419 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 05:31:47,419 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 05:31:47,420 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 05:31:47,420 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 05:31:47,420 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 05:31:47,420 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 05:31:47,420 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 05:31:47,420 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 05:31:47,420 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 05:31:47,420 - training.ctc_validation - INFO -   Prediction  : 'Hai người hất đầu hơn gần lại mới quan hệ của họ'
2025-05-30 05:31:47,420 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 05:31:47,420 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 05:31:47,420 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 05:31:47,421 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 05:31:47,421 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 05:35:58,898 - training.ctc_validation - INFO - Validation Results: Loss=11.2097, CER=0.1321, WER=0.3473
2025-05-30 05:35:58,898 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 05:35:58,903 - CtcTrainer - INFO - --- Epoch 14/100 Summary ---
2025-05-30 05:35:58,903 - CtcTrainer - INFO - Avg Train Loss: 0.8715
2025-05-30 05:35:58,903 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 11.209748187521765, 'val_cer': 0.13205349810926711, 'val_wer': 0.34730748397580574}
2025-05-30 05:35:58,903 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1376
2025-05-30 05:35:58,903 - CtcTrainer - INFO - ---------------------
2025-05-30 05:35:58,906 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 05:36:01,227 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 05:36:01,228 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 05:36:04,513 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 05:36:04,513 - CtcTrainer - INFO - New best metric (val_cer) at epoch 14: 0.1321
2025-05-30 05:36:04,517 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 05:36:04,518 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 05:36:04,519 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 05:36:06,327 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 05:36:06,327 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 05:36:06,874 - CtcTrainer - INFO - Starting Epoch 15/100
2025-05-30 06:35:15,698 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 07:04:56,876 - CtcTrainer - INFO - Running end-of-epoch 15 validation...
2025-05-30 07:04:58,977 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 07:04:58,978 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 07:04:58,979 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 07:04:58,979 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 07:04:58,979 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 07:04:58,979 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 07:04:58,979 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 07:04:58,979 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 07:04:58,979 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 07:04:58,979 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 07:04:58,980 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 07:04:58,980 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 07:04:58,980 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 07:04:58,980 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 07:04:58,980 - training.ctc_validation - INFO -   Prediction  : 'Hai nười bất đâu bạn gần lời mới quan hệ của họ'
2025-05-30 07:04:58,980 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 07:04:58,980 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 07:04:58,980 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 07:04:58,981 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 07:04:58,981 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 07:09:04,864 - training.ctc_validation - INFO - Validation Results: Loss=10.9289, CER=0.1265, WER=0.3330
2025-05-30 07:09:04,864 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 07:09:04,868 - CtcTrainer - INFO - --- Epoch 15/100 Summary ---
2025-05-30 07:09:04,868 - CtcTrainer - INFO - Avg Train Loss: 0.8674
2025-05-30 07:09:04,868 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 10.928883482987088, 'val_cer': 0.12649028274820304, 'val_wer': 0.3329816285998014}
2025-05-30 07:09:04,868 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1321
2025-05-30 07:09:04,869 - CtcTrainer - INFO - ---------------------
2025-05-30 07:09:04,875 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 07:09:08,886 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 07:09:08,893 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 07:09:13,050 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 07:09:13,054 - CtcTrainer - INFO - New best metric (val_cer) at epoch 15: 0.1265
2025-05-30 07:09:13,067 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 07:09:13,069 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 07:09:13,071 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 07:09:14,389 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 07:09:14,389 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 07:09:14,936 - CtcTrainer - INFO - Starting Epoch 16/100
2025-05-30 07:19:29,465 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 08:37:26,140 - CtcTrainer - INFO - Running end-of-epoch 16 validation...
2025-05-30 08:37:28,670 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 08:37:28,670 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 08:37:28,672 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 08:37:28,672 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 08:37:28,672 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 08:37:28,672 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 08:37:28,672 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 08:37:28,672 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 08:37:28,672 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 08:37:28,672 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 08:37:28,673 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 08:37:28,673 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 08:37:28,673 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 08:37:28,673 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 08:37:28,673 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bơn gần lại mới quan họ  của họ'
2025-05-30 08:37:28,673 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 08:37:28,673 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 08:37:28,673 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 08:37:28,673 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 08:37:28,673 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 08:41:34,741 - training.ctc_validation - INFO - Validation Results: Loss=10.5557, CER=0.1227, WER=0.3277
2025-05-30 08:41:34,741 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 08:41:34,744 - CtcTrainer - INFO - --- Epoch 16/100 Summary ---
2025-05-30 08:41:34,745 - CtcTrainer - INFO - Avg Train Loss: 0.8483
2025-05-30 08:41:34,745 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 10.55573446909605, 'val_cer': 0.12271515323553564, 'val_wer': 0.3277229845626072}
2025-05-30 08:41:34,745 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1265
2025-05-30 08:41:34,745 - CtcTrainer - INFO - ---------------------
2025-05-30 08:41:34,749 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 08:41:37,958 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 08:41:37,959 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 08:41:42,275 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 08:41:42,276 - CtcTrainer - INFO - New best metric (val_cer) at epoch 16: 0.1227
2025-05-30 08:41:42,281 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 08:41:42,282 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 08:41:42,284 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 08:41:43,991 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 08:41:43,992 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 08:41:44,556 - CtcTrainer - INFO - Starting Epoch 17/100
2025-05-30 09:55:14,577 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 10:10:02,533 - CtcTrainer - INFO - Running end-of-epoch 17 validation...
2025-05-30 10:10:04,776 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 10:10:04,776 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 10:10:04,777 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi giả như bác'
2025-05-30 10:10:04,777 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 10:10:04,777 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 10:10:04,777 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 10:10:04,777 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 10:10:04,777 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 10:10:04,778 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 10:10:04,778 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 10:10:04,778 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 táng 12 năm 1947.'
2025-05-30 10:10:04,778 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 10:10:04,778 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 10:10:04,778 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 10:10:04,778 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mỗi quan hệ của họ'
2025-05-30 10:10:04,778 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 10:10:04,779 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 10:10:04,779 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 10:10:04,779 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 10:10:04,779 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 10:14:12,250 - training.ctc_validation - INFO - Validation Results: Loss=10.2876, CER=0.1208, WER=0.3247
2025-05-30 10:14:12,250 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 10:14:12,254 - CtcTrainer - INFO - --- Epoch 17/100 Summary ---
2025-05-30 10:14:12,254 - CtcTrainer - INFO - Avg Train Loss: 0.8409
2025-05-30 10:14:12,254 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 10.287595020391677, 'val_cer': 0.12083709283346344, 'val_wer': 0.32473255394059763}
2025-05-30 10:14:12,254 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1227
2025-05-30 10:14:12,255 - CtcTrainer - INFO - ---------------------
2025-05-30 10:14:12,257 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 10:14:16,742 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 10:14:16,743 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 10:14:21,030 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 10:14:21,030 - CtcTrainer - INFO - New best metric (val_cer) at epoch 17: 0.1208
2025-05-30 10:14:21,034 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 10:14:21,034 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 10:14:21,036 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 10:14:22,239 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 10:14:22,239 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 10:14:22,698 - CtcTrainer - INFO - Starting Epoch 18/100
2025-05-30 10:34:48,075 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 11:42:38,742 - CtcTrainer - INFO - Running end-of-epoch 18 validation...
2025-05-30 11:42:41,246 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 11:42:41,246 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 11:42:41,246 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 11:42:41,247 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 11:42:41,247 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 11:42:41,247 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 11:42:41,247 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 11:42:41,247 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 11:42:41,247 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 11:42:41,247 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 11:42:41,247 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 11:42:41,248 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 11:42:41,248 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 11:42:41,248 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 11:42:41,248 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu hàn gầ lại mới quan hệ của họ'
2025-05-30 11:42:41,249 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 11:42:41,249 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 11:42:41,249 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 11:42:41,249 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 11:42:41,249 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 11:46:51,001 - training.ctc_validation - INFO - Validation Results: Loss=10.6152, CER=0.1242, WER=0.3284
2025-05-30 11:46:51,002 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 11:46:51,008 - CtcTrainer - INFO - --- Epoch 18/100 Summary ---
2025-05-30 11:46:51,008 - CtcTrainer - INFO - Avg Train Loss: 0.8359
2025-05-30 11:46:51,008 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 10.615218829340177, 'val_cer': 0.12424725514248929, 'val_wer': 0.32837749390629234}
2025-05-30 11:46:51,008 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1208
2025-05-30 11:46:51,009 - CtcTrainer - INFO - ---------------------
2025-05-30 11:46:51,017 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 11:46:53,121 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 11:46:53,121 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-05-30 11:46:54,073 - CtcTrainer - INFO - Starting Epoch 19/100
2025-05-30 12:38:32,836 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 13:14:59,749 - CtcTrainer - INFO - Running end-of-epoch 19 validation...
2025-05-30 13:15:02,079 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 13:15:02,080 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 13:15:02,080 - training.ctc_validation - INFO -   Prediction  : 'Người vợtuổi già như bác'
2025-05-30 13:15:02,081 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 13:15:02,081 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 13:15:02,081 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 13:15:02,081 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 13:15:02,081 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 13:15:02,082 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 13:15:02,082 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 13:15:02,083 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 197.'
2025-05-30 13:15:02,083 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 13:15:02,083 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 13:15:02,084 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 13:15:02,084 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mới quan hệ của họ'
2025-05-30 13:15:02,084 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 13:15:02,085 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 13:15:02,085 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 13:15:02,085 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 13:15:02,085 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 13:19:12,003 - training.ctc_validation - INFO - Validation Results: Loss=10.2023, CER=0.1202, WER=0.3199
2025-05-30 13:19:12,004 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 13:19:12,008 - CtcTrainer - INFO - --- Epoch 19/100 Summary ---
2025-05-30 13:19:12,008 - CtcTrainer - INFO - Avg Train Loss: 0.8160
2025-05-30 13:19:12,008 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 10.202283742374005, 'val_cer': 0.12020727095773477, 'val_wer': 0.31993658030152566}
2025-05-30 13:19:12,008 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1208
2025-05-30 13:19:12,008 - CtcTrainer - INFO - ---------------------
2025-05-30 13:19:12,012 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 13:19:14,188 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 13:19:14,188 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 13:19:17,705 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 13:19:17,705 - CtcTrainer - INFO - New best metric (val_cer) at epoch 19: 0.1202
2025-05-30 13:19:17,710 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 13:19:17,711 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 13:19:17,712 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 13:19:18,916 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 13:19:18,916 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 13:19:19,450 - CtcTrainer - INFO - Starting Epoch 20/100
2025-05-30 14:12:44,392 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 14:47:55,103 - CtcTrainer - INFO - Running end-of-epoch 20 validation...
2025-05-30 14:47:57,089 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 14:47:57,090 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 14:47:57,090 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tổi già như bác'
2025-05-30 14:47:57,091 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 14:47:57,091 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 14:47:57,092 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 14:47:57,092 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 14:47:57,092 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 14:47:57,093 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 14:47:57,174 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 14:47:57,175 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 14:47:57,175 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 14:47:57,175 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 14:47:57,175 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 14:47:57,176 - training.ctc_validation - INFO -   Prediction  : 'Hai người bất đầu hàn gần lại mới quan hệ của họ'
2025-05-30 14:47:57,176 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 14:47:57,176 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 14:47:57,176 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 14:47:57,176 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 14:47:57,176 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 14:52:09,681 - training.ctc_validation - INFO - Validation Results: Loss=9.8885, CER=0.1154, WER=0.3108
2025-05-30 14:52:09,681 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 14:52:09,685 - CtcTrainer - INFO - --- Epoch 20/100 Summary ---
2025-05-30 14:52:09,686 - CtcTrainer - INFO - Avg Train Loss: 0.8139
2025-05-30 14:52:09,686 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 9.888497058557915, 'val_cer': 0.1154462230963412, 'val_wer': 0.3108467996750023}
2025-05-30 14:52:09,686 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1202
2025-05-30 14:52:09,686 - CtcTrainer - INFO - ---------------------
2025-05-30 14:52:09,690 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 14:52:12,156 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 14:52:12,157 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 14:52:15,574 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 14:52:15,575 - CtcTrainer - INFO - New best metric (val_cer) at epoch 20: 0.1154
2025-05-30 14:52:15,579 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 14:52:15,579 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 14:52:15,580 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 14:52:17,434 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 14:52:17,435 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 14:52:18,016 - CtcTrainer - INFO - Starting Epoch 21/100
2025-05-30 16:17:19,801 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 16:21:28,785 - CtcTrainer - INFO - Running end-of-epoch 21 validation...
2025-05-30 16:21:30,989 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 16:21:30,989 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 16:21:30,989 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già hư bác'
2025-05-30 16:21:30,990 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 16:21:30,990 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 16:21:30,990 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 16:21:30,990 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 16:21:30,990 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 16:21:30,990 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 16:21:30,990 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 16:21:30,990 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 16:21:30,990 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 16:21:30,990 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 16:21:30,990 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 16:21:30,991 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu hơn gần lại mới quan họ của họ'
2025-05-30 16:21:30,991 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 16:21:30,991 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 16:21:30,991 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 16:21:30,991 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 16:21:30,991 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 16:25:39,053 - training.ctc_validation - INFO - Validation Results: Loss=9.9796, CER=0.1161, WER=0.3103
2025-05-30 16:25:39,054 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 16:25:39,063 - CtcTrainer - INFO - --- Epoch 21/100 Summary ---
2025-05-30 16:25:39,063 - CtcTrainer - INFO - Avg Train Loss: 0.8039
2025-05-30 16:25:39,064 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 9.979600413250097, 'val_cer': 0.1161013899167672, 'val_wer': 0.31028256748217026}
2025-05-30 16:25:39,064 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1154
2025-05-30 16:25:39,064 - CtcTrainer - INFO - ---------------------
2025-05-30 16:25:39,067 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 16:25:42,456 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 16:25:42,456 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-05-30 16:25:43,051 - CtcTrainer - INFO - Starting Epoch 22/100
2025-05-30 16:57:39,384 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 17:54:17,654 - CtcTrainer - INFO - Running end-of-epoch 22 validation...
2025-05-30 17:54:20,316 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 17:54:20,317 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 17:54:20,317 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 17:54:20,317 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 17:54:20,317 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 17:54:20,317 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 17:54:20,317 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 17:54:20,317 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 17:54:20,318 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 17:54:20,318 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 17:54:20,318 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 thángg 12 năm 1947.'
2025-05-30 17:54:20,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 17:54:20,318 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 17:54:20,318 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 17:54:20,318 - training.ctc_validation - INFO -   Prediction  : 'Hai người hát đầu hạn gần lạmới quan họ của họ'
2025-05-30 17:54:20,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 17:54:20,318 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 17:54:20,318 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 17:54:20,319 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 17:54:20,319 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 17:58:26,669 - training.ctc_validation - INFO - Validation Results: Loss=9.2831, CER=0.1079, WER=0.2947
2025-05-30 17:58:26,670 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 17:58:26,678 - CtcTrainer - INFO - --- Epoch 22/100 Summary ---
2025-05-30 17:58:26,678 - CtcTrainer - INFO - Avg Train Loss: 0.7902
2025-05-30 17:58:26,679 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 9.283130431150264, 'val_cer': 0.107861748395665, 'val_wer': 0.2946646203845807}
2025-05-30 17:58:26,679 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1154
2025-05-30 17:58:26,679 - CtcTrainer - INFO - ---------------------
2025-05-30 17:58:26,682 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 17:58:29,779 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 17:58:29,780 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 17:58:33,004 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 17:58:33,005 - CtcTrainer - INFO - New best metric (val_cer) at epoch 22: 0.1079
2025-05-30 17:58:33,009 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 17:58:33,010 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 17:58:33,011 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 17:58:34,316 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 17:58:34,317 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 17:58:35,102 - CtcTrainer - INFO - Starting Epoch 23/100
2025-05-30 19:08:41,256 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 19:26:41,570 - CtcTrainer - INFO - Running end-of-epoch 23 validation...
2025-05-30 19:26:44,105 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 19:26:44,105 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 19:26:44,105 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 19:26:44,105 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 19:26:44,106 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 19:26:44,106 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 19:26:44,106 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 19:26:44,106 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 19:26:44,106 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 19:26:44,106 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 19:26:44,106 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 19:26:44,106 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 19:26:44,106 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 19:26:44,106 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 19:26:44,106 - training.ctc_validation - INFO -   Prediction  : 'Hai người hát đâu hạn gần lại mỗi quan họ của họ'
2025-05-30 19:26:44,107 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 19:26:44,107 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 19:26:44,107 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 19:26:44,107 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 19:26:44,107 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 19:30:52,663 - training.ctc_validation - INFO - Validation Results: Loss=8.8691, CER=0.1047, WER=0.2833
2025-05-30 19:30:52,664 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 19:30:52,670 - CtcTrainer - INFO - --- Epoch 23/100 Summary ---
2025-05-30 19:30:52,671 - CtcTrainer - INFO - Avg Train Loss: 0.7723
2025-05-30 19:30:52,671 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.869133242943244, 'val_cer': 0.10469996654467299, 'val_wer': 0.2833291956305859}
2025-05-30 19:30:52,671 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1079
2025-05-30 19:30:52,671 - CtcTrainer - INFO - ---------------------
2025-05-30 19:30:52,674 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 19:30:56,357 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 19:30:56,358 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 19:31:00,191 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 19:31:00,191 - CtcTrainer - INFO - New best metric (val_cer) at epoch 23: 0.1047
2025-05-30 19:31:00,196 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 19:31:00,197 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 19:31:00,198 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 19:31:01,707 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 19:31:01,707 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 19:31:02,277 - CtcTrainer - INFO - Starting Epoch 24/100
2025-05-30 19:45:28,512 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 20:58:55,680 - CtcTrainer - INFO - Running end-of-epoch 24 validation...
2025-05-30 20:58:58,271 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 20:58:58,272 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 20:58:58,272 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 20:58:58,272 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 20:58:58,272 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 20:58:58,273 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 20:58:58,273 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 20:58:58,273 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 20:58:58,273 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 20:58:58,274 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 20:58:58,274 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 20:58:58,274 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 20:58:58,274 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 20:58:58,275 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 20:58:58,275 - training.ctc_validation - INFO -   Prediction  : 'Hai người hất đầu hạn gầnn lại mối quan hệ của họ'
2025-05-30 20:58:58,275 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 20:58:58,275 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 20:58:58,276 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 20:58:58,276 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 20:58:58,276 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 21:03:10,361 - training.ctc_validation - INFO - Validation Results: Loss=8.5919, CER=0.1005, WER=0.2761
2025-05-30 21:03:10,361 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 21:03:10,364 - CtcTrainer - INFO - --- Epoch 24/100 Summary ---
2025-05-30 21:03:10,365 - CtcTrainer - INFO - Avg Train Loss: 0.7703
2025-05-30 21:03:10,365 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.591902514231712, 'val_cer': 0.1005155161751437, 'val_wer': 0.27607316963076645}
2025-05-30 21:03:10,365 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1047
2025-05-30 21:03:10,365 - CtcTrainer - INFO - ---------------------
2025-05-30 21:03:10,368 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 21:03:14,505 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 21:03:14,506 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-30 21:03:18,602 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-30 21:03:18,603 - CtcTrainer - INFO - New best metric (val_cer) at epoch 24: 0.1005
2025-05-30 21:03:18,608 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-30 21:03:18,609 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 21:03:18,611 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-30 21:03:20,018 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-30 21:03:20,018 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-30 21:03:20,524 - CtcTrainer - INFO - Starting Epoch 25/100
2025-05-30 21:24:10,110 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-30 22:31:14,113 - CtcTrainer - INFO - Running end-of-epoch 25 validation...
2025-05-30 22:31:16,593 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-30 22:31:16,594 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-30 22:31:16,594 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-30 22:31:16,594 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 22:31:16,594 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-30 22:31:16,594 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-30 22:31:16,594 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-30 22:31:16,594 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 22:31:16,594 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-30 22:31:16,595 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 22:31:16,595 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-30 22:31:16,595 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 22:31:16,595 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-30 22:31:16,595 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-30 22:31:16,595 - training.ctc_validation - INFO -   Prediction  : 'Hai người hắt đầu bạn gần lại mỗi quan hệ của họ'
2025-05-30 22:31:16,595 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 22:31:16,595 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-30 22:31:16,595 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-30 22:31:16,595 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-30 22:31:16,595 - training.ctc_validation - INFO - ---------------------------------
2025-05-30 22:35:25,267 - training.ctc_validation - INFO - Validation Results: Loss=8.6167, CER=0.1018, WER=0.2786
2025-05-30 22:35:25,268 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-30 22:35:25,277 - CtcTrainer - INFO - --- Epoch 25/100 Summary ---
2025-05-30 22:35:25,277 - CtcTrainer - INFO - Avg Train Loss: 0.7707
2025-05-30 22:35:25,278 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.616651744711586, 'val_cer': 0.1018410567828141, 'val_wer': 0.27860657217658213}
2025-05-30 22:35:25,278 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1005
2025-05-30 22:35:25,278 - CtcTrainer - INFO - ---------------------
2025-05-30 22:35:25,283 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-30 22:35:27,396 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-30 22:35:27,396 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-05-30 22:35:28,325 - CtcTrainer - INFO - Starting Epoch 26/100
2025-05-30 23:47:13,898 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 00:04:08,072 - CtcTrainer - INFO - Running end-of-epoch 26 validation...
2025-05-31 00:04:10,563 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 00:04:10,563 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 00:04:10,564 - training.ctc_validation - INFO -   Prediction  : 'Ngời vợ tuổi già như bác'
2025-05-31 00:04:10,564 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 00:04:10,564 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 00:04:10,564 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 00:04:10,564 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 00:04:10,564 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 00:04:10,564 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 00:04:10,564 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 00:04:10,564 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 00:04:10,564 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 00:04:10,564 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 00:04:10,565 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 00:04:10,565 - training.ctc_validation - INFO -   Prediction  : 'Hai người hát đầu hạn gần lại mối qun học của họ'
2025-05-31 00:04:10,565 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 00:04:10,565 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 00:04:10,565 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 00:04:10,565 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 00:04:10,565 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 00:08:23,234 - training.ctc_validation - INFO - Validation Results: Loss=8.9195, CER=0.1061, WER=0.2905
2025-05-31 00:08:23,234 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 00:08:23,237 - CtcTrainer - INFO - --- Epoch 26/100 Summary ---
2025-05-31 00:08:23,237 - CtcTrainer - INFO - Avg Train Loss: 0.7656
2025-05-31 00:08:23,238 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.919499934038672, 'val_cer': 0.10610787822260973, 'val_wer': 0.2904949444795522}
2025-05-31 00:08:23,238 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1005
2025-05-31 00:08:23,238 - CtcTrainer - INFO - ---------------------
2025-05-31 00:08:23,241 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 00:08:25,400 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 00:08:25,400 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-05-31 00:08:25,844 - CtcTrainer - INFO - Starting Epoch 27/100
2025-05-31 00:19:34,823 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 01:36:24,300 - CtcTrainer - INFO - Running end-of-epoch 27 validation...
2025-05-31 01:36:26,690 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 01:36:26,691 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 01:36:26,691 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 01:36:26,691 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 01:36:26,691 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 01:36:26,691 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 01:36:26,691 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 01:36:26,692 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 01:36:26,692 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 01:36:26,692 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 01:36:26,692 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 táng 12 năm 1947.'
2025-05-31 01:36:26,692 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 01:36:26,692 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 01:36:26,692 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 01:36:26,692 - training.ctc_validation - INFO -   Prediction  : 'Hai người hát đầu bàn gần lại mối quan hệ của họ'
2025-05-31 01:36:26,692 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 01:36:26,692 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 01:36:26,693 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 01:36:26,693 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 01:36:26,693 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 01:40:37,144 - training.ctc_validation - INFO - Validation Results: Loss=8.6965, CER=0.1016, WER=0.2769
2025-05-31 01:40:37,144 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 01:40:37,147 - CtcTrainer - INFO - --- Epoch 27/100 Summary ---
2025-05-31 01:40:37,147 - CtcTrainer - INFO - Avg Train Loss: 0.7655
2025-05-31 01:40:37,147 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.696528452231158, 'val_cer': 0.10161041778606839, 'val_wer': 0.27687437934458786}
2025-05-31 01:40:37,148 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1005
2025-05-31 01:40:37,148 - CtcTrainer - INFO - ---------------------
2025-05-31 01:40:37,151 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 01:40:39,267 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 01:40:39,267 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=7
2025-05-31 01:40:39,794 - CtcTrainer - INFO - Starting Epoch 28/100
2025-05-31 02:01:06,507 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 03:08:44,351 - CtcTrainer - INFO - Running end-of-epoch 28 validation...
2025-05-31 03:08:47,374 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 03:08:47,374 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 03:08:47,374 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 03:08:47,374 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 03:08:47,374 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 03:08:47,374 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 03:08:47,374 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 03:08:47,375 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 03:08:47,375 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 03:08:47,375 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 03:08:47,375 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 03:08:47,375 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 03:08:47,375 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 03:08:47,375 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 03:08:47,375 - training.ctc_validation - INFO -   Prediction  : 'Hai người hắt đau ban gần lại mới quan hệ của họ'
2025-05-31 03:08:47,375 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 03:08:47,375 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 03:08:47,375 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 03:08:47,375 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 03:08:47,376 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 03:12:56,679 - training.ctc_validation - INFO - Validation Results: Loss=8.6487, CER=0.1004, WER=0.2775
2025-05-31 03:12:56,680 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 03:12:56,683 - CtcTrainer - INFO - --- Epoch 28/100 Summary ---
2025-05-31 03:12:56,683 - CtcTrainer - INFO - Avg Train Loss: 0.7555
2025-05-31 03:12:56,684 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.648720595846072, 'val_cer': 0.10035964476525512, 'val_wer': 0.27751760404441633}
2025-05-31 03:12:56,684 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1005
2025-05-31 03:12:56,684 - CtcTrainer - INFO - ---------------------
2025-05-31 03:12:56,687 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 03:13:00,970 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 03:13:00,970 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 03:13:05,001 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 03:13:05,002 - CtcTrainer - INFO - New best metric (val_cer) at epoch 28: 0.1004
2025-05-31 03:13:05,006 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 03:13:05,007 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 03:13:05,011 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 03:13:06,792 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 03:13:06,793 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 03:13:07,253 - CtcTrainer - INFO - Starting Epoch 29/100
2025-05-31 04:19:49,433 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 04:41:11,661 - CtcTrainer - INFO - Running end-of-epoch 29 validation...
2025-05-31 04:41:14,362 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 04:41:14,362 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 04:41:14,363 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 04:41:14,363 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 04:41:14,363 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 04:41:14,363 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 04:41:14,363 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 04:41:14,364 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 04:41:14,364 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 04:41:14,364 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 04:41:14,365 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 04:41:14,365 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 04:41:14,365 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 04:41:14,365 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 04:41:14,366 - training.ctc_validation - INFO -   Prediction  : 'Hai người hát đầu hàn gần lại mối quan học của họ'
2025-05-31 04:41:14,366 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 04:41:14,366 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 04:41:14,366 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 04:41:14,367 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 04:41:14,367 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 04:45:25,269 - training.ctc_validation - INFO - Validation Results: Loss=8.3405, CER=0.0979, WER=0.2702
2025-05-31 04:45:25,270 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 04:45:25,278 - CtcTrainer - INFO - --- Epoch 29/100 Summary ---
2025-05-31 04:45:25,278 - CtcTrainer - INFO - Avg Train Loss: 0.7459
2025-05-31 04:45:25,279 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.34051335446774, 'val_cer': 0.09785176248745425, 'val_wer': 0.2702051548253137}
2025-05-31 04:45:25,279 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1004
2025-05-31 04:45:25,279 - CtcTrainer - INFO - ---------------------
2025-05-31 04:45:25,286 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 04:45:27,258 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 04:45:27,259 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 04:45:30,422 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 04:45:30,423 - CtcTrainer - INFO - New best metric (val_cer) at epoch 29: 0.0979
2025-05-31 04:45:30,430 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 04:45:30,430 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 04:45:30,432 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 04:45:31,594 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 04:45:31,595 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 04:45:32,519 - CtcTrainer - INFO - Starting Epoch 30/100
2025-05-31 05:15:58,203 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 06:13:25,548 - CtcTrainer - INFO - Running end-of-epoch 30 validation...
2025-05-31 06:13:28,185 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 06:13:28,185 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 06:13:28,186 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 06:13:28,186 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 06:13:28,186 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 06:13:28,186 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu hơn gần lại mới quan hệ của họ'
2025-05-31 06:13:28,187 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 06:13:28,187 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 06:13:28,187 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 06:13:28,187 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 06:13:28,187 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 06:17:36,661 - training.ctc_validation - INFO - Validation Results: Loss=8.4627, CER=0.0983, WER=0.2671
2025-05-31 06:17:36,662 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 06:17:36,666 - CtcTrainer - INFO - --- Epoch 30/100 Summary ---
2025-05-31 06:17:36,666 - CtcTrainer - INFO - Avg Train Loss: 0.7512
2025-05-31 06:17:36,667 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.462738584037822, 'val_cer': 0.09830163525583187, 'val_wer': 0.26710187776473776}
2025-05-31 06:17:36,667 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0979
2025-05-31 06:17:36,667 - CtcTrainer - INFO - ---------------------
2025-05-31 06:17:36,672 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 06:17:39,760 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 06:17:39,761 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-05-31 06:17:40,464 - CtcTrainer - INFO - Starting Epoch 31/100
2025-05-31 07:35:53,895 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 07:45:35,378 - CtcTrainer - INFO - Running end-of-epoch 31 validation...
2025-05-31 07:45:38,032 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 07:45:38,032 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 07:45:38,033 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 07:45:38,033 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 07:45:38,033 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 07:45:38,033 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 07:45:38,033 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 07:45:38,033 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 07:45:38,033 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 07:45:38,033 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 07:45:38,033 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 192 năm 147.'
2025-05-31 07:45:38,033 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 07:45:38,033 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 07:45:38,033 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 07:45:38,034 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mới quan hệ của họ'
2025-05-31 07:45:38,034 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 07:45:38,034 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 07:45:38,034 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 07:45:38,034 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 07:45:38,034 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 07:49:47,862 - training.ctc_validation - INFO - Validation Results: Loss=8.1870, CER=0.0963, WER=0.2658
2025-05-31 07:49:47,862 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 07:49:47,866 - CtcTrainer - INFO - --- Epoch 31/100 Summary ---
2025-05-31 07:49:47,867 - CtcTrainer - INFO - Avg Train Loss: 0.7369
2025-05-31 07:49:47,867 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.187008663384283, 'val_cer': 0.09628417765792435, 'val_wer': 0.2657872167554392}
2025-05-31 07:49:47,867 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0979
2025-05-31 07:49:47,867 - CtcTrainer - INFO - ---------------------
2025-05-31 07:49:47,873 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 07:49:50,829 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 07:49:50,830 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 07:49:53,709 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 07:49:53,709 - CtcTrainer - INFO - New best metric (val_cer) at epoch 31: 0.0963
2025-05-31 07:49:53,715 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 07:49:53,717 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 07:49:53,719 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 07:49:54,947 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 07:49:54,947 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 07:49:55,903 - CtcTrainer - INFO - Starting Epoch 32/100
2025-05-31 08:39:06,120 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 09:18:13,754 - CtcTrainer - INFO - Running end-of-epoch 32 validation...
2025-05-31 09:18:16,523 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 09:18:16,524 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 09:18:16,524 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 09:18:16,524 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 09:18:16,524 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 09:18:16,524 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 09:18:16,524 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 09:18:16,524 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 09:18:16,525 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 09:18:16,525 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 09:18:16,525 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 09:18:16,525 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 09:18:16,525 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 09:18:16,525 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 09:18:16,525 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu hạn gần lại mỗi quan hệ của họ'
2025-05-31 09:18:16,525 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 09:18:16,525 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 09:18:16,525 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 09:18:16,525 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 09:18:16,526 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 09:22:18,885 - training.ctc_validation - INFO - Validation Results: Loss=8.0084, CER=0.0939, WER=0.2616
2025-05-31 09:22:18,886 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 09:22:18,890 - CtcTrainer - INFO - --- Epoch 32/100 Summary ---
2025-05-31 09:22:18,890 - CtcTrainer - INFO - Avg Train Loss: 0.7367
2025-05-31 09:22:18,890 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.008391716042201, 'val_cer': 0.0939118908342542, 'val_wer': 0.2616344678161957}
2025-05-31 09:22:18,891 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0963
2025-05-31 09:22:18,891 - CtcTrainer - INFO - ---------------------
2025-05-31 09:22:18,897 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 09:22:22,105 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 09:22:22,106 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 09:22:25,224 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 09:22:25,225 - CtcTrainer - INFO - New best metric (val_cer) at epoch 32: 0.0939
2025-05-31 09:22:25,229 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 09:22:25,230 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 09:22:25,231 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 09:22:26,581 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 09:22:26,582 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 09:22:27,675 - CtcTrainer - INFO - Starting Epoch 33/100
2025-05-31 10:13:13,885 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 10:50:32,603 - CtcTrainer - INFO - Running end-of-epoch 33 validation...
2025-05-31 10:50:34,978 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 10:50:34,979 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 10:50:34,980 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 10:50:34,980 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 10:50:34,980 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 10:50:34,980 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 10:50:34,981 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 10:50:34,981 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 10:50:34,981 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 10:50:34,981 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 10:50:34,981 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 10:50:34,981 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 10:50:34,981 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 10:50:34,981 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 10:50:34,981 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mỗi quan hệ của họ'
2025-05-31 10:50:34,981 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 10:50:34,982 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 10:50:34,982 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 10:50:34,982 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 10:50:34,982 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 10:54:48,376 - training.ctc_validation - INFO - Validation Results: Loss=7.9470, CER=0.0925, WER=0.2567
2025-05-31 10:54:48,376 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 10:54:48,380 - CtcTrainer - INFO - --- Epoch 33/100 Summary ---
2025-05-31 10:54:48,380 - CtcTrainer - INFO - Avg Train Loss: 0.7311
2025-05-31 10:54:48,381 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.947031859293743, 'val_cer': 0.09245075477245308, 'val_wer': 0.25674821702627065}
2025-05-31 10:54:48,381 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0939
2025-05-31 10:54:48,381 - CtcTrainer - INFO - ---------------------
2025-05-31 10:54:48,386 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 10:54:51,499 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 10:54:51,500 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 10:54:54,854 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 10:54:54,855 - CtcTrainer - INFO - New best metric (val_cer) at epoch 33: 0.0925
2025-05-31 10:54:54,861 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 10:54:54,863 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 10:54:54,865 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 10:54:56,213 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 10:54:56,214 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 10:54:57,153 - CtcTrainer - INFO - Starting Epoch 34/100
2025-05-31 11:06:32,576 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 12:22:57,287 - CtcTrainer - INFO - Running end-of-epoch 34 validation...
2025-05-31 12:22:59,749 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 12:22:59,749 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 12:22:59,750 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 12:22:59,750 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 12:22:59,750 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 12:22:59,750 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 12:22:59,750 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 12:22:59,750 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 12:22:59,751 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 12:22:59,751 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 12:22:59,751 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 194.'
2025-05-31 12:22:59,751 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 12:22:59,752 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 12:22:59,752 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 12:22:59,752 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-05-31 12:22:59,752 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 12:22:59,752 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 12:22:59,753 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 12:22:59,753 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 12:22:59,753 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 12:27:08,303 - training.ctc_validation - INFO - Validation Results: Loss=7.7562, CER=0.0911, WER=0.2515
2025-05-31 12:27:08,304 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 12:27:08,308 - CtcTrainer - INFO - --- Epoch 34/100 Summary ---
2025-05-31 12:27:08,308 - CtcTrainer - INFO - Avg Train Loss: 0.7301
2025-05-31 12:27:08,309 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.756212377828416, 'val_cer': 0.09109733472561563, 'val_wer': 0.2514670037013632}
2025-05-31 12:27:08,309 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0925
2025-05-31 12:27:08,309 - CtcTrainer - INFO - ---------------------
2025-05-31 12:27:08,314 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 12:27:10,606 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 12:27:10,606 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 12:27:13,585 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 12:27:13,586 - CtcTrainer - INFO - New best metric (val_cer) at epoch 34: 0.0911
2025-05-31 12:27:13,590 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 12:27:13,590 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 12:27:13,591 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 12:27:14,963 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 12:27:14,963 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 12:27:15,565 - CtcTrainer - INFO - Starting Epoch 35/100
2025-05-31 13:51:15,931 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 13:55:04,644 - CtcTrainer - INFO - Running end-of-epoch 35 validation...
2025-05-31 13:55:07,105 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 13:55:07,106 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 13:55:07,106 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 13:55:07,106 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 13:55:07,106 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 13:55:07,106 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 13:55:07,107 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 13:55:07,107 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 13:55:07,107 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 13:55:07,107 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 13:55:07,107 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 13:55:07,107 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 13:55:07,107 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 13:55:07,107 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 13:55:07,107 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu hạn gần lại mối quan hệ của họ'
2025-05-31 13:55:07,107 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 13:55:07,108 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 13:55:07,108 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 13:55:07,108 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 13:55:07,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 13:59:17,893 - training.ctc_validation - INFO - Validation Results: Loss=7.6798, CER=0.0893, WER=0.2505
2025-05-31 13:59:17,894 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 13:59:17,897 - CtcTrainer - INFO - --- Epoch 35/100 Summary ---
2025-05-31 13:59:17,897 - CtcTrainer - INFO - Avg Train Loss: 0.7145
2025-05-31 13:59:17,897 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.679825607069098, 'val_cer': 0.08931305061892356, 'val_wer': 0.25050216665162045}
2025-05-31 13:59:17,897 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0911
2025-05-31 13:59:17,897 - CtcTrainer - INFO - ---------------------
2025-05-31 13:59:17,901 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 13:59:21,188 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 13:59:21,189 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 13:59:24,807 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 13:59:24,807 - CtcTrainer - INFO - New best metric (val_cer) at epoch 35: 0.0893
2025-05-31 13:59:24,810 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 13:59:24,811 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 13:59:24,812 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 13:59:26,056 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 13:59:26,057 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 13:59:26,536 - CtcTrainer - INFO - Starting Epoch 36/100
2025-05-31 14:08:29,587 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 15:27:33,794 - CtcTrainer - INFO - Running end-of-epoch 36 validation...
2025-05-31 15:27:36,097 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 15:27:36,098 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 15:27:36,098 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 15:27:36,098 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 15:27:36,098 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 15:27:36,098 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 15:27:36,099 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 15:27:36,099 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 15:27:36,099 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 15:27:36,099 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 15:27:36,099 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 15:27:36,099 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 15:27:36,099 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 15:27:36,099 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 15:27:36,099 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-05-31 15:27:36,099 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 15:27:36,099 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 15:27:36,100 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 15:27:36,100 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 15:27:36,100 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 15:31:44,893 - training.ctc_validation - INFO - Validation Results: Loss=7.5050, CER=0.0887, WER=0.2469
2025-05-31 15:31:44,893 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 15:31:44,901 - CtcTrainer - INFO - --- Epoch 36/100 Summary ---
2025-05-31 15:31:44,901 - CtcTrainer - INFO - Avg Train Loss: 0.7136
2025-05-31 15:31:44,902 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.505022944406989, 'val_cer': 0.08866295278743702, 'val_wer': 0.24687415365171075}
2025-05-31 15:31:44,902 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0893
2025-05-31 15:31:44,902 - CtcTrainer - INFO - ---------------------
2025-05-31 15:31:44,906 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 15:31:47,063 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 15:31:47,063 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 15:31:50,375 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 15:31:50,377 - CtcTrainer - INFO - New best metric (val_cer) at epoch 36: 0.0887
2025-05-31 15:31:50,383 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 15:31:50,384 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 15:31:50,386 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 15:31:51,899 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 15:31:51,900 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 15:31:52,543 - CtcTrainer - INFO - Starting Epoch 37/100
2025-05-31 15:32:06,152 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 17:00:07,678 - CtcTrainer - INFO - Running end-of-epoch 37 validation...
2025-05-31 17:00:10,107 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 17:00:10,107 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 17:00:10,107 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 17:00:10,107 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 17:00:10,108 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 17:00:10,108 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 17:00:10,108 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 17:00:10,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 17:00:10,108 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 17:00:10,108 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 17:00:10,108 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 17:00:10,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 17:00:10,108 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 17:00:10,108 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 17:00:10,108 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mỗi quan hệ của họ'
2025-05-31 17:00:10,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 17:00:10,109 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 17:00:10,109 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 17:00:10,109 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 17:00:10,109 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 17:04:21,294 - training.ctc_validation - INFO - Validation Results: Loss=7.3948, CER=0.0870, WER=0.2435
2025-05-31 17:04:21,294 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 17:04:21,301 - CtcTrainer - INFO - --- Epoch 37/100 Summary ---
2025-05-31 17:04:21,302 - CtcTrainer - INFO - Avg Train Loss: 0.7071
2025-05-31 17:04:21,302 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.3948071670512805, 'val_cer': 0.08697751396506453, 'val_wer': 0.24351132978243206}
2025-05-31 17:04:21,302 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0887
2025-05-31 17:04:21,302 - CtcTrainer - INFO - ---------------------
2025-05-31 17:04:21,305 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 17:04:23,397 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 17:04:23,398 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 17:04:27,251 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 17:04:27,252 - CtcTrainer - INFO - New best metric (val_cer) at epoch 37: 0.0870
2025-05-31 17:04:27,256 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 17:04:27,256 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 17:04:27,258 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 17:04:28,524 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 17:04:28,525 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 17:04:29,021 - CtcTrainer - INFO - Starting Epoch 38/100
2025-05-31 17:57:23,734 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 18:32:34,101 - CtcTrainer - INFO - Running end-of-epoch 38 validation...
2025-05-31 18:32:36,389 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 18:32:36,389 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 18:32:36,390 - training.ctc_validation - INFO -   Prediction  : 'Ngời vợ tuổi già như bác'
2025-05-31 18:32:36,390 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 18:32:36,390 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 18:32:36,390 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 18:32:36,391 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 18:32:36,391 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 18:32:36,391 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 18:32:36,391 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 18:32:36,391 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31tháng 12 năm 1947.'
2025-05-31 18:32:36,391 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 18:32:36,391 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 18:32:36,392 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 18:32:36,392 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-05-31 18:32:36,393 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 18:32:36,393 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 18:32:36,394 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 18:32:36,394 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 18:32:36,394 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 18:36:42,239 - training.ctc_validation - INFO - Validation Results: Loss=7.6783, CER=0.0891, WER=0.2483
2025-05-31 18:36:42,239 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 18:36:42,248 - CtcTrainer - INFO - --- Epoch 38/100 Summary ---
2025-05-31 18:36:42,248 - CtcTrainer - INFO - Avg Train Loss: 0.7055
2025-05-31 18:36:42,249 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.678251228344033, 'val_cer': 0.08912042903922383, 'val_wer': 0.24832423038728899}
2025-05-31 18:36:42,249 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0870
2025-05-31 18:36:42,249 - CtcTrainer - INFO - ---------------------
2025-05-31 18:36:42,252 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 18:36:44,446 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 18:36:44,446 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-05-31 18:36:44,921 - CtcTrainer - INFO - Starting Epoch 39/100
2025-05-31 19:06:52,574 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 20:04:47,956 - CtcTrainer - INFO - Running end-of-epoch 39 validation...
2025-05-31 20:04:50,481 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 20:04:50,482 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 20:04:50,482 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 20:04:50,482 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 20:04:50,482 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 20:04:50,482 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 20:04:50,483 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 20:04:50,484 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 20:04:50,484 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 20:04:50,484 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 20:04:50,484 - training.ctc_validation - INFO -   Prediction  : 'vào này 31 tháng 12 năm 1947.'
2025-05-31 20:04:50,485 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 20:04:50,485 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 20:04:50,485 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 20:04:50,485 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bàn gần lại mối quan hệ của họ'
2025-05-31 20:04:50,486 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 20:04:50,486 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 20:04:50,486 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 20:04:50,486 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 20:04:50,487 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 20:08:58,858 - training.ctc_validation - INFO - Validation Results: Loss=7.3217, CER=0.0865, WER=0.2409
2025-05-31 20:08:58,859 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 20:08:58,867 - CtcTrainer - INFO - --- Epoch 39/100 Summary ---
2025-05-31 20:08:58,867 - CtcTrainer - INFO - Avg Train Loss: 0.7045
2025-05-31 20:08:58,867 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.321650935365123, 'val_cer': 0.08650609799369417, 'val_wer': 0.24093278866118986}
2025-05-31 20:08:58,867 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0870
2025-05-31 20:08:58,868 - CtcTrainer - INFO - ---------------------
2025-05-31 20:08:58,871 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 20:09:02,020 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 20:09:02,021 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 20:09:05,228 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 20:09:05,229 - CtcTrainer - INFO - New best metric (val_cer) at epoch 39: 0.0865
2025-05-31 20:09:05,234 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 20:09:05,235 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 20:09:05,236 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 20:09:06,679 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 20:09:06,679 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 20:09:07,462 - CtcTrainer - INFO - Starting Epoch 40/100
2025-05-31 20:48:56,423 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 21:37:16,099 - CtcTrainer - INFO - Running end-of-epoch 40 validation...
2025-05-31 21:37:18,593 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 21:37:18,593 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 21:37:18,593 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tổi già như bác'
2025-05-31 21:37:18,594 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 21:37:18,594 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 21:37:18,594 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 21:37:18,594 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 21:37:18,595 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 21:37:18,595 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 21:37:18,595 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 21:37:18,595 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 197.'
2025-05-31 21:37:18,595 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 21:37:18,595 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 21:37:18,596 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 21:37:18,596 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-05-31 21:37:18,596 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 21:37:18,596 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 21:37:18,596 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 21:37:18,597 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 21:37:18,597 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 21:41:26,967 - training.ctc_validation - INFO - Validation Results: Loss=7.4147, CER=0.0870, WER=0.2431
2025-05-31 21:41:26,968 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 21:41:26,971 - CtcTrainer - INFO - --- Epoch 40/100 Summary ---
2025-05-31 21:41:26,971 - CtcTrainer - INFO - Avg Train Loss: 0.6960
2025-05-31 21:41:26,971 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.414686192942825, 'val_cer': 0.08701426413487566, 'val_wer': 0.2430937979597364}
2025-05-31 21:41:26,971 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0865
2025-05-31 21:41:26,971 - CtcTrainer - INFO - ---------------------
2025-05-31 21:41:26,975 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 21:41:30,145 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 21:41:30,147 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-05-31 21:41:30,651 - CtcTrainer - INFO - Starting Epoch 41/100
2025-05-31 22:48:48,285 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-05-31 23:09:40,723 - CtcTrainer - INFO - Running end-of-epoch 41 validation...
2025-05-31 23:09:43,124 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-31 23:09:43,124 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-05-31 23:09:43,125 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-05-31 23:09:43,125 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 23:09:43,125 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-31 23:09:43,125 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-05-31 23:09:43,126 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-05-31 23:09:43,126 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 23:09:43,127 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-31 23:09:43,127 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 23:09:43,127 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-05-31 23:09:43,127 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 23:09:43,128 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-31 23:09:43,128 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-05-31 23:09:43,128 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mới quan hệ của họ'
2025-05-31 23:09:43,128 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 23:09:43,128 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-31 23:09:43,128 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-05-31 23:09:43,128 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-05-31 23:09:43,128 - training.ctc_validation - INFO - ---------------------------------
2025-05-31 23:13:47,753 - training.ctc_validation - INFO - Validation Results: Loss=6.9719, CER=0.0814, WER=0.2277
2025-05-31 23:13:47,753 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-05-31 23:13:47,761 - CtcTrainer - INFO - --- Epoch 41/100 Summary ---
2025-05-31 23:13:47,761 - CtcTrainer - INFO - Avg Train Loss: 0.6889
2025-05-31 23:13:47,762 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.9719389485139365, 'val_cer': 0.08135980697290118, 'val_wer': 0.22772411302699286}
2025-05-31 23:13:47,762 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0865
2025-05-31 23:13:47,762 - CtcTrainer - INFO - ---------------------
2025-05-31 23:13:47,765 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-05-31 23:13:51,186 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-31 23:13:51,186 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-05-31 23:13:54,269 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-31 23:13:54,270 - CtcTrainer - INFO - New best metric (val_cer) at epoch 41: 0.0814
2025-05-31 23:13:54,273 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-05-31 23:13:54,273 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 23:13:54,276 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-31 23:13:55,679 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-05-31 23:13:55,679 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-05-31 23:13:56,132 - CtcTrainer - INFO - Starting Epoch 42/100
2025-05-31 23:35:38,768 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 00:42:14,089 - CtcTrainer - INFO - Running end-of-epoch 42 validation...
2025-06-01 00:42:16,516 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 00:42:16,516 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 00:42:16,517 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 00:42:16,517 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 00:42:16,517 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 00:42:16,517 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 00:42:16,517 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 00:42:16,517 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 00:42:16,517 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 00:42:16,517 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 00:42:16,517 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 00:42:16,518 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 00:42:16,518 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 00:42:16,518 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 00:42:16,518 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mới quan hệ của họ'
2025-06-01 00:42:16,518 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 00:42:16,518 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 00:42:16,518 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 00:42:16,518 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 00:42:16,518 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 00:46:25,159 - training.ctc_validation - INFO - Validation Results: Loss=7.2764, CER=0.0857, WER=0.2407
2025-06-01 00:46:25,160 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 00:46:25,164 - CtcTrainer - INFO - --- Epoch 42/100 Summary ---
2025-06-01 00:46:25,165 - CtcTrainer - INFO - Avg Train Loss: 0.6972
2025-06-01 00:46:25,165 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.2763503204674835, 'val_cer': 0.08567858554932634, 'val_wer': 0.24065631488670217}
2025-06-01 00:46:25,165 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0814
2025-06-01 00:46:25,165 - CtcTrainer - INFO - ---------------------
2025-06-01 00:46:25,168 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 00:46:29,069 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 00:46:29,072 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-01 00:46:29,720 - CtcTrainer - INFO - Starting Epoch 43/100
2025-06-01 01:27:45,176 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 02:14:52,528 - CtcTrainer - INFO - Running end-of-epoch 43 validation...
2025-06-01 02:14:54,908 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 02:14:54,908 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 02:14:54,908 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 02:14:54,908 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 02:14:54,909 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 02:14:54,909 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 02:14:54,909 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 02:14:54,909 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 02:14:54,909 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 02:14:54,909 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 02:14:54,909 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 02:14:54,909 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 02:14:54,909 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 02:14:54,909 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 02:14:54,909 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mới quan hệ của họ'
2025-06-01 02:14:54,910 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 02:14:54,910 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 02:14:54,910 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 02:14:54,910 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 02:14:54,910 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 02:19:04,898 - training.ctc_validation - INFO - Validation Results: Loss=7.0008, CER=0.0818, WER=0.2295
2025-06-01 02:19:04,899 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 02:19:04,904 - CtcTrainer - INFO - --- Epoch 43/100 Summary ---
2025-06-01 02:19:04,904 - CtcTrainer - INFO - Avg Train Loss: 0.6943
2025-06-01 02:19:04,904 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.000787637581625, 'val_cer': 0.08178813653828608, 'val_wer': 0.22950144443441364}
2025-06-01 02:19:04,905 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0814
2025-06-01 02:19:04,905 - CtcTrainer - INFO - ---------------------
2025-06-01 02:19:04,910 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 02:19:08,168 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 02:19:08,169 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-01 02:19:09,033 - CtcTrainer - INFO - Starting Epoch 44/100
2025-06-01 03:39:07,785 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 03:47:38,541 - CtcTrainer - INFO - Running end-of-epoch 44 validation...
2025-06-01 03:47:41,063 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 03:47:41,064 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 03:47:41,064 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 03:47:41,064 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 03:47:41,064 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 03:47:41,064 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 03:47:41,064 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 03:47:41,064 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 03:47:41,065 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mới quan hệ của họ'
2025-06-01 03:47:41,065 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 03:47:41,065 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 03:47:41,065 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 03:47:41,065 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 03:47:41,065 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 03:51:48,039 - training.ctc_validation - INFO - Validation Results: Loss=7.1034, CER=0.0833, WER=0.2309
2025-06-01 03:51:48,040 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 03:51:48,045 - CtcTrainer - INFO - --- Epoch 44/100 Summary ---
2025-06-01 03:51:48,045 - CtcTrainer - INFO - Avg Train Loss: 0.6826
2025-06-01 03:51:48,045 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.103445738325125, 'val_cer': 0.08328095378095884, 'val_wer': 0.23091202491649362}
2025-06-01 03:51:48,045 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0814
2025-06-01 03:51:48,045 - CtcTrainer - INFO - ---------------------
2025-06-01 03:51:48,049 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 03:51:50,293 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 03:51:50,293 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=7
2025-06-01 03:51:50,787 - CtcTrainer - INFO - Starting Epoch 45/100
2025-06-01 04:04:54,897 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 05:19:54,856 - CtcTrainer - INFO - Running end-of-epoch 45 validation...
2025-06-01 05:19:57,459 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 05:19:57,459 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 05:19:57,460 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 05:19:57,460 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 05:19:57,460 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 05:19:57,460 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 05:19:57,460 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 05:19:57,460 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 05:19:57,460 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 05:19:57,460 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 05:19:57,460 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 05:19:57,460 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 05:19:57,461 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 05:19:57,461 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 05:19:57,461 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bản gần lại mới quan hệ của họ'
2025-06-01 05:19:57,461 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 05:19:57,461 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 05:19:57,461 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 05:19:57,461 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 05:19:57,461 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 05:24:03,494 - training.ctc_validation - INFO - Validation Results: Loss=6.8464, CER=0.0801, WER=0.2250
2025-06-01 05:24:03,495 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 05:24:03,498 - CtcTrainer - INFO - --- Epoch 45/100 Summary ---
2025-06-01 05:24:03,499 - CtcTrainer - INFO - Avg Train Loss: 0.6803
2025-06-01 05:24:03,499 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.8464263807501045, 'val_cer': 0.08012424091890631, 'val_wer': 0.22499887153561435}
2025-06-01 05:24:03,499 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0814
2025-06-01 05:24:03,499 - CtcTrainer - INFO - ---------------------
2025-06-01 05:24:03,503 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 05:24:05,618 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 05:24:05,619 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-01 05:24:08,749 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-01 05:24:08,750 - CtcTrainer - INFO - New best metric (val_cer) at epoch 45: 0.0801
2025-06-01 05:24:08,755 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-01 05:24:08,756 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 05:24:08,758 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 05:24:10,104 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-01 05:24:10,104 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-01 05:24:10,865 - CtcTrainer - INFO - Starting Epoch 46/100
2025-06-01 06:33:20,493 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 06:52:09,388 - CtcTrainer - INFO - Running end-of-epoch 46 validation...
2025-06-01 06:52:11,911 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 06:52:11,912 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 06:52:11,913 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 06:52:11,914 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 06:52:11,914 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 06:52:11,915 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 06:52:11,915 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 06:52:11,915 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 06:52:11,915 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 06:52:11,915 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 06:52:11,915 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 19477.'
2025-06-01 06:52:11,915 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 06:52:11,915 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 06:52:11,915 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 06:52:11,916 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-01 06:52:11,916 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 06:52:11,916 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 06:52:11,916 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 06:52:11,916 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 06:52:11,916 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 06:56:21,261 - training.ctc_validation - INFO - Validation Results: Loss=7.0894, CER=0.0829, WER=0.2323
2025-06-01 06:56:21,261 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 06:56:21,266 - CtcTrainer - INFO - --- Epoch 46/100 Summary ---
2025-06-01 06:56:21,266 - CtcTrainer - INFO - Avg Train Loss: 0.6785
2025-06-01 06:56:21,267 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.089446368035339, 'val_cer': 0.08286783118239235, 'val_wer': 0.23229439378893202}
2025-06-01 06:56:21,267 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0801
2025-06-01 06:56:21,267 - CtcTrainer - INFO - ---------------------
2025-06-01 06:56:21,270 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 06:56:25,296 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 06:56:25,297 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-01 06:56:25,814 - CtcTrainer - INFO - Starting Epoch 47/100
2025-06-01 07:24:12,216 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 08:24:21,659 - CtcTrainer - INFO - Running end-of-epoch 47 validation...
2025-06-01 08:24:24,170 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 08:24:24,171 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 08:24:24,173 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 08:24:24,173 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 08:24:24,174 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 08:24:24,174 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 08:24:24,175 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 08:24:24,175 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 08:24:24,176 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 08:24:24,176 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 08:24:24,177 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 08:24:24,177 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 08:24:24,177 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 08:24:24,177 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 08:24:24,177 - training.ctc_validation - INFO -   Prediction  : 'Hai nười bắt đầu ban gần lại mối quan hệ của họ'
2025-06-01 08:24:24,177 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 08:24:24,177 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 08:24:24,178 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 08:24:24,178 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 08:24:24,178 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 08:28:28,582 - training.ctc_validation - INFO - Validation Results: Loss=6.7048, CER=0.0786, WER=0.2207
2025-06-01 08:28:28,583 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 08:28:28,591 - CtcTrainer - INFO - --- Epoch 47/100 Summary ---
2025-06-01 08:28:28,592 - CtcTrainer - INFO - Avg Train Loss: 0.6731
2025-06-01 08:28:28,592 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.704837239944077, 'val_cer': 0.0785680613144902, 'val_wer': 0.2207389184797328}
2025-06-01 08:28:28,592 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0801
2025-06-01 08:28:28,592 - CtcTrainer - INFO - ---------------------
2025-06-01 08:28:28,598 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 08:28:33,267 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 08:28:33,268 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-01 08:28:37,588 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-01 08:28:37,589 - CtcTrainer - INFO - New best metric (val_cer) at epoch 47: 0.0786
2025-06-01 08:28:37,594 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-01 08:28:37,595 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 08:28:37,596 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 08:28:38,902 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-01 08:28:38,902 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-01 08:28:39,590 - CtcTrainer - INFO - Starting Epoch 48/100
2025-06-01 08:40:22,072 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 09:56:44,049 - CtcTrainer - INFO - Running end-of-epoch 48 validation...
2025-06-01 09:56:46,479 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 09:56:46,480 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 09:56:46,481 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 09:56:46,481 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 09:56:46,481 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 09:56:46,481 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 09:56:46,481 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 09:56:46,481 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 09:56:46,481 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 09:56:46,482 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 09:56:46,482 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 thángg 12 năm 197.'
2025-06-01 09:56:46,482 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 09:56:46,482 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 09:56:46,482 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 09:56:46,482 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đu ban gần lại mối quan hệ của họ'
2025-06-01 09:56:46,483 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 09:56:46,483 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 09:56:46,483 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 09:56:46,483 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 09:56:46,483 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 10:00:51,159 - training.ctc_validation - INFO - Validation Results: Loss=6.4640, CER=0.0773, WER=0.2202
2025-06-01 10:00:51,159 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 10:00:51,170 - CtcTrainer - INFO - --- Epoch 48/100 Summary ---
2025-06-01 10:00:51,170 - CtcTrainer - INFO - Avg Train Loss: 0.6678
2025-06-01 10:00:51,171 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.464032859047097, 'val_cer': 0.07733629700219995, 'val_wer': 0.22016340164304415}
2025-06-01 10:00:51,171 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0786
2025-06-01 10:00:51,171 - CtcTrainer - INFO - ---------------------
2025-06-01 10:00:51,174 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 10:00:53,451 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 10:00:53,452 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-01 10:00:56,458 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-01 10:00:56,459 - CtcTrainer - INFO - New best metric (val_cer) at epoch 48: 0.0773
2025-06-01 10:00:56,462 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-01 10:00:56,463 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 10:00:56,464 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 10:00:58,341 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-01 10:00:58,341 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-01 10:00:58,838 - CtcTrainer - INFO - Starting Epoch 49/100
2025-06-01 10:25:31,442 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 11:30:05,415 - CtcTrainer - INFO - Running end-of-epoch 49 validation...
2025-06-01 11:30:07,895 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 11:30:07,896 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 11:30:07,896 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 11:30:07,897 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 11:30:07,897 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 11:30:07,897 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 11:30:07,897 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 11:30:07,897 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 11:30:07,897 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 11:30:07,897 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 11:30:07,897 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 11:30:07,897 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 11:30:07,897 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 11:30:07,897 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 11:30:07,898 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu ban gần lại mới quan hệ của họ'
2025-06-01 11:30:07,898 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 11:30:07,898 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 11:30:07,898 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 11:30:07,898 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 11:30:07,898 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 11:34:13,067 - training.ctc_validation - INFO - Validation Results: Loss=7.0424, CER=0.0821, WER=0.2319
2025-06-01 11:34:13,067 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 11:34:13,071 - CtcTrainer - INFO - --- Epoch 49/100 Summary ---
2025-06-01 11:34:13,071 - CtcTrainer - INFO - Avg Train Loss: 0.6674
2025-06-01 11:34:13,071 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.0424233000514835, 'val_cer': 0.08208593963847971, 'val_wer': 0.23193892750744788}
2025-06-01 11:34:13,071 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0773
2025-06-01 11:34:13,071 - CtcTrainer - INFO - ---------------------
2025-06-01 11:34:13,075 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 11:34:16,535 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 11:34:16,536 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-01 11:34:17,151 - CtcTrainer - INFO - Starting Epoch 50/100
2025-06-01 12:08:04,372 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 13:02:32,935 - CtcTrainer - INFO - Running end-of-epoch 50 validation...
2025-06-01 13:02:35,182 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 13:02:35,183 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 13:02:35,183 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 13:02:35,183 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 13:02:35,183 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 13:02:35,183 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 13:02:35,184 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 13:02:35,184 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 13:02:35,184 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 13:02:35,184 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 13:02:35,185 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 13:02:35,185 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 13:02:35,185 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 13:02:35,185 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 13:02:35,185 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu hạn gần lại mới quan hệ của họ'
2025-06-01 13:02:35,186 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 13:02:35,186 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 13:02:35,186 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 13:02:35,186 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 13:02:35,186 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 13:06:34,408 - training.ctc_validation - INFO - Validation Results: Loss=6.6718, CER=0.0778, WER=0.2193
2025-06-01 13:06:34,409 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 13:06:34,414 - CtcTrainer - INFO - --- Epoch 50/100 Summary ---
2025-06-01 13:06:34,414 - CtcTrainer - INFO - Avg Train Loss: 0.6550
2025-06-01 13:06:34,414 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.671809319669434, 'val_cer': 0.07775195409523616, 'val_wer': 0.21926627245644129}
2025-06-01 13:06:34,414 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0773
2025-06-01 13:06:34,414 - CtcTrainer - INFO - ---------------------
2025-06-01 13:06:34,418 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 13:06:37,783 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 13:06:37,784 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-01 13:06:38,359 - CtcTrainer - INFO - Starting Epoch 51/100
2025-06-01 13:25:45,983 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 14:34:42,162 - CtcTrainer - INFO - Running end-of-epoch 51 validation...
2025-06-01 14:34:44,733 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 14:34:44,734 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 14:34:44,734 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 14:34:44,734 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 14:34:44,734 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 14:34:44,734 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 14:34:44,734 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 14:34:44,735 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 14:34:44,735 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 14:34:44,735 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 14:34:44,735 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 14:34:44,735 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 14:34:44,735 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 14:34:44,735 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 14:34:44,735 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu ban gần lại mối quan hệ của họ'
2025-06-01 14:34:44,735 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 14:34:44,736 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 14:34:44,736 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 14:34:44,736 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 14:34:44,736 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 14:38:42,657 - training.ctc_validation - INFO - Validation Results: Loss=6.3071, CER=0.0742, WER=0.2107
2025-06-01 14:38:42,658 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 14:38:42,661 - CtcTrainer - INFO - --- Epoch 51/100 Summary ---
2025-06-01 14:38:42,661 - CtcTrainer - INFO - Avg Train Loss: 0.6549
2025-06-01 14:38:42,662 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.30707433912708, 'val_cer': 0.07421253256825394, 'val_wer': 0.21074636634467817}
2025-06-01 14:38:42,662 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0773
2025-06-01 14:38:42,662 - CtcTrainer - INFO - ---------------------
2025-06-01 14:38:42,666 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 14:38:45,825 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 14:38:45,825 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-01 14:38:49,913 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-01 14:38:49,914 - CtcTrainer - INFO - New best metric (val_cer) at epoch 51: 0.0742
2025-06-01 14:38:49,919 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-01 14:38:49,920 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 14:38:49,925 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 14:38:51,143 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-01 14:38:51,144 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-01 14:38:51,718 - CtcTrainer - INFO - Starting Epoch 52/100
2025-06-01 15:06:11,542 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 16:07:17,477 - CtcTrainer - INFO - Running end-of-epoch 52 validation...
2025-06-01 16:07:20,095 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 16:07:20,096 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 16:07:20,096 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 16:07:20,096 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 16:07:20,096 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 16:07:20,097 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 16:07:20,097 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 16:07:20,097 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 16:07:20,097 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 16:07:20,097 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 16:07:20,097 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 16:07:20,097 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 16:07:20,097 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 16:07:20,097 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 16:07:20,097 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gắn lại mới quan hệ của họ'
2025-06-01 16:07:20,098 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 16:07:20,098 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 16:07:20,098 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 16:07:20,099 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 16:07:20,099 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 16:11:15,886 - training.ctc_validation - INFO - Validation Results: Loss=6.4009, CER=0.0750, WER=0.2127
2025-06-01 16:11:15,887 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 16:11:15,894 - CtcTrainer - INFO - --- Epoch 52/100 Summary ---
2025-06-01 16:11:15,894 - CtcTrainer - INFO - Avg Train Loss: 0.6473
2025-06-01 16:11:15,894 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.400899724462212, 'val_cer': 0.07501089832621985, 'val_wer': 0.21265911347837863}
2025-06-01 16:11:15,894 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0742
2025-06-01 16:11:15,895 - CtcTrainer - INFO - ---------------------
2025-06-01 16:11:15,899 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 16:11:18,218 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 16:11:18,219 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-01 16:11:18,885 - CtcTrainer - INFO - Starting Epoch 53/100
2025-06-01 17:28:50,736 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 17:39:41,882 - CtcTrainer - INFO - Running end-of-epoch 53 validation...
2025-06-01 17:39:44,494 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 17:39:44,494 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 17:39:44,495 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 17:39:44,495 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 17:39:44,495 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 17:39:44,495 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 17:39:44,495 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 17:39:44,495 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 17:39:44,495 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 17:39:44,495 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 17:39:44,495 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 17:39:44,496 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 17:39:44,496 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 17:39:44,496 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 17:39:44,496 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-01 17:39:44,496 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 17:39:44,496 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 17:39:44,496 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 17:39:44,496 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 17:39:44,496 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 17:43:44,557 - training.ctc_validation - INFO - Validation Results: Loss=6.1501, CER=0.0722, WER=0.2064
2025-06-01 17:43:44,558 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 17:43:44,561 - CtcTrainer - INFO - --- Epoch 53/100 Summary ---
2025-06-01 17:43:44,561 - CtcTrainer - INFO - Avg Train Loss: 0.6519
2025-06-01 17:43:44,561 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.150057373821999, 'val_cer': 0.07223816137633188, 'val_wer': 0.2064299900695134}
2025-06-01 17:43:44,561 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0742
2025-06-01 17:43:44,562 - CtcTrainer - INFO - ---------------------
2025-06-01 17:43:44,565 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 17:43:48,644 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 17:43:48,645 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-01 17:43:52,772 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-01 17:43:52,774 - CtcTrainer - INFO - New best metric (val_cer) at epoch 53: 0.0722
2025-06-01 17:43:52,779 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-01 17:43:52,780 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 17:43:52,782 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 17:43:54,278 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-01 17:43:54,279 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-01 17:43:54,889 - CtcTrainer - INFO - Starting Epoch 54/100
2025-06-01 18:24:10,100 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 19:12:09,236 - CtcTrainer - INFO - Running end-of-epoch 54 validation...
2025-06-01 19:12:11,883 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 19:12:11,885 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 19:12:11,885 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 19:12:11,885 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 19:12:11,885 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 19:12:11,885 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 19:12:11,885 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 19:12:11,886 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 19:12:11,886 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 19:12:11,886 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 19:12:11,886 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 19:12:11,886 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 19:12:11,886 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 19:12:11,887 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 19:12:11,887 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gắn lại mối quan hệ của họ'
2025-06-01 19:12:11,887 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 19:12:11,888 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 19:12:11,888 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 19:12:11,888 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 19:12:11,888 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 19:16:11,354 - training.ctc_validation - INFO - Validation Results: Loss=6.3245, CER=0.0741, WER=0.2110
2025-06-01 19:16:11,355 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 19:16:11,359 - CtcTrainer - INFO - --- Epoch 54/100 Summary ---
2025-06-01 19:16:11,360 - CtcTrainer - INFO - Avg Train Loss: 0.6462
2025-06-01 19:16:11,360 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.324538751715334, 'val_cer': 0.07411622177840407, 'val_wer': 0.21100027083145256}
2025-06-01 19:16:11,360 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0722
2025-06-01 19:16:11,360 - CtcTrainer - INFO - ---------------------
2025-06-01 19:16:11,365 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 19:16:15,238 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 19:16:15,240 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-01 19:16:16,107 - CtcTrainer - INFO - Starting Epoch 55/100
2025-06-01 19:32:25,772 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 20:44:37,895 - CtcTrainer - INFO - Running end-of-epoch 55 validation...
2025-06-01 20:44:40,834 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 20:44:40,834 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 20:44:40,834 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 20:44:40,834 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 20:44:40,834 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 20:44:40,834 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 20:44:40,834 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 20:44:40,834 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 20:44:40,835 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 20:44:40,835 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 20:44:40,835 - training.ctc_validation - INFO -   Prediction  : 'và ngày 31 tháng 12 năm 194.'
2025-06-01 20:44:40,835 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 20:44:40,835 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 20:44:40,835 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 20:44:40,835 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đau ban gần lại mối quan hệ của họ'
2025-06-01 20:44:40,835 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 20:44:40,835 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 20:44:40,835 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 20:44:40,835 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 20:44:40,835 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 20:48:33,900 - training.ctc_validation - INFO - Validation Results: Loss=6.4292, CER=0.0742, WER=0.2097
2025-06-01 20:48:33,900 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 20:48:33,903 - CtcTrainer - INFO - --- Epoch 55/100 Summary ---
2025-06-01 20:48:33,904 - CtcTrainer - INFO - Avg Train Loss: 0.6407
2025-06-01 20:48:33,904 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.42918162754255, 'val_cer': 0.07416184267885928, 'val_wer': 0.20970253678793896}
2025-06-01 20:48:33,904 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0722
2025-06-01 20:48:33,904 - CtcTrainer - INFO - ---------------------
2025-06-01 20:48:33,907 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 20:48:36,827 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 20:48:36,828 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-01 20:48:37,286 - CtcTrainer - INFO - Starting Epoch 56/100
2025-06-01 21:06:25,004 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 22:17:02,172 - CtcTrainer - INFO - Running end-of-epoch 56 validation...
2025-06-01 22:17:04,758 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 22:17:04,759 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 22:17:04,759 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 22:17:04,759 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 22:17:04,759 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 22:17:04,759 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 22:17:04,759 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 22:17:04,759 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 22:17:04,759 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 22:17:04,760 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 22:17:04,760 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 3 tháng 12 năm 1947.'
2025-06-01 22:17:04,760 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 22:17:04,760 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 22:17:04,760 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 22:17:04,760 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-01 22:17:04,760 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 22:17:04,760 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 22:17:04,760 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 22:17:04,760 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 22:17:04,760 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 22:20:55,457 - training.ctc_validation - INFO - Validation Results: Loss=6.1937, CER=0.0723, WER=0.2047
2025-06-01 22:20:55,457 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 22:20:55,460 - CtcTrainer - INFO - --- Epoch 56/100 Summary ---
2025-06-01 22:20:55,460 - CtcTrainer - INFO - Avg Train Loss: 0.6325
2025-06-01 22:20:55,461 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.193739853298245, 'val_cer': 0.07231039446871927, 'val_wer': 0.20467522794980592}
2025-06-01 22:20:55,461 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0722
2025-06-01 22:20:55,461 - CtcTrainer - INFO - ---------------------
2025-06-01 22:20:55,464 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 22:20:57,626 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 22:20:57,626 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=7
2025-06-01 22:20:58,187 - CtcTrainer - INFO - Starting Epoch 57/100
2025-06-01 22:46:35,929 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-01 23:50:10,824 - CtcTrainer - INFO - Running end-of-epoch 57 validation...
2025-06-01 23:50:13,182 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-01 23:50:13,184 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-01 23:50:13,184 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-01 23:50:13,185 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 23:50:13,185 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-01 23:50:13,185 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-01 23:50:13,185 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-01 23:50:13,185 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 23:50:13,185 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-01 23:50:13,186 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 23:50:13,186 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-01 23:50:13,186 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 23:50:13,186 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-01 23:50:13,186 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-01 23:50:13,186 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu ban gần lại mỗi quan hệ của họ'
2025-06-01 23:50:13,187 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 23:50:13,187 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-01 23:50:13,187 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-01 23:50:13,187 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-01 23:50:13,187 - training.ctc_validation - INFO - ---------------------------------
2025-06-01 23:54:18,951 - training.ctc_validation - INFO - Validation Results: Loss=6.1496, CER=0.0709, WER=0.2030
2025-06-01 23:54:18,952 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-01 23:54:18,955 - CtcTrainer - INFO - --- Epoch 57/100 Summary ---
2025-06-01 23:54:18,956 - CtcTrainer - INFO - Avg Train Loss: 0.6343
2025-06-01 23:54:18,956 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.14955486098167, 'val_cer': 0.07091895700483582, 'val_wer': 0.20295996208359665}
2025-06-01 23:54:18,956 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0722
2025-06-01 23:54:18,956 - CtcTrainer - INFO - ---------------------
2025-06-01 23:54:18,961 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-01 23:54:23,311 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-01 23:54:23,312 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-01 23:54:26,852 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-01 23:54:26,853 - CtcTrainer - INFO - New best metric (val_cer) at epoch 57: 0.0709
2025-06-01 23:54:26,860 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-01 23:54:26,861 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 23:54:26,863 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-01 23:54:28,561 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-01 23:54:28,561 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-01 23:54:29,094 - CtcTrainer - INFO - Starting Epoch 58/100
2025-06-02 01:18:13,977 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 01:24:17,080 - CtcTrainer - INFO - Running end-of-epoch 58 validation...
2025-06-02 01:24:19,927 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 01:24:19,928 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 01:24:19,928 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 01:24:19,928 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 01:24:19,928 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 01:24:19,928 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 01:24:19,928 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 01:24:19,928 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 01:24:19,928 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 01:24:19,929 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 01:24:19,929 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 01:24:19,929 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 01:24:19,929 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 01:24:19,929 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 01:24:19,929 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mối quan hệ của họ'
2025-06-02 01:24:19,929 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 01:24:19,929 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 01:24:19,929 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 01:24:19,929 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 01:24:19,929 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 01:28:26,859 - training.ctc_validation - INFO - Validation Results: Loss=5.9168, CER=0.0688, WER=0.1969
2025-06-02 01:28:26,859 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 01:28:26,862 - CtcTrainer - INFO - --- Epoch 58/100 Summary ---
2025-06-02 01:28:26,863 - CtcTrainer - INFO - Avg Train Loss: 0.6304
2025-06-02 01:28:26,863 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.916757732595098, 'val_cer': 0.0688406715396547, 'val_wer': 0.1968662544010111}
2025-06-02 01:28:26,863 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0709
2025-06-02 01:28:26,863 - CtcTrainer - INFO - ---------------------
2025-06-02 01:28:26,867 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 01:28:30,893 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 01:28:30,893 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 01:28:34,662 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 01:28:34,664 - CtcTrainer - INFO - New best metric (val_cer) at epoch 58: 0.0688
2025-06-02 01:28:34,721 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 01:28:34,722 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 01:28:34,723 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 01:28:36,491 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 01:28:36,492 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 01:28:37,114 - CtcTrainer - INFO - Starting Epoch 59/100
2025-06-02 02:00:14,498 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 02:57:40,025 - CtcTrainer - INFO - Running end-of-epoch 59 validation...
2025-06-02 02:57:42,475 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 02:57:42,477 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 02:57:42,478 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 02:57:42,478 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 02:57:42,478 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 02:57:42,478 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 02:57:42,479 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 02:57:42,479 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 02:57:42,479 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 02:57:42,479 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 02:57:42,479 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năăm 1947.'
2025-06-02 02:57:42,479 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 02:57:42,479 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 02:57:42,479 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 02:57:42,480 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-02 02:57:42,480 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 02:57:42,480 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 02:57:42,480 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 02:57:42,480 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 02:57:42,480 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 03:01:49,160 - training.ctc_validation - INFO - Validation Results: Loss=5.9055, CER=0.0692, WER=0.1964
2025-06-02 03:01:49,160 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 03:01:49,163 - CtcTrainer - INFO - --- Epoch 59/100 Summary ---
2025-06-02 03:01:49,163 - CtcTrainer - INFO - Avg Train Loss: 0.6271
2025-06-02 03:01:49,163 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.905541364615924, 'val_cer': 0.06917522480965947, 'val_wer': 0.19644872257831542}
2025-06-02 03:01:49,164 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0688
2025-06-02 03:01:49,164 - CtcTrainer - INFO - ---------------------
2025-06-02 03:01:49,167 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 03:01:53,409 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 03:01:53,410 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-02 03:01:53,900 - CtcTrainer - INFO - Starting Epoch 60/100
2025-06-02 03:51:37,954 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 04:30:21,125 - CtcTrainer - INFO - Running end-of-epoch 60 validation...
2025-06-02 04:30:23,756 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 04:30:23,757 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 04:30:23,757 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 04:30:23,757 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 04:30:23,757 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 04:30:23,757 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 04:30:23,757 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 04:30:23,757 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 04:30:23,757 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 04:30:23,758 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 04:30:23,758 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 táng 12 năm 197.'
2025-06-02 04:30:23,758 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 04:30:23,758 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 04:30:23,758 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 04:30:23,758 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu han gần lại mối quan hệ của họ'
2025-06-02 04:30:23,758 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 04:30:23,758 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 04:30:23,758 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 04:30:23,759 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 04:30:23,759 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 04:34:32,881 - training.ctc_validation - INFO - Validation Results: Loss=6.0674, CER=0.0711, WER=0.2022
2025-06-02 04:34:32,882 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 04:34:32,886 - CtcTrainer - INFO - --- Epoch 60/100 Summary ---
2025-06-02 04:34:32,886 - CtcTrainer - INFO - Avg Train Loss: 0.6198
2025-06-02 04:34:32,886 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.06738011994652, 'val_cer': 0.0710748284147244, 'val_wer': 0.20222646023291505}
2025-06-02 04:34:32,886 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0688
2025-06-02 04:34:32,886 - CtcTrainer - INFO - ---------------------
2025-06-02 04:34:32,889 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 04:34:35,083 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 04:34:35,084 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-02 04:34:35,614 - CtcTrainer - INFO - Starting Epoch 61/100
2025-06-02 05:52:16,534 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 06:03:43,455 - CtcTrainer - INFO - Running end-of-epoch 61 validation...
2025-06-02 06:03:46,149 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 06:03:46,149 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 06:03:46,150 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 06:03:46,150 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 06:03:46,150 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 06:03:46,150 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 06:03:46,150 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 06:03:46,150 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 06:03:46,150 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 06:03:46,150 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 06:03:46,151 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 19447.'
2025-06-02 06:03:46,151 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 06:03:46,151 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 06:03:46,152 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 06:03:46,152 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-02 06:03:46,152 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 06:03:46,152 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 06:03:46,152 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 06:03:46,153 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 06:03:46,153 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 06:07:58,091 - training.ctc_validation - INFO - Validation Results: Loss=5.6724, CER=0.0669, WER=0.1904
2025-06-02 06:07:58,092 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 06:07:58,095 - CtcTrainer - INFO - --- Epoch 61/100 Summary ---
2025-06-02 06:07:58,095 - CtcTrainer - INFO - Avg Train Loss: 0.6207
2025-06-02 06:07:58,095 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.67240497281947, 'val_cer': 0.06685109338091424, 'val_wer': 0.19037758418344317}
2025-06-02 06:07:58,095 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0688
2025-06-02 06:07:58,095 - CtcTrainer - INFO - ---------------------
2025-06-02 06:07:58,098 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 06:08:01,394 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 06:08:01,395 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 06:08:04,879 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 06:08:04,879 - CtcTrainer - INFO - New best metric (val_cer) at epoch 61: 0.0669
2025-06-02 06:08:04,882 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 06:08:04,883 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 06:08:04,884 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 06:08:06,622 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 06:08:06,623 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 06:08:07,134 - CtcTrainer - INFO - Starting Epoch 62/100
2025-06-02 07:03:24,617 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 07:37:16,728 - CtcTrainer - INFO - Running end-of-epoch 62 validation...
2025-06-02 07:37:19,175 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 07:37:19,176 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 07:37:19,176 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 07:37:19,176 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 07:37:19,176 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 07:37:19,176 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 07:37:19,177 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 07:37:19,177 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 07:37:19,177 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 07:37:19,177 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 07:37:19,178 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 194.'
2025-06-02 07:37:19,178 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 07:37:19,178 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 07:37:19,179 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 07:37:19,179 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mới quan hệ của họ'
2025-06-02 07:37:19,179 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 07:37:19,179 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 07:37:19,180 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 07:37:19,180 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 07:37:19,180 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 07:41:22,955 - training.ctc_validation - INFO - Validation Results: Loss=5.7328, CER=0.0683, WER=0.1944
2025-06-02 07:41:22,956 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 07:41:22,960 - CtcTrainer - INFO - --- Epoch 62/100 Summary ---
2025-06-02 07:41:22,961 - CtcTrainer - INFO - Avg Train Loss: 0.6155
2025-06-02 07:41:22,961 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.732766990848744, 'val_cer': 0.06833123815123836, 'val_wer': 0.1944287713279769}
2025-06-02 07:41:22,961 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0669
2025-06-02 07:41:22,961 - CtcTrainer - INFO - ---------------------
2025-06-02 07:41:22,965 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 07:41:27,198 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 07:41:27,199 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-02 07:41:28,006 - CtcTrainer - INFO - Starting Epoch 63/100
2025-06-02 09:10:31,830 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 09:11:38,468 - CtcTrainer - INFO - Running end-of-epoch 63 validation...
2025-06-02 09:11:41,084 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 09:11:41,085 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 09:11:41,086 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 09:11:41,086 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 09:11:41,086 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 09:11:41,086 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 09:11:41,086 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 09:11:41,086 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 09:11:41,087 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 09:11:41,087 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 09:11:41,087 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 09:11:41,087 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 09:11:41,087 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 09:11:41,087 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 09:11:41,087 - training.ctc_validation - INFO -   Prediction  : 'Hai người bt đâu bạn gần lại mối quan hệ của họ'
2025-06-02 09:11:41,088 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 09:11:41,088 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 09:11:41,088 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 09:11:41,088 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 09:11:41,088 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 09:15:47,187 - training.ctc_validation - INFO - Validation Results: Loss=5.6727, CER=0.0661, WER=0.1886
2025-06-02 09:15:47,188 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 09:15:47,203 - CtcTrainer - INFO - --- Epoch 63/100 Summary ---
2025-06-02 09:15:47,203 - CtcTrainer - INFO - Avg Train Loss: 0.6153
2025-06-02 09:15:47,204 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.6726909523436655, 'val_cer': 0.06607427082594106, 'val_wer': 0.18864539135144895}
2025-06-02 09:15:47,204 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0669
2025-06-02 09:15:47,204 - CtcTrainer - INFO - ---------------------
2025-06-02 09:15:47,211 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 09:15:49,755 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 09:15:49,755 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 09:15:51,965 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 09:15:51,966 - CtcTrainer - INFO - New best metric (val_cer) at epoch 63: 0.0661
2025-06-02 09:15:51,970 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 09:15:51,971 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 09:15:51,972 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 09:15:54,687 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 09:15:54,688 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 09:15:55,520 - CtcTrainer - INFO - Starting Epoch 64/100
2025-06-02 09:16:50,231 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 10:45:21,410 - CtcTrainer - INFO - Running end-of-epoch 64 validation...
2025-06-02 10:45:23,793 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 10:45:23,794 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 10:45:23,794 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 10:45:23,794 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 10:45:23,794 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 10:45:23,795 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 10:45:23,795 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 10:45:23,795 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 10:45:23,795 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 10:45:23,795 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 10:45:23,795 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 10:45:23,795 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 10:45:23,795 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 10:45:23,796 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 10:45:23,796 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mới quan hệ của họ'
2025-06-02 10:45:23,796 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 10:45:23,796 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 10:45:23,796 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 10:45:23,796 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 10:45:23,796 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 10:49:30,880 - training.ctc_validation - INFO - Validation Results: Loss=5.4953, CER=0.0647, WER=0.1865
2025-06-02 10:49:30,881 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 10:49:30,889 - CtcTrainer - INFO - --- Epoch 64/100 Summary ---
2025-06-02 10:49:30,889 - CtcTrainer - INFO - Avg Train Loss: 0.6094
2025-06-02 10:49:30,889 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.495265771670205, 'val_cer': 0.06471071280122467, 'val_wer': 0.1864505281213325}
2025-06-02 10:49:30,889 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0661
2025-06-02 10:49:30,889 - CtcTrainer - INFO - ---------------------
2025-06-02 10:49:30,894 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 10:49:35,387 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 10:49:35,389 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 10:49:40,179 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 10:49:40,180 - CtcTrainer - INFO - New best metric (val_cer) at epoch 64: 0.0647
2025-06-02 10:49:40,185 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 10:49:40,187 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 10:49:40,189 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 10:49:41,967 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 10:49:41,967 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 10:49:42,530 - CtcTrainer - INFO - Starting Epoch 65/100
2025-06-02 11:40:41,770 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 12:18:10,918 - CtcTrainer - INFO - Running end-of-epoch 65 validation...
2025-06-02 12:18:13,410 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 12:18:13,410 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 12:18:13,410 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 12:18:13,410 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 12:18:13,410 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 12:18:13,411 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 12:18:13,411 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 12:18:13,411 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 12:18:13,411 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 12:18:13,411 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 12:18:13,411 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 12:18:13,411 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 12:18:13,411 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 12:18:13,411 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 12:18:13,411 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-02 12:18:13,412 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 12:18:13,412 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 12:18:13,412 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 12:18:13,412 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 12:18:13,412 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 12:22:19,465 - training.ctc_validation - INFO - Validation Results: Loss=5.5914, CER=0.0652, WER=0.1862
2025-06-02 12:22:19,465 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 12:22:19,470 - CtcTrainer - INFO - --- Epoch 65/100 Summary ---
2025-06-02 12:22:19,471 - CtcTrainer - INFO - Avg Train Loss: 0.6098
2025-06-02 12:22:19,471 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.5913862231160865, 'val_cer': 0.06517959427812528, 'val_wer': 0.18619098131262976}
2025-06-02 12:22:19,471 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0647
2025-06-02 12:22:19,471 - CtcTrainer - INFO - ---------------------
2025-06-02 12:22:19,474 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 12:22:23,450 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 12:22:23,451 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-02 12:22:24,052 - CtcTrainer - INFO - Starting Epoch 66/100
2025-06-02 12:52:42,980 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 13:51:15,755 - CtcTrainer - INFO - Running end-of-epoch 66 validation...
2025-06-02 13:51:18,365 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 13:51:18,366 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 13:51:18,366 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 13:51:18,366 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 13:51:18,366 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 13:51:18,366 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 13:51:18,366 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 13:51:18,366 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 13:51:18,366 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 13:51:18,366 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 13:51:18,367 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 13:51:18,367 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 13:51:18,367 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 13:51:18,367 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 13:51:18,367 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mỗi quan hệ của họ'
2025-06-02 13:51:18,367 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 13:51:18,367 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 13:51:18,367 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 13:51:18,367 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 13:51:18,367 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 13:55:26,686 - training.ctc_validation - INFO - Validation Results: Loss=5.5952, CER=0.0657, WER=0.1882
2025-06-02 13:55:26,687 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 13:55:26,692 - CtcTrainer - INFO - --- Epoch 66/100 Summary ---
2025-06-02 13:55:26,693 - CtcTrainer - INFO - Avg Train Loss: 0.6051
2025-06-02 13:55:26,693 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.595198793125647, 'val_cer': 0.06568776041930677, 'val_wer': 0.18818836327525504}
2025-06-02 13:55:26,693 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0647
2025-06-02 13:55:26,693 - CtcTrainer - INFO - ---------------------
2025-06-02 13:55:26,699 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 13:55:29,145 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 13:55:29,145 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-02 13:55:30,137 - CtcTrainer - INFO - Starting Epoch 67/100
2025-06-02 14:29:00,127 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 15:24:19,672 - CtcTrainer - INFO - Running end-of-epoch 67 validation...
2025-06-02 15:24:22,331 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 15:24:22,331 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 15:24:22,331 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 15:24:22,331 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 15:24:22,332 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 15:24:22,332 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 15:24:22,332 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 15:24:22,332 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 15:24:22,332 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 15:24:22,332 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 15:24:22,332 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 15:24:22,332 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 15:24:22,332 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 15:24:22,332 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 15:24:22,332 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mối quan hệ của họ'
2025-06-02 15:24:22,333 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 15:24:22,333 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 15:24:22,333 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 15:24:22,333 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 15:24:22,333 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 15:28:25,492 - training.ctc_validation - INFO - Validation Results: Loss=5.3595, CER=0.0632, WER=0.1822
2025-06-02 15:28:25,492 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 15:28:25,503 - CtcTrainer - INFO - --- Epoch 67/100 Summary ---
2025-06-02 15:28:25,503 - CtcTrainer - INFO - Avg Train Loss: 0.6038
2025-06-02 15:28:25,503 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.359462930996223, 'val_cer': 0.0632102920751427, 'val_wer': 0.18221878667509253}
2025-06-02 15:28:25,503 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0647
2025-06-02 15:28:25,503 - CtcTrainer - INFO - ---------------------
2025-06-02 15:28:25,507 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 15:28:27,716 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 15:28:27,716 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 15:28:31,609 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 15:28:31,610 - CtcTrainer - INFO - New best metric (val_cer) at epoch 67: 0.0632
2025-06-02 15:28:31,613 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 15:28:31,614 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 15:28:31,615 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 15:28:33,600 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 15:28:33,600 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 15:28:34,251 - CtcTrainer - INFO - Starting Epoch 68/100
2025-06-02 16:06:08,132 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 16:56:55,871 - CtcTrainer - INFO - Running end-of-epoch 68 validation...
2025-06-02 16:56:58,566 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 16:56:58,567 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 16:56:58,567 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 16:56:58,567 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 16:56:58,567 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 16:56:58,567 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 16:56:58,568 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 16:56:58,568 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 16:56:58,568 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 16:56:58,568 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 16:56:58,568 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 16:56:58,568 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 16:56:58,568 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 16:56:58,568 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 16:56:58,579 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mối quan hệ của họ'
2025-06-02 16:56:58,580 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 16:56:58,580 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 16:56:58,580 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 16:56:58,580 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 16:56:58,580 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 17:01:02,279 - training.ctc_validation - INFO - Validation Results: Loss=5.3161, CER=0.0620, WER=0.1791
2025-06-02 17:01:02,279 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 17:01:02,283 - CtcTrainer - INFO - --- Epoch 68/100 Summary ---
2025-06-02 17:01:02,283 - CtcTrainer - INFO - Avg Train Loss: 0.5994
2025-06-02 17:01:02,283 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.316087032650303, 'val_cer': 0.062041890124595746, 'val_wer': 0.17912115193644487}
2025-06-02 17:01:02,283 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0632
2025-06-02 17:01:02,283 - CtcTrainer - INFO - ---------------------
2025-06-02 17:01:02,287 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 17:01:04,342 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 17:01:04,342 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 17:01:08,378 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 17:01:08,378 - CtcTrainer - INFO - New best metric (val_cer) at epoch 68: 0.0620
2025-06-02 17:01:08,382 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 17:01:08,382 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 17:01:08,383 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 17:01:11,054 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 17:01:11,054 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 17:01:11,625 - CtcTrainer - INFO - Starting Epoch 69/100
2025-06-02 18:22:41,747 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 18:29:30,932 - CtcTrainer - INFO - Running end-of-epoch 69 validation...
2025-06-02 18:29:33,365 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 18:29:33,366 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 18:29:33,366 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 18:29:33,366 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 18:29:33,366 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 18:29:33,366 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 18:29:33,366 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 18:29:33,366 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 18:29:33,366 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 18:29:33,366 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 18:29:33,367 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 18:29:33,367 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 18:29:33,367 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 18:29:33,367 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 18:29:33,367 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mới quan hệ của họ'
2025-06-02 18:29:33,367 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 18:29:33,367 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 18:29:33,367 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 18:29:33,368 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 18:29:33,368 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 18:33:36,170 - training.ctc_validation - INFO - Validation Results: Loss=5.2435, CER=0.0618, WER=0.1774
2025-06-02 18:33:36,171 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 18:33:36,183 - CtcTrainer - INFO - --- Epoch 69/100 Summary ---
2025-06-02 18:33:36,184 - CtcTrainer - INFO - Avg Train Loss: 0.5997
2025-06-02 18:33:36,184 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.243491512611214, 'val_cer': 0.06183659607254737, 'val_wer': 0.17741717071409227}
2025-06-02 18:33:36,184 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0620
2025-06-02 18:33:36,184 - CtcTrainer - INFO - ---------------------
2025-06-02 18:33:36,188 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 18:33:38,451 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 18:33:38,451 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 18:33:43,347 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 18:33:43,348 - CtcTrainer - INFO - New best metric (val_cer) at epoch 69: 0.0618
2025-06-02 18:33:43,353 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 18:33:43,353 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 18:33:43,354 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 18:33:45,154 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 18:33:45,155 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 18:33:45,799 - CtcTrainer - INFO - Starting Epoch 70/100
2025-06-02 18:50:56,777 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 20:01:54,113 - CtcTrainer - INFO - Running end-of-epoch 70 validation...
2025-06-02 20:01:56,242 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 20:01:56,243 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 20:01:56,243 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 20:01:56,243 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 20:01:56,243 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 20:01:56,243 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 20:01:56,243 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 20:01:56,243 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 20:01:56,243 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 20:01:56,244 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 20:01:56,244 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 20:01:56,244 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 20:01:56,244 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 20:01:56,244 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 20:01:56,244 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mối quan hệ của họ'
2025-06-02 20:01:56,244 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 20:01:56,244 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 20:01:56,244 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 20:01:56,244 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 20:01:56,244 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 20:05:56,485 - training.ctc_validation - INFO - Validation Results: Loss=5.1893, CER=0.0611, WER=0.1761
2025-06-02 20:05:56,485 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 20:05:56,492 - CtcTrainer - INFO - --- Epoch 70/100 Summary ---
2025-06-02 20:05:56,492 - CtcTrainer - INFO - Avg Train Loss: 0.5910
2025-06-02 20:05:56,492 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.189289601082327, 'val_cer': 0.061110463406968844, 'val_wer': 0.1760968673828654}
2025-06-02 20:05:56,492 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0618
2025-06-02 20:05:56,492 - CtcTrainer - INFO - ---------------------
2025-06-02 20:05:56,496 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 20:05:59,564 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 20:05:59,565 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 20:06:02,567 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 20:06:02,567 - CtcTrainer - INFO - New best metric (val_cer) at epoch 70: 0.0611
2025-06-02 20:06:02,571 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 20:06:02,572 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 20:06:02,573 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 20:06:04,026 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 20:06:04,026 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 20:06:04,510 - CtcTrainer - INFO - Starting Epoch 71/100
2025-06-02 20:46:07,466 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 21:34:07,879 - CtcTrainer - INFO - Running end-of-epoch 71 validation...
2025-06-02 21:34:10,326 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 21:34:10,326 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 21:34:10,326 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 21:34:10,327 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 21:34:10,327 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 21:34:10,327 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu ban gần lại mối quan hệ của họ'
2025-06-02 21:34:10,327 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 21:34:10,328 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 21:34:10,328 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 21:34:10,328 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 21:34:10,328 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 21:38:20,010 - training.ctc_validation - INFO - Validation Results: Loss=5.0773, CER=0.0596, WER=0.1713
2025-06-02 21:38:20,010 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 21:38:20,014 - CtcTrainer - INFO - --- Epoch 71/100 Summary ---
2025-06-02 21:38:20,015 - CtcTrainer - INFO - Avg Train Loss: 0.5847
2025-06-02 21:38:20,015 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.077311061327891, 'val_cer': 0.05961004268088687, 'val_wer': 0.17134038999729168}
2025-06-02 21:38:20,015 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0611
2025-06-02 21:38:20,015 - CtcTrainer - INFO - ---------------------
2025-06-02 21:38:20,019 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 21:38:24,446 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 21:38:24,447 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 21:38:27,780 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 21:38:27,780 - CtcTrainer - INFO - New best metric (val_cer) at epoch 71: 0.0596
2025-06-02 21:38:27,785 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 21:38:27,785 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 21:38:27,786 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 21:38:28,959 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 21:38:28,960 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 21:38:29,582 - CtcTrainer - INFO - Starting Epoch 72/100
2025-06-02 21:47:25,545 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-02 23:06:54,736 - CtcTrainer - INFO - Running end-of-epoch 72 validation...
2025-06-02 23:06:56,900 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-02 23:06:56,900 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-02 23:06:56,901 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-02 23:06:56,901 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 23:06:56,974 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-02 23:06:56,974 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-02 23:06:56,975 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-02 23:06:56,975 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 23:06:56,976 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-02 23:06:56,976 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 23:06:56,976 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-02 23:06:56,977 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 23:06:56,977 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-02 23:06:56,977 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-02 23:06:56,978 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-02 23:06:56,978 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 23:06:56,979 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-02 23:06:56,979 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-02 23:06:56,980 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-02 23:06:56,980 - training.ctc_validation - INFO - ---------------------------------
2025-06-02 23:11:09,260 - training.ctc_validation - INFO - Validation Results: Loss=4.9807, CER=0.0584, WER=0.1704
2025-06-02 23:11:09,261 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-02 23:11:09,264 - CtcTrainer - INFO - --- Epoch 72/100 Summary ---
2025-06-02 23:11:09,265 - CtcTrainer - INFO - Avg Train Loss: 0.5845
2025-06-02 23:11:09,265 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.980718436201201, 'val_cer': 0.05839095084094526, 'val_wer': 0.17040376455719058}
2025-06-02 23:11:09,265 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0596
2025-06-02 23:11:09,265 - CtcTrainer - INFO - ---------------------
2025-06-02 23:11:09,269 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-02 23:11:12,824 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-02 23:11:12,825 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-02 23:11:16,872 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-02 23:11:16,873 - CtcTrainer - INFO - New best metric (val_cer) at epoch 72: 0.0584
2025-06-02 23:11:16,879 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-02 23:11:16,880 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 23:11:16,882 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-02 23:11:18,536 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-02 23:11:18,536 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-02 23:11:19,171 - CtcTrainer - INFO - Starting Epoch 73/100
2025-06-02 23:42:50,518 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 00:39:18,953 - CtcTrainer - INFO - Running end-of-epoch 73 validation...
2025-06-03 00:39:21,421 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 00:39:21,422 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 00:39:21,422 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 00:39:21,422 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 00:39:21,422 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 00:39:21,422 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 00:39:21,423 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 00:39:21,423 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 00:39:21,423 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 00:39:21,423 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 00:39:21,423 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 00:39:21,423 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 00:39:21,423 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 00:39:21,423 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 00:39:21,423 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-03 00:39:21,423 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 00:39:21,424 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 00:39:21,424 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 00:39:21,424 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 00:39:21,424 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 00:43:34,269 - training.ctc_validation - INFO - Validation Results: Loss=4.9357, CER=0.0584, WER=0.1697
2025-06-03 00:43:34,269 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 00:43:34,274 - CtcTrainer - INFO - --- Epoch 73/100 Summary ---
2025-06-03 00:43:34,274 - CtcTrainer - INFO - Avg Train Loss: 0.5767
2025-06-03 00:43:34,275 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.935734368685598, 'val_cer': 0.058441640730339924, 'val_wer': 0.16971540128193555}
2025-06-03 00:43:34,275 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0584
2025-06-03 00:43:34,275 - CtcTrainer - INFO - ---------------------
2025-06-03 00:43:34,279 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 00:43:36,444 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 00:43:36,444 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-03 00:43:37,063 - CtcTrainer - INFO - Starting Epoch 74/100
2025-06-03 01:06:43,604 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 02:11:52,402 - CtcTrainer - INFO - Running end-of-epoch 74 validation...
2025-06-03 02:11:54,588 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 02:11:54,589 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 02:11:54,589 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 02:11:54,589 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 02:11:54,589 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 02:11:54,590 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 02:11:54,590 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 02:11:54,590 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 02:11:54,590 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 02:11:54,591 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 02:11:54,591 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 02:11:54,591 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 02:11:54,591 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 02:11:54,592 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 02:11:54,592 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu hạn gần lại mối quan hệ của họ'
2025-06-03 02:11:54,592 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 02:11:54,592 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 02:11:54,593 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 02:11:54,593 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 02:11:54,673 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 02:16:05,872 - training.ctc_validation - INFO - Validation Results: Loss=4.9072, CER=0.0575, WER=0.1667
2025-06-03 02:16:05,872 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 02:16:05,878 - CtcTrainer - INFO - --- Epoch 74/100 Summary ---
2025-06-03 02:16:05,878 - CtcTrainer - INFO - Avg Train Loss: 0.5790
2025-06-03 02:16:05,878 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.907228739652588, 'val_cer': 0.05750007603483409, 'val_wer': 0.1667024013722127}
2025-06-03 02:16:05,879 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0584
2025-06-03 02:16:05,879 - CtcTrainer - INFO - ---------------------
2025-06-03 02:16:05,883 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 02:16:09,084 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 02:16:09,085 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 02:16:12,137 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 02:16:12,137 - CtcTrainer - INFO - New best metric (val_cer) at epoch 74: 0.0575
2025-06-03 02:16:12,142 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 02:16:12,142 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 02:16:12,143 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 02:16:13,347 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 02:16:13,347 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 02:16:13,988 - CtcTrainer - INFO - Starting Epoch 75/100
2025-06-03 03:05:46,729 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 03:44:20,612 - CtcTrainer - INFO - Running end-of-epoch 75 validation...
2025-06-03 03:44:22,685 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 03:44:22,686 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 03:44:22,686 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 03:44:22,686 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 03:44:22,686 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 03:44:22,687 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 03:44:22,687 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 03:44:22,687 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 03:44:22,687 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 03:44:22,687 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 03:44:22,687 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 03:44:22,687 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 03:44:22,688 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 03:44:22,688 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 03:44:22,688 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-03 03:44:22,688 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 03:44:22,688 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 03:44:22,689 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 03:44:22,689 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 03:44:22,689 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 03:48:30,970 - training.ctc_validation - INFO - Validation Results: Loss=4.8296, CER=0.0568, WER=0.1644
2025-06-03 03:48:30,970 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 03:48:30,973 - CtcTrainer - INFO - --- Epoch 75/100 Summary ---
2025-06-03 03:48:30,974 - CtcTrainer - INFO - Avg Train Loss: 0.5732
2025-06-03 03:48:30,974 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.829646292062161, 'val_cer': 0.05684744370887783, 'val_wer': 0.16443418795702808}
2025-06-03 03:48:30,974 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0575
2025-06-03 03:48:30,974 - CtcTrainer - INFO - ---------------------
2025-06-03 03:48:30,977 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 03:48:34,137 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 03:48:34,138 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 03:48:37,402 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 03:48:37,403 - CtcTrainer - INFO - New best metric (val_cer) at epoch 75: 0.0568
2025-06-03 03:48:37,407 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 03:48:37,407 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 03:48:37,416 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 03:48:38,626 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 03:48:38,627 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 03:48:39,181 - CtcTrainer - INFO - Starting Epoch 76/100
2025-06-03 04:09:07,489 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 05:17:15,889 - CtcTrainer - INFO - Running end-of-epoch 76 validation...
2025-06-03 05:17:18,089 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 05:17:18,089 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 05:17:18,090 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 05:17:18,090 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 05:17:18,090 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 05:17:18,091 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 05:17:18,091 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 05:17:18,091 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 05:17:18,092 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 05:17:18,092 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 05:17:18,092 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 05:17:18,092 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 05:17:18,092 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 05:17:18,092 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 05:17:18,092 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-03 05:17:18,093 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 05:17:18,093 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 05:17:18,093 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 05:17:18,093 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 05:17:18,093 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 05:21:26,858 - training.ctc_validation - INFO - Validation Results: Loss=4.9082, CER=0.0571, WER=0.1648
2025-06-03 05:21:26,859 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 05:21:26,862 - CtcTrainer - INFO - --- Epoch 76/100 Summary ---
2025-06-03 05:21:26,863 - CtcTrainer - INFO - Avg Train Loss: 0.5711
2025-06-03 05:21:26,863 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.908235754346969, 'val_cer': 0.057143979561836596, 'val_wer': 0.16476144262887063}
2025-06-03 05:21:26,863 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0568
2025-06-03 05:21:26,863 - CtcTrainer - INFO - ---------------------
2025-06-03 05:21:26,868 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 05:21:31,100 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 05:21:31,103 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-03 05:21:31,711 - CtcTrainer - INFO - Starting Epoch 77/100
2025-06-03 05:40:56,048 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 06:49:38,996 - CtcTrainer - INFO - Running end-of-epoch 77 validation...
2025-06-03 06:49:41,288 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 06:49:41,289 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 06:49:41,289 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 06:49:41,289 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 06:49:41,289 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 06:49:41,289 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 06:49:41,289 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 06:49:41,289 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 06:49:41,289 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 06:49:41,289 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 06:49:41,289 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 06:49:41,289 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 06:49:41,290 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 06:49:41,290 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 06:49:41,290 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu hạn gần lại mối quan hệ của họ'
2025-06-03 06:49:41,290 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 06:49:41,290 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 06:49:41,290 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 06:49:41,290 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 06:49:41,290 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 06:53:49,355 - training.ctc_validation - INFO - Validation Results: Loss=4.8472, CER=0.0562, WER=0.1616
2025-06-03 06:53:49,355 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 06:53:49,359 - CtcTrainer - INFO - --- Epoch 77/100 Summary ---
2025-06-03 06:53:49,359 - CtcTrainer - INFO - Avg Train Loss: 0.5687
2025-06-03 06:53:49,359 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.847186025347381, 'val_cer': 0.05620621660803536, 'val_wer': 0.16157353073936986}
2025-06-03 06:53:49,359 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0568
2025-06-03 06:53:49,360 - CtcTrainer - INFO - ---------------------
2025-06-03 06:53:49,363 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 06:53:51,483 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 06:53:51,483 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 06:53:54,636 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 06:53:54,637 - CtcTrainer - INFO - New best metric (val_cer) at epoch 77: 0.0562
2025-06-03 06:53:54,641 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 06:53:54,643 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 06:53:54,645 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 06:53:56,229 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 06:53:56,230 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 06:53:57,081 - CtcTrainer - INFO - Starting Epoch 78/100
2025-06-03 08:18:57,532 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 08:21:55,475 - CtcTrainer - INFO - Running end-of-epoch 78 validation...
2025-06-03 08:21:57,808 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 08:21:57,808 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 08:21:57,808 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 08:21:57,809 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 08:21:57,809 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 08:21:57,809 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 08:21:57,809 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 08:21:57,809 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 08:21:57,809 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 08:21:57,809 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 08:21:57,809 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 08:21:57,810 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 08:21:57,810 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 08:21:57,810 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 08:21:57,810 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu ban gần lại mối quan hệ của họ'
2025-06-03 08:21:57,810 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 08:21:57,810 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 08:21:57,810 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 08:21:57,810 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 08:21:57,810 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 08:26:09,888 - training.ctc_validation - INFO - Validation Results: Loss=4.7315, CER=0.0554, WER=0.1616
2025-06-03 08:26:09,889 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 08:26:09,897 - CtcTrainer - INFO - --- Epoch 78/100 Summary ---
2025-06-03 08:26:09,897 - CtcTrainer - INFO - Avg Train Loss: 0.5663
2025-06-03 08:26:09,897 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.7314839763178895, 'val_cer': 0.055421790569652976, 'val_wer': 0.16156224609551323}
2025-06-03 08:26:09,898 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0562
2025-06-03 08:26:09,898 - CtcTrainer - INFO - ---------------------
2025-06-03 08:26:09,901 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 08:26:12,904 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 08:26:12,905 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 08:26:16,985 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 08:26:16,986 - CtcTrainer - INFO - New best metric (val_cer) at epoch 78: 0.0554
2025-06-03 08:26:16,993 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 08:26:16,994 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 08:26:16,995 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 08:26:18,181 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 08:26:18,181 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 08:26:18,810 - CtcTrainer - INFO - Starting Epoch 79/100
2025-06-03 09:00:44,160 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 09:54:23,905 - CtcTrainer - INFO - Running end-of-epoch 79 validation...
2025-06-03 09:54:25,797 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 09:54:25,797 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 09:54:25,797 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 09:54:25,797 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 09:54:25,798 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 09:54:25,798 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 09:54:25,798 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 09:54:25,798 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 09:54:25,798 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 09:54:25,798 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 09:54:25,798 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 09:54:25,798 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 09:54:25,798 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 09:54:25,798 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 09:54:25,798 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-03 09:54:25,799 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 09:54:25,799 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 09:54:25,799 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 09:54:25,799 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 09:54:25,799 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 09:58:33,357 - training.ctc_validation - INFO - Validation Results: Loss=4.7621, CER=0.0556, WER=0.1612
2025-06-03 09:58:33,357 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 09:58:33,360 - CtcTrainer - INFO - --- Epoch 79/100 Summary ---
2025-06-03 09:58:33,361 - CtcTrainer - INFO - Avg Train Loss: 0.5644
2025-06-03 09:58:33,361 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.7620704677151, 'val_cer': 0.05557386023783696, 'val_wer': 0.1612462760675273}
2025-06-03 09:58:33,361 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0554
2025-06-03 09:58:33,361 - CtcTrainer - INFO - ---------------------
2025-06-03 09:58:33,365 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 09:58:36,427 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 09:58:36,428 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-03 09:58:36,976 - CtcTrainer - INFO - Starting Epoch 80/100
2025-06-03 10:24:27,840 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 11:26:55,612 - CtcTrainer - INFO - Running end-of-epoch 80 validation...
2025-06-03 11:26:58,013 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 11:26:58,014 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 11:26:58,014 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 11:26:58,014 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 11:26:58,014 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 11:26:58,015 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 11:26:58,015 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 11:26:58,015 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 11:26:58,015 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 11:26:58,015 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 11:26:58,015 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 11:26:58,015 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 11:26:58,015 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 11:26:58,015 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 11:26:58,015 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-03 11:26:58,015 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 11:26:58,016 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 11:26:58,016 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 11:26:58,016 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 11:26:58,016 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 11:31:05,875 - training.ctc_validation - INFO - Validation Results: Loss=4.6203, CER=0.0540, WER=0.1568
2025-06-03 11:31:05,875 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 11:31:05,878 - CtcTrainer - INFO - --- Epoch 80/100 Summary ---
2025-06-03 11:31:05,879 - CtcTrainer - INFO - Avg Train Loss: 0.5615
2025-06-03 11:31:05,879 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.620250103284738, 'val_cer': 0.05395685276614726, 'val_wer': 0.15676063013451297}
2025-06-03 11:31:05,879 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0554
2025-06-03 11:31:05,879 - CtcTrainer - INFO - ---------------------
2025-06-03 11:31:05,883 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 11:31:08,945 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 11:31:08,946 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 11:31:11,868 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 11:31:11,869 - CtcTrainer - INFO - New best metric (val_cer) at epoch 80: 0.0540
2025-06-03 11:31:11,873 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 11:31:11,873 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 11:31:11,874 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 11:31:13,073 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 11:31:13,074 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 11:31:13,662 - CtcTrainer - INFO - Starting Epoch 81/100
2025-06-03 12:34:12,449 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 12:59:58,360 - CtcTrainer - INFO - Running end-of-epoch 81 validation...
2025-06-03 13:00:00,733 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 13:00:00,733 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 13:00:00,733 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 13:00:00,734 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 13:00:00,734 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 13:00:00,734 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-03 13:00:00,734 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 13:00:00,735 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 13:00:00,735 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 13:00:00,735 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 13:00:00,735 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 13:04:08,254 - training.ctc_validation - INFO - Validation Results: Loss=4.5875, CER=0.0539, WER=0.1572
2025-06-03 13:04:08,254 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 13:04:08,259 - CtcTrainer - INFO - --- Epoch 81/100 Summary ---
2025-06-03 13:04:08,259 - CtcTrainer - INFO - Avg Train Loss: 0.5544
2025-06-03 13:04:08,259 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.5875151853853255, 'val_cer': 0.053908697371222336, 'val_wer': 0.15721201588877856}
2025-06-03 13:04:08,259 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0540
2025-06-03 13:04:08,259 - CtcTrainer - INFO - ---------------------
2025-06-03 13:04:08,263 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 13:04:11,906 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 13:04:11,907 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 13:04:15,060 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 13:04:15,061 - CtcTrainer - INFO - New best metric (val_cer) at epoch 81: 0.0539
2025-06-03 13:04:15,065 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 13:04:15,066 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 13:04:15,082 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 13:04:16,689 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 13:04:16,689 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 13:04:17,207 - CtcTrainer - INFO - Starting Epoch 82/100
2025-06-03 13:37:32,122 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 14:32:21,926 - CtcTrainer - INFO - Running end-of-epoch 82 validation...
2025-06-03 14:32:24,614 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 14:32:24,615 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 14:32:24,615 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 14:32:24,615 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 14:32:24,616 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 14:32:24,616 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 14:32:24,616 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 14:32:24,616 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 14:32:24,616 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 14:32:24,617 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 14:32:24,617 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 14:32:24,617 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 14:32:24,617 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 14:32:24,617 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 14:32:24,617 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu hạn gần lại mối quan hệ của họ'
2025-06-03 14:32:24,618 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 14:32:24,618 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 14:32:24,618 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 14:32:24,618 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 14:32:24,618 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 14:36:35,592 - training.ctc_validation - INFO - Validation Results: Loss=4.5143, CER=0.0528, WER=0.1537
2025-06-03 14:36:35,593 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 14:36:35,596 - CtcTrainer - INFO - --- Epoch 82/100 Summary ---
2025-06-03 14:36:35,596 - CtcTrainer - INFO - Avg Train Loss: 0.5559
2025-06-03 14:36:35,597 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.51431190885893, 'val_cer': 0.05280365778241872, 'val_wer': 0.1537194186151485}
2025-06-03 14:36:35,597 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0539
2025-06-03 14:36:35,597 - CtcTrainer - INFO - ---------------------
2025-06-03 14:36:35,600 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 14:36:39,151 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 14:36:39,152 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 14:36:43,204 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 14:36:43,205 - CtcTrainer - INFO - New best metric (val_cer) at epoch 82: 0.0528
2025-06-03 14:36:43,215 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 14:36:43,216 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 14:36:43,218 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 14:36:44,496 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 14:36:44,496 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 14:36:45,023 - CtcTrainer - INFO - Starting Epoch 83/100
2025-06-03 15:33:48,228 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 16:04:43,453 - CtcTrainer - INFO - Running end-of-epoch 83 validation...
2025-06-03 16:04:45,779 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 16:04:45,779 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 16:04:45,779 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 16:04:45,779 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 16:04:45,780 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 16:04:45,780 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 16:04:45,780 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 16:04:45,780 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 16:04:45,780 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 16:04:45,780 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 16:04:45,781 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 16:04:45,781 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 16:04:45,781 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 16:04:45,781 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 16:04:45,781 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-03 16:04:45,782 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 16:04:45,782 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 16:04:45,782 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 16:04:45,782 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 16:04:45,782 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 16:08:55,764 - training.ctc_validation - INFO - Validation Results: Loss=4.5732, CER=0.0534, WER=0.1548
2025-06-03 16:08:55,765 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 16:08:55,774 - CtcTrainer - INFO - --- Epoch 83/100 Summary ---
2025-06-03 16:08:55,775 - CtcTrainer - INFO - Avg Train Loss: 0.5507
2025-06-03 16:08:55,775 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.573220579699636, 'val_cer': 0.053404332971745454, 'val_wer': 0.15475196352803106}
2025-06-03 16:08:55,775 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0528
2025-06-03 16:08:55,775 - CtcTrainer - INFO - ---------------------
2025-06-03 16:08:55,779 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 16:08:58,915 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 16:08:58,916 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-03 16:08:59,559 - CtcTrainer - INFO - Starting Epoch 84/100
2025-06-03 17:05:21,788 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 17:37:27,294 - CtcTrainer - INFO - Running end-of-epoch 84 validation...
2025-06-03 17:37:29,896 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 17:37:29,896 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 17:37:29,897 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 17:37:29,897 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 17:37:29,897 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 17:37:29,897 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 17:37:29,898 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 17:37:29,898 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 17:37:29,898 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 17:37:29,898 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 17:37:29,898 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 17:37:29,898 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 17:37:29,898 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 17:37:29,898 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 17:37:29,898 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-03 17:37:29,898 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 17:37:29,899 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 17:37:29,899 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 17:37:29,899 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 17:37:29,899 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 17:41:31,458 - training.ctc_validation - INFO - Validation Results: Loss=4.4176, CER=0.0520, WER=0.1519
2025-06-03 17:41:31,459 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 17:41:31,463 - CtcTrainer - INFO - --- Epoch 84/100 Summary ---
2025-06-03 17:41:31,463 - CtcTrainer - INFO - Avg Train Loss: 0.5529
2025-06-03 17:41:31,463 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.417556285504438, 'val_cer': 0.051996421293808735, 'val_wer': 0.1518743793445879}
2025-06-03 17:41:31,463 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0528
2025-06-03 17:41:31,464 - CtcTrainer - INFO - ---------------------
2025-06-03 17:41:31,470 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 17:41:34,841 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 17:41:34,842 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 17:41:38,074 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 17:41:38,075 - CtcTrainer - INFO - New best metric (val_cer) at epoch 84: 0.0520
2025-06-03 17:41:38,080 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 17:41:38,081 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 17:41:38,082 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 17:41:39,419 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 17:41:39,420 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 17:41:40,309 - CtcTrainer - INFO - Starting Epoch 85/100
2025-06-03 17:56:28,258 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 19:09:56,985 - CtcTrainer - INFO - Running end-of-epoch 85 validation...
2025-06-03 19:09:59,674 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 19:09:59,674 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 19:09:59,674 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 19:09:59,674 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 19:09:59,675 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 19:09:59,675 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 19:09:59,675 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 19:09:59,675 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 19:09:59,675 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 19:09:59,676 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 19:09:59,676 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 19:09:59,677 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 19:09:59,677 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 19:09:59,677 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 19:09:59,677 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đâu bạn gần lại mối quan hệ của họ'
2025-06-03 19:09:59,677 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 19:09:59,677 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 19:09:59,677 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 19:09:59,677 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 19:09:59,678 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 19:14:02,952 - training.ctc_validation - INFO - Validation Results: Loss=4.4023, CER=0.0518, WER=0.1510
2025-06-03 19:14:02,952 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 19:14:02,961 - CtcTrainer - INFO - --- Epoch 85/100 Summary ---
2025-06-03 19:14:02,961 - CtcTrainer - INFO - Avg Train Loss: 0.5482
2025-06-03 19:14:02,961 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.402323814942542, 'val_cer': 0.05177465302770709, 'val_wer': 0.15096032319220004}
2025-06-03 19:14:02,962 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0520
2025-06-03 19:14:02,962 - CtcTrainer - INFO - ---------------------
2025-06-03 19:14:02,965 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 19:14:06,094 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 19:14:06,094 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 19:14:09,726 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 19:14:09,727 - CtcTrainer - INFO - New best metric (val_cer) at epoch 85: 0.0518
2025-06-03 19:14:09,731 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 19:14:09,732 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 19:14:09,732 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 19:14:10,947 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 19:14:10,947 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 19:14:11,644 - CtcTrainer - INFO - Starting Epoch 86/100
2025-06-03 20:32:44,092 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 20:42:19,601 - CtcTrainer - INFO - Running end-of-epoch 86 validation...
2025-06-03 20:42:21,884 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 20:42:21,885 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 20:42:21,885 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 20:42:21,885 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 20:42:21,885 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 20:42:21,886 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 20:42:21,886 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 20:42:21,886 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 20:42:21,886 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 20:42:21,886 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 20:42:21,886 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 20:42:21,886 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 20:42:21,886 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 20:42:21,886 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 20:42:21,887 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-03 20:42:21,887 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 20:42:21,887 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 20:42:21,887 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 20:42:21,887 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 20:42:21,887 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 20:46:30,667 - training.ctc_validation - INFO - Validation Results: Loss=4.3718, CER=0.0513, WER=0.1505
2025-06-03 20:46:30,667 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 20:46:30,671 - CtcTrainer - INFO - --- Epoch 86/100 Summary ---
2025-06-03 20:46:30,671 - CtcTrainer - INFO - Avg Train Loss: 0.5539
2025-06-03 20:46:30,672 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.371773519681336, 'val_cer': 0.051294366325692675, 'val_wer': 0.1504976527940778}
2025-06-03 20:46:30,672 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0518
2025-06-03 20:46:30,672 - CtcTrainer - INFO - ---------------------
2025-06-03 20:46:30,677 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 20:46:35,210 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 20:46:35,210 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 20:46:38,501 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 20:46:38,504 - CtcTrainer - INFO - New best metric (val_cer) at epoch 86: 0.0513
2025-06-03 20:46:38,512 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 20:46:38,513 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 20:46:38,516 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 20:46:39,737 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 20:46:39,738 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 20:46:40,798 - CtcTrainer - INFO - Starting Epoch 87/100
2025-06-03 21:39:33,242 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 22:14:50,861 - CtcTrainer - INFO - Running end-of-epoch 87 validation...
2025-06-03 22:14:53,286 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 22:14:53,287 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 22:14:53,287 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 22:14:53,287 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 22:14:53,288 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 22:14:53,288 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 22:14:53,288 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 22:14:53,288 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 22:14:53,288 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 22:14:53,288 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 22:14:53,288 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 197.'
2025-06-03 22:14:53,288 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 22:14:53,288 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 22:14:53,289 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 22:14:53,289 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-03 22:14:53,289 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 22:14:53,289 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 22:14:53,289 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 22:14:53,289 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 22:14:53,290 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 22:19:01,863 - training.ctc_validation - INFO - Validation Results: Loss=4.3855, CER=0.0514, WER=0.1500
2025-06-03 22:19:01,864 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 22:19:01,868 - CtcTrainer - INFO - --- Epoch 87/100 Summary ---
2025-06-03 22:19:01,869 - CtcTrainer - INFO - Avg Train Loss: 0.5428
2025-06-03 22:19:01,869 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.385525220286813, 'val_cer': 0.05140588408236093, 'val_wer': 0.15004626703981222}
2025-06-03 22:19:01,869 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0513
2025-06-03 22:19:01,869 - CtcTrainer - INFO - ---------------------
2025-06-03 22:19:01,873 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 22:19:05,063 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 22:19:05,064 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-03 22:19:05,567 - CtcTrainer - INFO - Starting Epoch 88/100
2025-06-03 22:52:08,518 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-03 23:47:33,471 - CtcTrainer - INFO - Running end-of-epoch 88 validation...
2025-06-03 23:47:35,940 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-03 23:47:35,941 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-03 23:47:35,941 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-03 23:47:35,941 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 23:47:35,941 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-03 23:47:35,941 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-03 23:47:35,941 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-03 23:47:35,941 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 23:47:35,941 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-03 23:47:35,941 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 23:47:35,942 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-03 23:47:35,942 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 23:47:35,942 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-03 23:47:35,942 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-03 23:47:35,942 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-03 23:47:35,942 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 23:47:35,942 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-03 23:47:35,942 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-03 23:47:35,942 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-03 23:47:35,942 - training.ctc_validation - INFO - ---------------------------------
2025-06-03 23:51:41,064 - training.ctc_validation - INFO - Validation Results: Loss=4.3572, CER=0.0510, WER=0.1483
2025-06-03 23:51:41,065 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-03 23:51:41,069 - CtcTrainer - INFO - --- Epoch 88/100 Summary ---
2025-06-03 23:51:41,069 - CtcTrainer - INFO - Avg Train Loss: 0.5494
2025-06-03 23:51:41,069 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.357180698308552, 'val_cer': 0.050976287269741176, 'val_wer': 0.1482576509885348}
2025-06-03 23:51:41,070 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0513
2025-06-03 23:51:41,070 - CtcTrainer - INFO - ---------------------
2025-06-03 23:51:41,073 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-03 23:51:43,293 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-03 23:51:43,294 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-03 23:51:46,894 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-03 23:51:46,894 - CtcTrainer - INFO - New best metric (val_cer) at epoch 88: 0.0510
2025-06-03 23:51:46,900 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-03 23:51:46,901 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 23:51:46,902 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-03 23:51:48,326 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-03 23:51:48,327 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-03 23:51:48,847 - CtcTrainer - INFO - Starting Epoch 89/100
2025-06-04 00:09:05,457 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 01:19:47,883 - CtcTrainer - INFO - Running end-of-epoch 89 validation...
2025-06-04 01:19:50,278 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 01:19:50,279 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 01:19:50,279 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 01:19:50,279 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 01:19:50,279 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 01:19:50,279 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 01:19:50,279 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 01:19:50,279 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 01:19:50,279 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 01:19:50,279 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 01:19:50,280 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 01:19:50,280 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 01:19:50,280 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 01:19:50,280 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 01:19:50,280 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 01:19:50,280 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 01:19:50,280 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 01:19:50,280 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 01:19:50,280 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 01:19:50,280 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 01:24:00,441 - training.ctc_validation - INFO - Validation Results: Loss=4.3329, CER=0.0508, WER=0.1485
2025-06-04 01:24:00,441 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 01:24:00,450 - CtcTrainer - INFO - --- Epoch 89/100 Summary ---
2025-06-04 01:24:00,450 - CtcTrainer - INFO - Avg Train Loss: 0.5470
2025-06-04 01:24:00,450 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.332856359762634, 'val_cer': 0.050759587992579, 'val_wer': 0.14851719779723752}
2025-06-04 01:24:00,450 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0510
2025-06-04 01:24:00,450 - CtcTrainer - INFO - ---------------------
2025-06-04 01:24:00,454 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 01:24:03,841 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 01:24:03,842 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-04 01:24:07,082 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-04 01:24:07,083 - CtcTrainer - INFO - New best metric (val_cer) at epoch 89: 0.0508
2025-06-04 01:24:07,086 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-04 01:24:07,087 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 01:24:07,088 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 01:24:08,375 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 01:24:08,375 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-04 01:24:08,979 - CtcTrainer - INFO - Starting Epoch 90/100
2025-06-04 01:36:25,879 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 02:52:08,833 - CtcTrainer - INFO - Running end-of-epoch 90 validation...
2025-06-04 02:52:11,413 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 02:52:11,414 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 02:52:11,414 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 02:52:11,414 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 02:52:11,414 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 02:52:11,414 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 02:52:11,414 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 02:52:11,414 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 02:52:11,414 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 02:52:11,414 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 02:52:11,414 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 02:52:11,414 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 02:52:11,415 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 02:52:11,415 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 02:52:11,415 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 02:52:11,415 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 02:52:11,415 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 02:52:11,415 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 02:52:11,415 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 02:52:11,415 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 02:56:24,884 - training.ctc_validation - INFO - Validation Results: Loss=4.3320, CER=0.0507, WER=0.1481
2025-06-04 02:56:24,884 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 02:56:24,888 - CtcTrainer - INFO - --- Epoch 90/100 Summary ---
2025-06-04 02:56:24,888 - CtcTrainer - INFO - Avg Train Loss: 0.5413
2025-06-04 02:56:24,888 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.331956357724422, 'val_cer': 0.05068988939466134, 'val_wer': 0.1481448045499684}
2025-06-04 02:56:24,888 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0508
2025-06-04 02:56:24,888 - CtcTrainer - INFO - ---------------------
2025-06-04 02:56:24,892 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 02:56:27,976 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 02:56:27,977 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-04 02:56:31,550 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-04 02:56:31,553 - CtcTrainer - INFO - New best metric (val_cer) at epoch 90: 0.0507
2025-06-04 02:56:31,559 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-04 02:56:31,560 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 02:56:31,562 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 02:56:32,809 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 02:56:32,810 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-04 02:56:33,315 - CtcTrainer - INFO - Starting Epoch 91/100
2025-06-04 03:47:32,570 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 04:24:40,019 - CtcTrainer - INFO - Running end-of-epoch 91 validation...
2025-06-04 04:24:42,490 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 04:24:42,490 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 04:24:42,490 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 04:24:42,490 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 04:24:42,491 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 04:24:42,491 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 04:24:42,492 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 04:24:42,492 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 04:28:51,333 - training.ctc_validation - INFO - Validation Results: Loss=4.3301, CER=0.0507, WER=0.1482
2025-06-04 04:28:51,334 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 04:28:51,337 - CtcTrainer - INFO - --- Epoch 91/100 Summary ---
2025-06-04 04:28:51,338 - CtcTrainer - INFO - Avg Train Loss: 0.5447
2025-06-04 04:28:51,338 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.330064627707129, 'val_cer': 0.05071396709212381, 'val_wer': 0.14819558544732328}
2025-06-04 04:28:51,338 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0507
2025-06-04 04:28:51,338 - CtcTrainer - INFO - ---------------------
2025-06-04 04:28:51,341 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 04:28:54,635 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 04:28:54,635 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-04 04:28:55,091 - CtcTrainer - INFO - Starting Epoch 92/100
2025-06-04 04:42:46,791 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 05:57:11,783 - CtcTrainer - INFO - Running end-of-epoch 92 validation...
2025-06-04 05:57:14,140 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 05:57:14,140 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 05:57:14,140 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 05:57:14,140 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 05:57:14,140 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 05:57:14,141 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 05:57:14,141 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 05:57:14,141 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 05:57:14,141 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 05:57:14,141 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 05:57:14,141 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 05:57:14,141 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 05:57:14,141 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 05:57:14,141 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 05:57:14,141 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 05:57:14,141 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 05:57:14,141 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 05:57:14,142 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 05:57:14,142 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 05:57:14,142 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 06:01:20,153 - training.ctc_validation - INFO - Validation Results: Loss=4.2791, CER=0.0500, WER=0.1463
2025-06-04 06:01:20,154 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 06:01:20,164 - CtcTrainer - INFO - --- Epoch 92/100 Summary ---
2025-06-04 06:01:20,164 - CtcTrainer - INFO - Avg Train Loss: 0.5436
2025-06-04 06:01:20,164 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.279108253370711, 'val_cer': 0.050004308640598544, 'val_wer': 0.1462771959916945}
2025-06-04 06:01:20,164 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0507
2025-06-04 06:01:20,164 - CtcTrainer - INFO - ---------------------
2025-06-04 06:01:20,168 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 06:01:23,335 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 06:01:23,336 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-04 06:01:27,217 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-04 06:01:27,218 - CtcTrainer - INFO - New best metric (val_cer) at epoch 92: 0.0500
2025-06-04 06:01:27,222 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-04 06:01:27,223 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 06:01:27,224 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 06:01:28,937 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 06:01:28,937 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-04 06:01:29,664 - CtcTrainer - INFO - Starting Epoch 93/100
2025-06-04 06:28:56,441 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 07:29:38,495 - CtcTrainer - INFO - Running end-of-epoch 93 validation...
2025-06-04 07:29:40,792 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 07:29:40,793 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 07:29:40,793 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 07:29:40,793 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 07:29:40,793 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 07:29:40,793 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 07:29:40,793 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 07:29:40,793 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 07:29:40,793 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 07:29:40,794 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 07:29:40,794 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 07:29:40,794 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 07:29:40,794 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 07:29:40,794 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 07:29:40,794 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 07:29:40,794 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 07:29:40,794 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 07:29:40,794 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 07:29:40,794 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 07:29:40,795 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 07:33:51,756 - training.ctc_validation - INFO - Validation Results: Loss=4.2689, CER=0.0501, WER=0.1462
2025-06-04 07:33:51,756 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 07:33:51,760 - CtcTrainer - INFO - --- Epoch 93/100 Summary ---
2025-06-04 07:33:51,760 - CtcTrainer - INFO - Avg Train Loss: 0.5378
2025-06-04 07:33:51,760 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.268870230109602, 'val_cer': 0.050080343474690536, 'val_wer': 0.14620384580662635}
2025-06-04 07:33:51,760 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0500
2025-06-04 07:33:51,760 - CtcTrainer - INFO - ---------------------
2025-06-04 07:33:51,764 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 07:33:54,821 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 07:33:54,822 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-04 07:33:55,416 - CtcTrainer - INFO - Starting Epoch 94/100
2025-06-04 07:41:34,619 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 09:03:05,453 - CtcTrainer - INFO - Running end-of-epoch 94 validation...
2025-06-04 09:03:08,088 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 09:03:08,089 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 09:03:08,089 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 09:03:08,089 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 09:03:08,089 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 09:03:08,089 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 09:03:08,089 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 09:03:08,089 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 09:03:08,089 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 09:03:08,089 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 09:03:08,089 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 09:03:08,090 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 09:03:08,090 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 09:03:08,090 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 09:03:08,090 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 09:03:08,090 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 09:03:08,090 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 09:03:08,090 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 09:03:08,090 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 09:03:08,090 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 09:07:14,295 - training.ctc_validation - INFO - Validation Results: Loss=4.2667, CER=0.0501, WER=0.1463
2025-06-04 09:07:14,295 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 09:07:14,304 - CtcTrainer - INFO - --- Epoch 94/100 Summary ---
2025-06-04 09:07:14,305 - CtcTrainer - INFO - Avg Train Loss: 0.5406
2025-06-04 09:07:14,305 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.266693707148932, 'val_cer': 0.05005119678828861, 'val_wer': 0.14628283831362282}
2025-06-04 09:07:14,305 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0500
2025-06-04 09:07:14,305 - CtcTrainer - INFO - ---------------------
2025-06-04 09:07:14,309 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 09:07:17,596 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 09:07:17,596 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-04 09:07:18,612 - CtcTrainer - INFO - Starting Epoch 95/100
2025-06-04 10:09:19,495 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 10:35:17,864 - CtcTrainer - INFO - Running end-of-epoch 95 validation...
2025-06-04 10:35:20,296 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 10:35:20,296 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 10:35:20,297 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 10:35:20,297 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 10:35:20,297 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 10:35:20,297 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 10:35:20,297 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 10:35:20,298 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 10:35:20,298 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 10:35:20,298 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 10:35:20,298 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 10:35:20,298 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 10:35:20,298 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 10:35:20,298 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 10:35:20,299 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 10:35:20,299 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 10:35:20,299 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 10:35:20,299 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 10:35:20,299 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 10:35:20,299 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 10:39:26,665 - training.ctc_validation - INFO - Validation Results: Loss=4.2425, CER=0.0498, WER=0.1456
2025-06-04 10:39:26,666 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 10:39:26,669 - CtcTrainer - INFO - --- Epoch 95/100 Summary ---
2025-06-04 10:39:26,669 - CtcTrainer - INFO - Avg Train Loss: 0.5412
2025-06-04 10:39:26,669 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.242459292335651, 'val_cer': 0.04980281633025477, 'val_wer': 0.14558319039451115}
2025-06-04 10:39:26,670 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0500
2025-06-04 10:39:26,670 - CtcTrainer - INFO - ---------------------
2025-06-04 10:39:26,673 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 10:39:28,746 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 10:39:28,747 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-04 10:39:31,958 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-04 10:39:31,959 - CtcTrainer - INFO - New best metric (val_cer) at epoch 95: 0.0498
2025-06-04 10:39:31,965 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-04 10:39:31,966 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 10:39:31,967 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 10:39:33,128 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 10:39:33,129 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-04 10:39:33,708 - CtcTrainer - INFO - Starting Epoch 96/100
2025-06-04 10:55:34,258 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 12:07:53,793 - CtcTrainer - INFO - Running end-of-epoch 96 validation...
2025-06-04 12:07:56,044 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 12:07:56,045 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 12:07:56,045 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi gà như bác'
2025-06-04 12:07:56,074 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 12:07:56,074 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 12:07:56,074 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 12:07:56,074 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 12:07:56,074 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 12:07:56,074 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 12:07:56,075 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 12:07:56,075 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 12:07:56,075 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 12:07:56,075 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 12:07:56,075 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 12:07:56,076 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 12:07:56,076 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 12:07:56,076 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 12:07:56,076 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 12:07:56,077 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 12:07:56,077 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 12:12:05,584 - training.ctc_validation - INFO - Validation Results: Loss=4.2363, CER=0.0496, WER=0.1448
2025-06-04 12:12:05,585 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 12:12:05,593 - CtcTrainer - INFO - --- Epoch 96/100 Summary ---
2025-06-04 12:12:05,593 - CtcTrainer - INFO - Avg Train Loss: 0.5419
2025-06-04 12:12:05,593 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.236255855959933, 'val_cer': 0.04955063413051633, 'val_wer': 0.1448384038999729}
2025-06-04 12:12:05,594 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0498
2025-06-04 12:12:05,594 - CtcTrainer - INFO - ---------------------
2025-06-04 12:12:05,597 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 12:12:07,676 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 12:12:07,676 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-04 12:12:12,070 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-04 12:12:12,071 - CtcTrainer - INFO - New best metric (val_cer) at epoch 96: 0.0496
2025-06-04 12:12:12,076 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-04 12:12:12,077 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 12:12:12,078 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 12:12:13,817 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 12:12:13,817 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-04 12:12:14,335 - CtcTrainer - INFO - Starting Epoch 97/100
2025-06-04 12:34:14,848 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 13:42:06,248 - CtcTrainer - INFO - Running end-of-epoch 97 validation...
2025-06-04 13:42:08,485 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 13:42:08,485 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 13:42:08,486 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 13:42:08,486 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 13:42:08,486 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 13:42:08,486 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 13:42:08,486 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 13:42:08,486 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 13:42:08,486 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 13:42:08,486 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 13:42:08,486 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 13:42:08,487 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 13:42:08,487 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 13:42:08,487 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 13:42:08,487 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 13:42:08,487 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 13:42:08,487 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 13:42:08,487 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 13:42:08,487 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 13:42:08,487 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 13:45:52,459 - training.ctc_validation - INFO - Validation Results: Loss=4.2315, CER=0.0495, WER=0.1448
2025-06-04 13:45:52,461 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 13:45:52,475 - CtcTrainer - INFO - --- Epoch 97/100 Summary ---
2025-06-04 13:45:52,476 - CtcTrainer - INFO - Avg Train Loss: 0.5404
2025-06-04 13:45:52,476 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.231541532134494, 'val_cer': 0.0494948752521822, 'val_wer': 0.14475941139297643}
2025-06-04 13:45:52,476 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0496
2025-06-04 13:45:52,477 - CtcTrainer - INFO - ---------------------
2025-06-04 13:45:52,481 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 13:45:55,080 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 13:45:55,080 - CtcTrainer - INFO - Saving best checkpoint to outputs/opt_3/checkpoints/checkpoint_best.pt...
2025-06-04 13:45:59,651 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-06-04 13:45:59,651 - CtcTrainer - INFO - New best metric (val_cer) at epoch 97: 0.0495
2025-06-04 13:45:59,658 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/best_model_hf
2025-06-04 13:45:59,659 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 13:45:59,661 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 13:46:01,389 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 13:46:01,389 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=7
2025-06-04 13:46:02,110 - CtcTrainer - INFO - Starting Epoch 98/100
2025-06-04 14:11:31,185 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 15:16:41,671 - CtcTrainer - INFO - Running end-of-epoch 98 validation...
2025-06-04 15:16:43,941 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 15:16:43,942 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 15:16:43,942 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 15:16:43,942 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 15:16:43,942 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 15:16:43,942 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 15:16:43,942 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 15:16:43,942 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 15:16:43,943 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 15:16:43,943 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 15:16:43,943 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 15:16:43,943 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 15:16:43,943 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 15:16:43,943 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 15:16:43,943 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 15:16:43,944 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 15:16:43,944 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 15:16:43,944 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 15:16:43,944 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 15:16:43,944 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 15:20:49,653 - training.ctc_validation - INFO - Validation Results: Loss=4.2284, CER=0.0495, WER=0.1448
2025-06-04 15:20:49,654 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 15:20:49,657 - CtcTrainer - INFO - --- Epoch 98/100 Summary ---
2025-06-04 15:20:49,657 - CtcTrainer - INFO - Avg Train Loss: 0.5372
2025-06-04 15:20:49,657 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.2283783887714765, 'val_cer': 0.0495100822190006, 'val_wer': 0.14481019229033132}
2025-06-04 15:20:49,658 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0495
2025-06-04 15:20:49,658 - CtcTrainer - INFO - ---------------------
2025-06-04 15:20:49,661 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 15:20:53,020 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 15:20:53,021 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=7
2025-06-04 15:20:53,547 - CtcTrainer - INFO - Starting Epoch 99/100
2025-06-04 15:59:11,007 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 16:48:55,481 - CtcTrainer - INFO - Running end-of-epoch 99 validation...
2025-06-04 16:48:57,841 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 16:48:57,842 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 16:48:57,842 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 16:48:57,842 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 16:48:57,842 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 16:48:57,842 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 16:48:57,842 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 16:48:57,842 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 16:48:57,842 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 16:48:57,842 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 16:48:57,842 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 16:48:57,843 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 16:48:57,843 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 16:48:57,843 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 16:48:57,843 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 16:48:57,843 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 16:48:57,843 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 16:48:57,843 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 16:48:57,843 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 16:48:57,843 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 16:53:05,030 - training.ctc_validation - INFO - Validation Results: Loss=4.2280, CER=0.0495, WER=0.1446
2025-06-04 16:53:05,030 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 16:53:05,034 - CtcTrainer - INFO - --- Epoch 99/100 Summary ---
2025-06-04 16:53:05,034 - CtcTrainer - INFO - Avg Train Loss: 0.5380
2025-06-04 16:53:05,034 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.227996205859457, 'val_cer': 0.049507547724530865, 'val_wer': 0.1445844994131985}
2025-06-04 16:53:05,034 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0495
2025-06-04 16:53:05,034 - CtcTrainer - INFO - ---------------------
2025-06-04 16:53:05,038 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 16:53:07,128 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 16:53:07,129 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=7
2025-06-04 16:53:07,651 - CtcTrainer - INFO - Starting Epoch 100/100
2025-06-04 17:46:38,990 - data.ctc_ocr_dataset - WARNING - Sample 490135 resulted in empty label indices for text: ''. Skipping.
2025-06-04 18:21:15,682 - CtcTrainer - INFO - Running end-of-epoch 100 validation...
2025-06-04 18:21:18,074 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-06-04 18:21:18,075 - training.ctc_validation - INFO -   Ground Truth: 'Người vợ tuổi già như bác'
2025-06-04 18:21:18,075 - training.ctc_validation - INFO -   Prediction  : 'Người vợ tuổi già như bác'
2025-06-04 18:21:18,075 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 18:21:18,075 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-06-04 18:21:18,075 - training.ctc_validation - INFO -   Ground Truth: 'Ề'
2025-06-04 18:21:18,076 - training.ctc_validation - INFO -   Prediction  : 'Ề'
2025-06-04 18:21:18,076 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 18:21:18,076 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-06-04 18:21:18,076 - training.ctc_validation - INFO -   Ground Truth: 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 18:21:18,076 - training.ctc_validation - INFO -   Prediction  : 'vào ngày 31 tháng 12 năm 1947.'
2025-06-04 18:21:18,076 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 18:21:18,076 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-06-04 18:21:18,076 - training.ctc_validation - INFO -   Ground Truth: 'Hai người bắt đầu hàn gắn lại mối quan hệ của họ'
2025-06-04 18:21:18,076 - training.ctc_validation - INFO -   Prediction  : 'Hai người bắt đầu bạn gần lại mối quan hệ của họ'
2025-06-04 18:21:18,076 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 18:21:18,077 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-06-04 18:21:18,077 - training.ctc_validation - INFO -   Ground Truth: 'buổi'
2025-06-04 18:21:18,077 - training.ctc_validation - INFO -   Prediction  : 'buổi'
2025-06-04 18:21:18,077 - training.ctc_validation - INFO - ---------------------------------
2025-06-04 18:25:29,481 - training.ctc_validation - INFO - Validation Results: Loss=4.2279, CER=0.0495, WER=0.1447
2025-06-04 18:25:29,482 - training.ctc_validation - INFO - (Based on 34376 samples for CER/WER, 34376 for loss estimation)
2025-06-04 18:25:29,487 - CtcTrainer - INFO - --- Epoch 100/100 Summary ---
2025-06-04 18:25:29,487 - CtcTrainer - INFO - Avg Train Loss: 0.5408
2025-06-04 18:25:29,487 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.22792707102567, 'val_cer': 0.049497409746651934, 'val_wer': 0.1446973458517649}
2025-06-04 18:25:29,487 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0495
2025-06-04 18:25:29,488 - CtcTrainer - INFO - ---------------------
2025-06-04 18:25:29,491 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 18:25:32,740 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 18:25:32,740 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=7
2025-06-04 18:25:33,299 - CtcTrainer - INFO - Training loop ended. Last epoch: 99. Steps: 4082200
2025-06-04 18:25:33,300 - CtcTrainer - INFO - Attempting to save final state...
2025-06-04 18:25:33,303 - CtcTrainer - INFO - Saving latest checkpoint to outputs/opt_3/checkpoints/checkpoint_latest.pt...
2025-06-04 18:25:36,523 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-06-04 18:25:36,524 - CtcTrainer - INFO - Training completed normally.
2025-06-04 18:25:36,524 - CtcTrainer - INFO - Restoring best model weights...
2025-06-04 18:25:36,546 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/opt_3/final_model_hf
2025-06-04 18:25:36,547 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 18:25:36,548 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 18:25:37,336 - model.hierarchical_ctc_model - INFO - Model components saved.
2025-06-04 18:25:37,336 - CtcTrainer - INFO - Saved final model (best weights) to outputs/opt_3/final_model_hf
2025-06-04 18:25:39,938 - TrainHierarchicalMultiScaleScript - INFO - ============ Training finished ============
2025-06-04 18:25:39,938 - TrainHierarchicalMultiScaleScript - INFO - Final model artifacts saved in outputs/opt_3
2025-06-04 18:25:39,939 - TrainHierarchicalMultiScaleScript - INFO - ============ Starting Final Evaluation on Test Set ============
2025-06-04 18:25:39,947 - EvaluateHierarchicalCtcScript - INFO - Using device: cuda
2025-06-04 18:25:39,948 - EvaluateHierarchicalCtcScript - INFO - Loading combined char vocab from: outputs/opt_3/combined_char_vocab.json
2025-06-04 18:25:39,949 - EvaluateHierarchicalCtcScript - INFO - Combined vocab loaded: 229 chars.
2025-06-04 18:25:39,949 - EvaluateHierarchicalCtcScript - INFO - Loading trained Hierarchical CTC model from: outputs/opt_3/best_model_hf
2025-06-04 18:25:39,949 - model.hierarchical_ctc_model - INFO - Loading HierarchicalCtcMultiScaleOcrModel from: outputs/opt_3/best_model_hf
2025-06-04 18:25:39,951 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-06-04 18:25:39,953 - model.hierarchical_ctc_model - INFO - Loaded config from file, applied/overrode with kwargs: {'combined_char_vocab': ['<blank>', ' ', '!', '"', '#', '$', '%', '&', "'", '(', ')', '*', '+', ',', '-', '.', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '<', '=', '>', '?', '@', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\', ']', '^', '_', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '{', '|', '}', 'À', 'Á', 'Â', 'Ã', 'È', 'É', 'Ê', 'Ì', 'Í', 'Ò', 'Ó', 'Ô', 'Õ', 'Ù', 'Ú', 'Ý', 'à', 'á', 'â', 'ã', 'è', 'é', 'ê', 'ì', 'í', 'ò', 'ó', 'ô', 'õ', 'ù', 'ú', 'ý', 'Ă', 'ă', 'Đ', 'đ', 'Ĩ', 'ĩ', 'Ũ', 'ũ', 'Ơ', 'ơ', 'Ư', 'ư', 'Ạ', 'ạ', 'Ả', 'ả', 'Ấ', 'ấ', 'Ầ', 'ầ', 'Ẩ', 'ẩ', 'Ẫ', 'ẫ', 'Ậ', 'ậ', 'Ắ', 'ắ', 'Ằ', 'ằ', 'Ẳ', 'ẳ', 'Ẵ', 'ẵ', 'Ặ', 'ặ', 'Ẹ', 'ẹ', 'Ẻ', 'ẻ', 'Ẽ', 'ẽ', 'Ế', 'ế', 'Ề', 'ề', 'Ể', 'ể', 'Ễ', 'ễ', 'Ệ', 'ệ', 'Ỉ', 'ỉ', 'Ị', 'ị', 'Ọ', 'ọ', 'Ỏ', 'ỏ', 'Ố', 'ố', 'Ồ', 'ồ', 'Ổ', 'ổ', 'Ỗ', 'ỗ', 'Ộ', 'ộ', 'Ớ', 'ớ', 'Ờ', 'ờ', 'Ở', 'ở', 'Ỡ', 'ỡ', 'Ợ', 'ợ', 'Ụ', 'ụ', 'Ủ', 'ủ', 'Ứ', 'ứ', 'Ừ', 'ừ', 'Ử', 'ử', 'Ữ', 'ữ', 'Ự', 'ự', 'Ỳ', 'ỳ', 'Ỵ', 'ỵ', 'Ỷ', 'ỷ', 'Ỹ', 'ỹ', '[UNK]']}
2025-06-04 18:25:40,190 - model.hierarchical_ctc_model - WARNING - Could not auto-detect specific vision config type for 'vit': vit is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `huggingface-cli login` or by passing `token=<your_token>`. Using PretrainedConfig as base.
2025-06-04 18:25:40,191 - model.hierarchical_ctc_model - INFO - Initializing HierarchicalCtcMultiScaleOcrModel with config: hierarchical_ctc_transformer
2025-06-04 18:25:47,366 - model.hierarchical_ctc_model - INFO - Processor and Vision Encoder loaded.
2025-06-04 18:25:47,367 - model.hierarchical_ctc_model - INFO - Using Dynamic Multi-Scale Fusion (3 layers -> 768 dim)
2025-06-04 18:25:47,427 - model.hierarchical_ctc_model - INFO - Using Local Feature Enhancer
2025-06-04 18:25:47,553 - model.hierarchical_ctc_model - INFO - Positional Encoding: sinusoidal_1d
2025-06-04 18:25:47,554 - model.hierarchical_ctc_model - INFO - Adding 6 Transformer Encoder layers (Dim: 768)
2025-06-04 18:25:47,676 - model.hierarchical_ctc_model - INFO - Shared Layer(s): 1, Output Dim: 768
2025-06-04 18:25:47,677 - model.hierarchical_ctc_model - INFO - Base Classifier (In: 768, Out: 95)
2025-06-04 18:25:47,682 - model.hierarchical_ctc_model - INFO - 'concat_proj' conditioning for diacritic head -> 768 dim.
2025-06-04 18:25:47,684 - model.diacritic_attention - INFO - Initializing compatibility matrix with priors: no_diac_idx=1, blank_diac_idx=0
2025-06-04 18:25:47,684 - model.diacritic_attention - INFO - Pure tone indices found: [3, 4, 5, 6, 7]
2025-06-04 18:25:47,684 - model.diacritic_attention - INFO - Modifiers map (name_lower -> index): {'breve': 9, 'horn': 10, 'circumflex': 8, 'stroke': 11}
2025-06-04 18:25:47,686 - model.diacritic_attention - INFO - Completed initialization of compatibility matrix with detailed Vietnamese linguistic priors (đ treated as a regular consonant).
2025-06-04 18:25:47,686 - model.hierarchical_ctc_model - INFO - Char-Diac Compat: ON
2025-06-04 18:25:47,687 - model.hierarchical_ctc_model - INFO - Diacritic Classifier (In: 768, Out: 27)
2025-06-04 18:25:47,688 - model.hierarchical_ctc_model - INFO - Final Combined Classifier (In: 768, Out: 229)
2025-06-04 18:25:47,688 - model.hierarchical_ctc_model - INFO - Initialized HierarchicalCtcMultiScaleOcrModel (inherits Grad-CAM from parent).
2025-06-04 18:25:47,688 - model.hierarchical_ctc_model - INFO - Loading state dict from: outputs/opt_3/best_model_hf/pytorch_model.bin
2025-06-04 18:25:48,985 - model.hierarchical_ctc_model - INFO - Loaded state. Missing: [], Unexpected: []
2025-06-04 18:25:49,194 - EvaluateHierarchicalCtcScript - INFO - Model and processor loaded.
2025-06-04 18:25:49,195 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_visual_diacritic_attention': False
2025-06-04 18:25:49,195 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_character_diacritic_compatibility': True
2025-06-04 18:25:49,195 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_few_shot_diacritic_adapter': False
2025-06-04 18:25:49,195 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_dynamic_fusion': True
2025-06-04 18:25:49,195 - EvaluateHierarchicalCtcScript - INFO - Model config 'use_feature_enhancer': True
2025-06-04 18:25:49,195 - EvaluateHierarchicalCtcScript - INFO - Using processor target size for attention viz: (384, 384)
2025-06-04 18:25:49,196 - EvaluateHierarchicalCtcScript - INFO - Loading test dataset: vklinhhh/test_vietnamese_cwl, split: train
2025-06-04 18:25:54,205 - EvaluateHierarchicalCtcScript - INFO - Test set size: 343
2025-06-04 18:25:54,205 - EvaluateHierarchicalCtcScript - INFO - Creating CTC test dataset wrapper (using combined vocab)...
2025-06-04 18:25:54,205 - data.ctc_ocr_dataset - INFO - Training augmentations disabled (validation/test mode).
2025-06-04 18:25:54,209 - EvaluateHierarchicalCtcScript - INFO - Test DataLoader created.
2025-06-04 18:25:54,210 - EvaluateHierarchicalCtcScript - INFO - Starting evaluation loop...
2025-06-04 18:26:03,850 - EvaluateHierarchicalCtcScript - INFO - Evaluation loop finished.
2025-06-04 18:26:03,890 - EvaluateHierarchicalCtcScript - INFO - Saved detailed results to: outputs/opt_3/final_evaluation_report/evaluation_results_raw.csv
2025-06-04 18:26:03,912 - EvaluateHierarchicalCtcScript - INFO - Final Evaluation Metrics: Avg Loss=18.8471, CER=0.0757, WER=0.2224
2025-06-04 18:26:03,912 - EvaluateHierarchicalCtcScript - INFO - Analyzing diacritic recognition accuracy...
2025-06-04 18:26:04,232 - EvaluateHierarchicalCtcScript - INFO - Diacritic Recognition Accuracy:
2025-06-04 18:26:04,232 - EvaluateHierarchicalCtcScript - INFO -   breve_grave: 100.00% (4/4)
2025-06-04 18:26:04,232 - EvaluateHierarchicalCtcScript - INFO -   breve_hook: 100.00% (2/2)
2025-06-04 18:26:04,232 - EvaluateHierarchicalCtcScript - INFO -   breve_acute: 100.00% (12/12)
2025-06-04 18:26:04,232 - EvaluateHierarchicalCtcScript - INFO -   breve_tilde: 100.00% (2/2)
2025-06-04 18:26:04,232 - EvaluateHierarchicalCtcScript - INFO -   dot: 95.69% (111/116)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   horn_grave: 94.83% (55/58)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   circumflex_acute: 94.48% (137/145)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   horn: 94.19% (146/155)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   circumflex_dot: 93.94% (155/165)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   horn_tilde: 93.75% (15/16)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   stroke: 93.71% (149/159)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   circumflex_hook: 93.33% (56/60)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   grave: 92.96% (198/213)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   horn_acute: 92.45% (49/53)
2025-06-04 18:26:04,233 - EvaluateHierarchicalCtcScript - INFO -   tilde: 92.42% (61/66)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   horn_dot: 92.16% (47/51)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   circumflex_grave: 91.46% (75/82)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   acute: 90.77% (177/195)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   circumflex: 90.65% (126/139)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   hook: 90.52% (105/116)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   breve: 87.50% (14/16)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   circumflex_tilde: 87.50% (7/8)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   breve_dot: 85.71% (6/7)
2025-06-04 18:26:04,234 - EvaluateHierarchicalCtcScript - INFO -   horn_hook: 75.86% (22/29)
2025-06-04 18:26:04,236 - EvaluateHierarchicalCtcScript - INFO - Saved diacritic analysis to: outputs/opt_3/final_evaluation_report/diacritic_analysis.json
2025-06-04 18:26:04,276 - utils.evaluation_reporter - INFO - Saving visualizations to: outputs/opt_3/final_evaluation_report/visualizations
2025-06-04 18:26:04,807 - utils.evaluation_reporter - INFO - Generating HTML report at: outputs/opt_3/final_evaluation_report/evaluation_report.html
2025-06-04 18:26:04,808 - utils.evaluation_reporter - INFO - HTML report generated successfully.
2025-06-04 18:26:04,808 - EvaluateHierarchicalCtcScript - INFO - Generating diacritic HTML report at: outputs/opt_3/final_evaluation_report/diacritic_evaluation_report.html
2025-06-04 18:26:04,809 - EvaluateHierarchicalCtcScript - INFO - Diacritic HTML report generated successfully.
2025-06-04 18:26:04,809 - EvaluateHierarchicalCtcScript - INFO - Evaluation complete. Reports: outputs/opt_3/final_evaluation_report/evaluation_report.html, outputs/opt_3/final_evaluation_report/diacritic_evaluation_report.html
